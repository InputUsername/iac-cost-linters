[
  {
    "pattern": "Object storage lifecycle rules",
    "url": "https://github.com/alphagov/govuk-aws/commit/f844cd8e254b161bebef04101f8ce177bcd0840c",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 17, Failed checks: 18, Skipped checks: 0, Parsing errors: 1\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.govuk-mongodb-backup-s3.aws_s3_bucket.s3_bucket\n\tFile: /terraform/modules/aws/s3_bucket_lifecycle/main.tf:58-100\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.govuk-mongodb-backup-s3-daily.aws_s3_bucket.s3_bucket\n\tFile: /terraform/modules/aws/s3_bucket_lifecycle/main.tf:58-100\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.bucket\n\tFile: /terraform/projects/app-govuk-attachments/main.tf:66-89\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.bucket\n\tFile: /terraform/projects/app-mysql-xtrabackups/main.tf:69-101\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.sitemaps_bucket\n\tFile: /terraform/projects/app-search/main.tf:190-213\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.search_relevancy_bucket\n\tFile: /terraform/projects/app-search/main.tf:280-313\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.bucket[0]\n\tFile: /terraform/projects/app-wal-e-backups-postgresql/main.tf:68-95\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.bucket_with_transition\n\tFile: /terraform/projects/app-wal-e-backups-postgresql/main.tf:97-131\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.artefact_replication_destination\n\tFile: /terraform/projects/infra-artefact-bucket/main.tf:140-161\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.content_data_csvs\n\tFile: /terraform/projects/infra-content-data-admin/main.tf:35-57\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.activestorage_replica\n\tFile: /terraform/projects/infra-content-publisher/main.tf:92-119\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.database_backups\n\tFile: /terraform/projects/infra-database-backups-bucket/main.tf:100-276\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.govuk-mirror\n\tFile: /terraform/projects/infra-mirror-bucket/main.tf:149-209\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.govuk-mirror-replica\n\tFile: /terraform/projects/infra-mirror-bucket/main.tf:211-251\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.aws-logging\n\tFile: /terraform/projects/infra-monitoring/main.tf:107-150\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.aws-secondary-logging\n\tFile: /terraform/projects/infra-monitoring/secondary.tf:32-52\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.aws_waf_logs\n\tFile: /terraform/projects/infra-public-services/waf.tf:27-41\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.custom_formats_mapit\n\tFile: /terraform/projects/app-custom-formats-mapit-storage/main.tf:57-83\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t57 | resource \"aws_s3_bucket\" \"custom_formats_mapit\" {\n\t\t58 |   bucket = \"${var.bucket_name}-${var.aws_environment}\"\n\t\t59 | \n\t\t60 |   tags {\n\t\t61 |     Environment = \"${var.aws_environment}\"\n\t\t62 |     Team        = \"custom_formats\"\n\t\t63 |   }\n\t\t64 | \n\t\t65 |   versioning {\n\t\t66 |     enabled = true\n\t\t67 |   }\n\t\t68 | \n\t\t69 |   replication_configuration {\n\t\t70 |     role = \"${aws_iam_role.govuk_custom_formats_mapit_storage_replication_role.arn}\"\n\t\t71 | \n\t\t72 |     rules {\n\t\t73 |       id     = \"govuk-custom-formats-mapit-storage-replication-whole-bucket-rule\"\n\t\t74 |       prefix = \"\"\n\t\t75 |       status = \"Enabled\"\n\t\t76 | \n\t\t77 |       destination {\n\t\t78 |         bucket        = \"${aws_s3_bucket.custom_formats_mapit_replica.arn}\"\n\t\t79 |         storage_class = \"STANDARD\"\n\t\t80 |       }\n\t\t81 |     }\n\t\t82 |   }\n\t\t83 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.custom_formats_mapit_replica\n\tFile: /terraform/projects/app-custom-formats-mapit-storage/main.tf:85-98\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t85 | resource \"aws_s3_bucket\" \"custom_formats_mapit_replica\" {\n\t\t86 |   bucket   = \"${var.bucket_name}-replica-${var.aws_environment}\"\n\t\t87 |   region   = \"${var.aws_replica_region}\"\n\t\t88 |   provider = \"aws.aws_replica\"\n\t\t89 | \n\t\t90 |   tags {\n\t\t91 |     Name            = \"custom_formats_mapit_replica\"\n\t\t92 |     aws_environment = \"${var.aws_environment}\"\n\t\t93 |   }\n\t\t94 | \n\t\t95 |   versioning {\n\t\t96 |     enabled = true\n\t\t97 |   }\n\t\t98 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.manual_snapshots\n\tFile: /terraform/projects/app-elasticsearch6/main.tf:304-317\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t304 | resource \"aws_s3_bucket\" \"manual_snapshots\" {\n\t\t305 |   bucket = \"govuk-${var.aws_environment}-elasticsearch6-manual-snapshots\"\n\t\t306 |   region = \"${var.aws_region}\"\n\t\t307 | \n\t\t308 |   tags {\n\t\t309 |     Name            = \"govuk-${var.aws_environment}-elasticsearch6-manual-snapshots\"\n\t\t310 |     aws_environment = \"${var.aws_environment}\"\n\t\t311 |   }\n\t\t312 | \n\t\t313 |   logging {\n\t\t314 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t315 |     target_prefix = \"s3/govuk-${var.aws_environment}-elasticsearch6-manual-snapshots/\"\n\t\t316 |   }\n\t\t317 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.results\n\tFile: /terraform/projects/app-gatling/main.tf:151-157\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t151 | resource \"aws_s3_bucket\" \"results\" {\n\t\t152 |   bucket = \"gatling-results-${var.aws_environment}\"\n\t\t153 | \n\t\t154 |   website {\n\t\t155 |     index_document = \"index.html\"\n\t\t156 |   }\n\t\t157 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.bucket_without_lifecycle[0]\n\tFile: /terraform/projects/app-govuk-attachments/main.tf:91-105\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t91  | resource \"aws_s3_bucket\" \"bucket_without_lifecycle\" {\n\t\t92  |   count = \"${1 - var.lifecycle}\"\n\t\t93  | \n\t\t94  |   bucket = \"${var.bucket_name}-${var.aws_environment}\"\n\t\t95  |   acl    = \"private\"\n\t\t96  | \n\t\t97  |   tags {\n\t\t98  |     Environment = \"${var.aws_environment}\"\n\t\t99  |     Team        = \"${var.team}\"\n\t\t100 |   }\n\t\t101 | \n\t\t102 |   versioning {\n\t\t103 |     enabled = \"${var.versioning}\"\n\t\t104 |   }\n\t\t105 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.data_infrastructure_bucket\n\tFile: /terraform/projects/app-knowledge-graph/main.tf:56-67\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t56 | resource \"aws_s3_bucket\" \"data_infrastructure_bucket\" {\n\t\t57 |   bucket = \"${local.data_infrastructure_bucket_name}\"\n\t\t58 | \n\t\t59 |   versioning {\n\t\t60 |     enabled = true\n\t\t61 |   }\n\t\t62 | \n\t\t63 |   tags {\n\t\t64 |     aws_environment = \"${var.aws_environment}\"\n\t\t65 |     Name            = \"${local.data_infrastructure_bucket_name}\"\n\t\t66 |   }\n\t\t67 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.s3_bucket\n\tFile: /terraform/projects/app-related-links/main.tf:47-58\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t47 | resource \"aws_s3_bucket\" \"s3_bucket\" {\n\t\t48 |   bucket = \"${local.related_links_bucket_name}\"\n\t\t49 | \n\t\t50 |   versioning {\n\t\t51 |     enabled = true\n\t\t52 |   }\n\t\t53 | \n\t\t54 |   tags {\n\t\t55 |     aws_environment = \"${var.aws_environment}\"\n\t\t56 |     Name            = \"${local.related_links_bucket_name}\"\n\t\t57 |   }\n\t\t58 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.whitehall_csvs\n\tFile: /terraform/projects/app-whitehall-backend/main.tf:139-151\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t139 | resource \"aws_s3_bucket\" \"whitehall_csvs\" {\n\t\t140 |   bucket = \"govuk-${var.aws_environment}-whitehall-csvs\"\n\t\t141 | \n\t\t142 |   tags {\n\t\t143 |     name            = \"govuk-${var.aws_environment}-whitehall-csvs\"\n\t\t144 |     aws_environment = \"${var.aws_environment}\"\n\t\t145 |   }\n\t\t146 | \n\t\t147 |   logging {\n\t\t148 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t149 |     target_prefix = \"s3/govuk-${var.aws_environment}-whitehall-csvs/\"\n\t\t150 |   }\n\t\t151 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.artefact\n\tFile: /terraform/projects/infra-artefact-bucket/main.tf:164-195\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t164 | resource \"aws_s3_bucket\" \"artefact\" {\n\t\t165 |   bucket = \"govuk-${var.aws_environment}-artefact\"\n\t\t166 |   acl    = \"private\"\n\t\t167 | \n\t\t168 |   tags {\n\t\t169 |     Name            = \"govuk-${var.aws_environment}-artefact\"\n\t\t170 |     aws_environment = \"${var.aws_environment}\"\n\t\t171 |   }\n\t\t172 | \n\t\t173 |   versioning {\n\t\t174 |     enabled = true\n\t\t175 |   }\n\t\t176 | \n\t\t177 |   logging {\n\t\t178 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t179 |     target_prefix = \"s3/govuk-${var.aws_environment}-artefact/\"\n\t\t180 |   }\n\t\t181 | \n\t\t182 |   replication_configuration {\n\t\t183 |     role = \"${aws_iam_role.artefact_replication.arn}\"\n\t\t184 | \n\t\t185 |     rules {\n\t\t186 |       id     = \"govuk-artefact-replication-whole-bucket-rule\"\n\t\t187 |       status = \"${var.replication_setting}\"\n\t\t188 |       prefix = \"\"\n\t\t189 | \n\t\t190 |       destination {\n\t\t191 |         bucket = \"${aws_s3_bucket.artefact_replication_destination.arn}\"\n\t\t192 |       }\n\t\t193 |     }\n\t\t194 |   }\n\t\t195 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.assets_backup\n\tFile: /terraform/projects/infra-assets/backup.tf:6-14\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t6  | resource \"aws_s3_bucket\" \"assets_backup\" {\n\t\t7  |   provider = \"aws.backup_provider\"\n\t\t8  |   bucket   = \"govuk-assets-backup-${var.aws_environment}\"\n\t\t9  |   region   = \"${var.aws_backup_region}\"\n\t\t10 | \n\t\t11 |   versioning {\n\t\t12 |     enabled = true\n\t\t13 |   }\n\t\t14 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.assets\n\tFile: /terraform/projects/infra-assets/main.tf:41-72\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t41 | resource \"aws_s3_bucket\" \"assets\" {\n\t\t42 |   bucket = \"govuk-assets-${var.aws_environment}\"\n\t\t43 | \n\t\t44 |   tags {\n\t\t45 |     Name            = \"govuk-assets-${var.aws_environment}\"\n\t\t46 |     aws_environment = \"${var.aws_environment}\"\n\t\t47 |   }\n\t\t48 | \n\t\t49 |   logging {\n\t\t50 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t51 |     target_prefix = \"s3/govuk-assets-${var.aws_environment}/\"\n\t\t52 |   }\n\t\t53 | \n\t\t54 |   versioning {\n\t\t55 |     enabled = true\n\t\t56 |   }\n\t\t57 | \n\t\t58 |   replication_configuration {\n\t\t59 |     role = \"${aws_iam_role.backup.arn}\"\n\t\t60 | \n\t\t61 |     rules {\n\t\t62 |       id     = \"govuk-${var.aws_environment}-assets-replication-rule\"\n\t\t63 |       prefix = \"\"\n\t\t64 |       status = \"Enabled\"\n\t\t65 | \n\t\t66 |       destination {\n\t\t67 |         bucket        = \"${aws_s3_bucket.assets_backup.arn}\"\n\t\t68 |         storage_class = \"STANDARD\"\n\t\t69 |       }\n\t\t70 |     }\n\t\t71 |   }\n\t\t72 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.activestorage\n\tFile: /terraform/projects/infra-content-publisher/main.tf:59-90\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t59 | resource \"aws_s3_bucket\" \"activestorage\" {\n\t\t60 |   bucket = \"govuk-${var.aws_environment}-content-publisher-activestorage\"\n\t\t61 | \n\t\t62 |   tags {\n\t\t63 |     Name            = \"govuk-${var.aws_environment}-content-publisher-activestorage\"\n\t\t64 |     aws_environment = \"${var.aws_environment}\"\n\t\t65 |   }\n\t\t66 | \n\t\t67 |   logging {\n\t\t68 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t69 |     target_prefix = \"s3/govuk-${var.aws_environment}-content-publisher-activestorage/\"\n\t\t70 |   }\n\t\t71 | \n\t\t72 |   versioning {\n\t\t73 |     enabled = true\n\t\t74 |   }\n\t\t75 | \n\t\t76 |   replication_configuration {\n\t\t77 |     role = \"${aws_iam_role.govuk_content_publisher_activestorage_replication_role.arn}\"\n\t\t78 | \n\t\t79 |     rules {\n\t\t80 |       id     = \"govuk-content-publisher-activestorage-replication-whole-bucket-rule\"\n\t\t81 |       prefix = \"\"\n\t\t82 |       status = \"${var.replication_setting}\"\n\t\t83 | \n\t\t84 |       destination {\n\t\t85 |         bucket        = \"${aws_s3_bucket.activestorage_replica.arn}\"\n\t\t86 |         storage_class = \"STANDARD\"\n\t\t87 |       }\n\t\t88 |     }\n\t\t89 |   }\n\t\t90 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.database_backups_replica\n\tFile: /terraform/projects/infra-database-backups-bucket/main.tf:279-287\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t279 | resource \"aws_s3_bucket\" \"database_backups_replica\" {\n\t\t280 |   bucket   = \"govuk-${var.aws_environment}-database-backups-replica\"\n\t\t281 |   region   = \"${var.aws_backup_region}\"\n\t\t282 |   provider = \"aws.eu-london\"\n\t\t283 | \n\t\t284 |   versioning {\n\t\t285 |     enabled = true\n\t\t286 |   }\n\t\t287 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.datagovuk-organogram\n\tFile: /terraform/projects/infra-datagovuk-organogram-bucket/main.tf:63-84\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t63 | resource \"aws_s3_bucket\" \"datagovuk-organogram\" {\n\t\t64 |   bucket = \"datagovuk-${var.aws_environment}-ckan-organogram\"\n\t\t65 | \n\t\t66 |   cors_rule {\n\t\t67 |     allowed_methods = [\"GET\"]\n\t\t68 |     allowed_origins = \"${compact(list(var.domain, var.aws_environment == \"production\" ? \"https://staging.data.gov.uk\" : \"\"))}\"\n\t\t69 |   }\n\t\t70 | \n\t\t71 |   tags {\n\t\t72 |     Name            = \"datagovuk-${var.aws_environment}-ckan-organogram\"\n\t\t73 |     aws_environment = \"${var.aws_environment}\"\n\t\t74 |   }\n\t\t75 | \n\t\t76 |   logging {\n\t\t77 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t78 |     target_prefix = \"s3/datagovuk-${var.aws_environment}-ckan-organogram/\"\n\t\t79 |   }\n\t\t80 | \n\t\t81 |   versioning {\n\t\t82 |     enabled = true\n\t\t83 |   }\n\t\t84 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.datagovuk-static\n\tFile: /terraform/projects/infra-datagovuk-static-bucket/main.tf:63-79\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t63 | resource \"aws_s3_bucket\" \"datagovuk-static\" {\n\t\t64 |   bucket = \"datagovuk-${var.aws_environment}-ckan-static-data\"\n\t\t65 | \n\t\t66 |   tags {\n\t\t67 |     Name            = \"datagovuk-${var.aws_environment}-ckan-static-data\"\n\t\t68 |     aws_environment = \"${var.aws_environment}\"\n\t\t69 |   }\n\t\t70 | \n\t\t71 |   logging {\n\t\t72 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t73 |     target_prefix = \"s3/datagovuk-${var.aws_environment}-ckan-static-data/\"\n\t\t74 |   }\n\t\t75 | \n\t\t76 |   versioning {\n\t\t77 |     enabled = true\n\t\t78 |   }\n\t\t79 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.cdn_logs_monitor\n\tFile: /terraform/projects/infra-govuk-cdn-logs-monitor-bucket/main.tf:39-51\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t39 | resource \"aws_s3_bucket\" \"cdn_logs_monitor\" {\n\t\t40 |   bucket = \"govuk-${var.aws_environment}-cdn-logs-monitor-archive\"\n\t\t41 | \n\t\t42 |   tags {\n\t\t43 |     Name            = \"govuk-${var.aws_environment}-cdn-logs-monitor-archive\"\n\t\t44 |     aws_environment = \"${var.aws_environment}\"\n\t\t45 |   }\n\t\t46 | \n\t\t47 |   logging {\n\t\t48 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t49 |     target_prefix = \"s3/govuk-${var.aws_environment}-cdn-logs-monitor-archive/\"\n\t\t50 |   }\n\t\t51 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.specialist_publisher_csvs\n\tFile: /terraform/projects/infra-specialist-publisher/main.tf:35-47\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t35 | resource \"aws_s3_bucket\" \"specialist_publisher_csvs\" {\n\t\t36 |   bucket = \"govuk-${var.aws_environment}-specialist-publisher-csvs\"\n\t\t37 | \n\t\t38 |   tags {\n\t\t39 |     name            = \"govuk-${var.aws_environment}-specialist-publisher-csvs\"\n\t\t40 |     aws_environment = \"${var.aws_environment}\"\n\t\t41 |   }\n\t\t42 | \n\t\t43 |   logging {\n\t\t44 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t45 |     target_prefix = \"s3/govuk-${var.aws_environment}-specialist-publisher-csvs/\"\n\t\t46 |   }\n\t\t47 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.support_api_csvs\n\tFile: /terraform/projects/infra-support-api/main.tf:35-47\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t35 | resource \"aws_s3_bucket\" \"support_api_csvs\" {\n\t\t36 |   bucket = \"govuk-${var.aws_environment}-support-api-csvs\"\n\t\t37 | \n\t\t38 |   tags {\n\t\t39 |     name            = \"govuk-${var.aws_environment}-support-api-csvs\"\n\t\t40 |     aws_environment = \"${var.aws_environment}\"\n\t\t41 |   }\n\t\t42 | \n\t\t43 |   logging {\n\t\t44 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t45 |     target_prefix = \"s3/govuk-${var.aws_environment}-support-api-csvs/\"\n\t\t46 |   }\n\t\t47 | }\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/alphagov-govuk-aws-f844cd8e254b161bebef04101f8ce177bcd0840c/before-f9fc11443ab8926b0761fb890974cd7169f9235f/terraform/projects/infra-fastly-logs/main.tfֿ\n\n",
        "stderr": "2024-06-21 12:04:12,765 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/alphagov/csw-client-role.git:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:04:12,766 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/alphagov/tech-ops.git?ref=13f54e5//cyber-security/modules/gds_security_audit_role:None (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 65.55060055801005
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 18, Failed checks: 17, Skipped checks: 0, Parsing errors: 1\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.govuk-mongodb-backup-s3.aws_s3_bucket.s3_bucket\n\tFile: /terraform/modules/aws/s3_bucket_lifecycle/main.tf:58-100\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.govuk-mongodb-backup-s3-daily.aws_s3_bucket.s3_bucket\n\tFile: /terraform/modules/aws/s3_bucket_lifecycle/main.tf:58-100\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.bucket\n\tFile: /terraform/projects/app-govuk-attachments/main.tf:66-89\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.data_infrastructure_bucket\n\tFile: /terraform/projects/app-knowledge-graph/main.tf:56-100\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.bucket\n\tFile: /terraform/projects/app-mysql-xtrabackups/main.tf:69-101\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.sitemaps_bucket\n\tFile: /terraform/projects/app-search/main.tf:190-213\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.search_relevancy_bucket\n\tFile: /terraform/projects/app-search/main.tf:280-313\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.bucket[0]\n\tFile: /terraform/projects/app-wal-e-backups-postgresql/main.tf:68-95\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.bucket_with_transition\n\tFile: /terraform/projects/app-wal-e-backups-postgresql/main.tf:97-131\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.artefact_replication_destination\n\tFile: /terraform/projects/infra-artefact-bucket/main.tf:140-161\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.content_data_csvs\n\tFile: /terraform/projects/infra-content-data-admin/main.tf:35-57\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.activestorage_replica\n\tFile: /terraform/projects/infra-content-publisher/main.tf:92-119\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.database_backups\n\tFile: /terraform/projects/infra-database-backups-bucket/main.tf:100-276\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.govuk-mirror\n\tFile: /terraform/projects/infra-mirror-bucket/main.tf:149-209\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.govuk-mirror-replica\n\tFile: /terraform/projects/infra-mirror-bucket/main.tf:211-251\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.aws-logging\n\tFile: /terraform/projects/infra-monitoring/main.tf:107-150\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.aws-secondary-logging\n\tFile: /terraform/projects/infra-monitoring/secondary.tf:32-52\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.aws_waf_logs\n\tFile: /terraform/projects/infra-public-services/waf.tf:27-41\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.custom_formats_mapit\n\tFile: /terraform/projects/app-custom-formats-mapit-storage/main.tf:57-83\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t57 | resource \"aws_s3_bucket\" \"custom_formats_mapit\" {\n\t\t58 |   bucket = \"${var.bucket_name}-${var.aws_environment}\"\n\t\t59 | \n\t\t60 |   tags {\n\t\t61 |     Environment = \"${var.aws_environment}\"\n\t\t62 |     Team        = \"custom_formats\"\n\t\t63 |   }\n\t\t64 | \n\t\t65 |   versioning {\n\t\t66 |     enabled = true\n\t\t67 |   }\n\t\t68 | \n\t\t69 |   replication_configuration {\n\t\t70 |     role = \"${aws_iam_role.govuk_custom_formats_mapit_storage_replication_role.arn}\"\n\t\t71 | \n\t\t72 |     rules {\n\t\t73 |       id     = \"govuk-custom-formats-mapit-storage-replication-whole-bucket-rule\"\n\t\t74 |       prefix = \"\"\n\t\t75 |       status = \"Enabled\"\n\t\t76 | \n\t\t77 |       destination {\n\t\t78 |         bucket        = \"${aws_s3_bucket.custom_formats_mapit_replica.arn}\"\n\t\t79 |         storage_class = \"STANDARD\"\n\t\t80 |       }\n\t\t81 |     }\n\t\t82 |   }\n\t\t83 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.custom_formats_mapit_replica\n\tFile: /terraform/projects/app-custom-formats-mapit-storage/main.tf:85-98\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t85 | resource \"aws_s3_bucket\" \"custom_formats_mapit_replica\" {\n\t\t86 |   bucket   = \"${var.bucket_name}-replica-${var.aws_environment}\"\n\t\t87 |   region   = \"${var.aws_replica_region}\"\n\t\t88 |   provider = \"aws.aws_replica\"\n\t\t89 | \n\t\t90 |   tags {\n\t\t91 |     Name            = \"custom_formats_mapit_replica\"\n\t\t92 |     aws_environment = \"${var.aws_environment}\"\n\t\t93 |   }\n\t\t94 | \n\t\t95 |   versioning {\n\t\t96 |     enabled = true\n\t\t97 |   }\n\t\t98 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.manual_snapshots\n\tFile: /terraform/projects/app-elasticsearch6/main.tf:304-317\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t304 | resource \"aws_s3_bucket\" \"manual_snapshots\" {\n\t\t305 |   bucket = \"govuk-${var.aws_environment}-elasticsearch6-manual-snapshots\"\n\t\t306 |   region = \"${var.aws_region}\"\n\t\t307 | \n\t\t308 |   tags {\n\t\t309 |     Name            = \"govuk-${var.aws_environment}-elasticsearch6-manual-snapshots\"\n\t\t310 |     aws_environment = \"${var.aws_environment}\"\n\t\t311 |   }\n\t\t312 | \n\t\t313 |   logging {\n\t\t314 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t315 |     target_prefix = \"s3/govuk-${var.aws_environment}-elasticsearch6-manual-snapshots/\"\n\t\t316 |   }\n\t\t317 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.results\n\tFile: /terraform/projects/app-gatling/main.tf:151-157\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t151 | resource \"aws_s3_bucket\" \"results\" {\n\t\t152 |   bucket = \"gatling-results-${var.aws_environment}\"\n\t\t153 | \n\t\t154 |   website {\n\t\t155 |     index_document = \"index.html\"\n\t\t156 |   }\n\t\t157 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.bucket_without_lifecycle[0]\n\tFile: /terraform/projects/app-govuk-attachments/main.tf:91-105\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t91  | resource \"aws_s3_bucket\" \"bucket_without_lifecycle\" {\n\t\t92  |   count = \"${1 - var.lifecycle}\"\n\t\t93  | \n\t\t94  |   bucket = \"${var.bucket_name}-${var.aws_environment}\"\n\t\t95  |   acl    = \"private\"\n\t\t96  | \n\t\t97  |   tags {\n\t\t98  |     Environment = \"${var.aws_environment}\"\n\t\t99  |     Team        = \"${var.team}\"\n\t\t100 |   }\n\t\t101 | \n\t\t102 |   versioning {\n\t\t103 |     enabled = \"${var.versioning}\"\n\t\t104 |   }\n\t\t105 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.s3_bucket\n\tFile: /terraform/projects/app-related-links/main.tf:47-58\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t47 | resource \"aws_s3_bucket\" \"s3_bucket\" {\n\t\t48 |   bucket = \"${local.related_links_bucket_name}\"\n\t\t49 | \n\t\t50 |   versioning {\n\t\t51 |     enabled = true\n\t\t52 |   }\n\t\t53 | \n\t\t54 |   tags {\n\t\t55 |     aws_environment = \"${var.aws_environment}\"\n\t\t56 |     Name            = \"${local.related_links_bucket_name}\"\n\t\t57 |   }\n\t\t58 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.whitehall_csvs\n\tFile: /terraform/projects/app-whitehall-backend/main.tf:139-151\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t139 | resource \"aws_s3_bucket\" \"whitehall_csvs\" {\n\t\t140 |   bucket = \"govuk-${var.aws_environment}-whitehall-csvs\"\n\t\t141 | \n\t\t142 |   tags {\n\t\t143 |     name            = \"govuk-${var.aws_environment}-whitehall-csvs\"\n\t\t144 |     aws_environment = \"${var.aws_environment}\"\n\t\t145 |   }\n\t\t146 | \n\t\t147 |   logging {\n\t\t148 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t149 |     target_prefix = \"s3/govuk-${var.aws_environment}-whitehall-csvs/\"\n\t\t150 |   }\n\t\t151 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.artefact\n\tFile: /terraform/projects/infra-artefact-bucket/main.tf:164-195\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t164 | resource \"aws_s3_bucket\" \"artefact\" {\n\t\t165 |   bucket = \"govuk-${var.aws_environment}-artefact\"\n\t\t166 |   acl    = \"private\"\n\t\t167 | \n\t\t168 |   tags {\n\t\t169 |     Name            = \"govuk-${var.aws_environment}-artefact\"\n\t\t170 |     aws_environment = \"${var.aws_environment}\"\n\t\t171 |   }\n\t\t172 | \n\t\t173 |   versioning {\n\t\t174 |     enabled = true\n\t\t175 |   }\n\t\t176 | \n\t\t177 |   logging {\n\t\t178 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t179 |     target_prefix = \"s3/govuk-${var.aws_environment}-artefact/\"\n\t\t180 |   }\n\t\t181 | \n\t\t182 |   replication_configuration {\n\t\t183 |     role = \"${aws_iam_role.artefact_replication.arn}\"\n\t\t184 | \n\t\t185 |     rules {\n\t\t186 |       id     = \"govuk-artefact-replication-whole-bucket-rule\"\n\t\t187 |       status = \"${var.replication_setting}\"\n\t\t188 |       prefix = \"\"\n\t\t189 | \n\t\t190 |       destination {\n\t\t191 |         bucket = \"${aws_s3_bucket.artefact_replication_destination.arn}\"\n\t\t192 |       }\n\t\t193 |     }\n\t\t194 |   }\n\t\t195 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.assets_backup\n\tFile: /terraform/projects/infra-assets/backup.tf:6-14\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t6  | resource \"aws_s3_bucket\" \"assets_backup\" {\n\t\t7  |   provider = \"aws.backup_provider\"\n\t\t8  |   bucket   = \"govuk-assets-backup-${var.aws_environment}\"\n\t\t9  |   region   = \"${var.aws_backup_region}\"\n\t\t10 | \n\t\t11 |   versioning {\n\t\t12 |     enabled = true\n\t\t13 |   }\n\t\t14 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.assets\n\tFile: /terraform/projects/infra-assets/main.tf:41-72\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t41 | resource \"aws_s3_bucket\" \"assets\" {\n\t\t42 |   bucket = \"govuk-assets-${var.aws_environment}\"\n\t\t43 | \n\t\t44 |   tags {\n\t\t45 |     Name            = \"govuk-assets-${var.aws_environment}\"\n\t\t46 |     aws_environment = \"${var.aws_environment}\"\n\t\t47 |   }\n\t\t48 | \n\t\t49 |   logging {\n\t\t50 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t51 |     target_prefix = \"s3/govuk-assets-${var.aws_environment}/\"\n\t\t52 |   }\n\t\t53 | \n\t\t54 |   versioning {\n\t\t55 |     enabled = true\n\t\t56 |   }\n\t\t57 | \n\t\t58 |   replication_configuration {\n\t\t59 |     role = \"${aws_iam_role.backup.arn}\"\n\t\t60 | \n\t\t61 |     rules {\n\t\t62 |       id     = \"govuk-${var.aws_environment}-assets-replication-rule\"\n\t\t63 |       prefix = \"\"\n\t\t64 |       status = \"Enabled\"\n\t\t65 | \n\t\t66 |       destination {\n\t\t67 |         bucket        = \"${aws_s3_bucket.assets_backup.arn}\"\n\t\t68 |         storage_class = \"STANDARD\"\n\t\t69 |       }\n\t\t70 |     }\n\t\t71 |   }\n\t\t72 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.activestorage\n\tFile: /terraform/projects/infra-content-publisher/main.tf:59-90\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t59 | resource \"aws_s3_bucket\" \"activestorage\" {\n\t\t60 |   bucket = \"govuk-${var.aws_environment}-content-publisher-activestorage\"\n\t\t61 | \n\t\t62 |   tags {\n\t\t63 |     Name            = \"govuk-${var.aws_environment}-content-publisher-activestorage\"\n\t\t64 |     aws_environment = \"${var.aws_environment}\"\n\t\t65 |   }\n\t\t66 | \n\t\t67 |   logging {\n\t\t68 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t69 |     target_prefix = \"s3/govuk-${var.aws_environment}-content-publisher-activestorage/\"\n\t\t70 |   }\n\t\t71 | \n\t\t72 |   versioning {\n\t\t73 |     enabled = true\n\t\t74 |   }\n\t\t75 | \n\t\t76 |   replication_configuration {\n\t\t77 |     role = \"${aws_iam_role.govuk_content_publisher_activestorage_replication_role.arn}\"\n\t\t78 | \n\t\t79 |     rules {\n\t\t80 |       id     = \"govuk-content-publisher-activestorage-replication-whole-bucket-rule\"\n\t\t81 |       prefix = \"\"\n\t\t82 |       status = \"${var.replication_setting}\"\n\t\t83 | \n\t\t84 |       destination {\n\t\t85 |         bucket        = \"${aws_s3_bucket.activestorage_replica.arn}\"\n\t\t86 |         storage_class = \"STANDARD\"\n\t\t87 |       }\n\t\t88 |     }\n\t\t89 |   }\n\t\t90 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.database_backups_replica\n\tFile: /terraform/projects/infra-database-backups-bucket/main.tf:279-287\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t279 | resource \"aws_s3_bucket\" \"database_backups_replica\" {\n\t\t280 |   bucket   = \"govuk-${var.aws_environment}-database-backups-replica\"\n\t\t281 |   region   = \"${var.aws_backup_region}\"\n\t\t282 |   provider = \"aws.eu-london\"\n\t\t283 | \n\t\t284 |   versioning {\n\t\t285 |     enabled = true\n\t\t286 |   }\n\t\t287 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.datagovuk-organogram\n\tFile: /terraform/projects/infra-datagovuk-organogram-bucket/main.tf:63-84\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t63 | resource \"aws_s3_bucket\" \"datagovuk-organogram\" {\n\t\t64 |   bucket = \"datagovuk-${var.aws_environment}-ckan-organogram\"\n\t\t65 | \n\t\t66 |   cors_rule {\n\t\t67 |     allowed_methods = [\"GET\"]\n\t\t68 |     allowed_origins = \"${compact(list(var.domain, var.aws_environment == \"production\" ? \"https://staging.data.gov.uk\" : \"\"))}\"\n\t\t69 |   }\n\t\t70 | \n\t\t71 |   tags {\n\t\t72 |     Name            = \"datagovuk-${var.aws_environment}-ckan-organogram\"\n\t\t73 |     aws_environment = \"${var.aws_environment}\"\n\t\t74 |   }\n\t\t75 | \n\t\t76 |   logging {\n\t\t77 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t78 |     target_prefix = \"s3/datagovuk-${var.aws_environment}-ckan-organogram/\"\n\t\t79 |   }\n\t\t80 | \n\t\t81 |   versioning {\n\t\t82 |     enabled = true\n\t\t83 |   }\n\t\t84 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.datagovuk-static\n\tFile: /terraform/projects/infra-datagovuk-static-bucket/main.tf:63-79\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t63 | resource \"aws_s3_bucket\" \"datagovuk-static\" {\n\t\t64 |   bucket = \"datagovuk-${var.aws_environment}-ckan-static-data\"\n\t\t65 | \n\t\t66 |   tags {\n\t\t67 |     Name            = \"datagovuk-${var.aws_environment}-ckan-static-data\"\n\t\t68 |     aws_environment = \"${var.aws_environment}\"\n\t\t69 |   }\n\t\t70 | \n\t\t71 |   logging {\n\t\t72 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t73 |     target_prefix = \"s3/datagovuk-${var.aws_environment}-ckan-static-data/\"\n\t\t74 |   }\n\t\t75 | \n\t\t76 |   versioning {\n\t\t77 |     enabled = true\n\t\t78 |   }\n\t\t79 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.cdn_logs_monitor\n\tFile: /terraform/projects/infra-govuk-cdn-logs-monitor-bucket/main.tf:39-51\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t39 | resource \"aws_s3_bucket\" \"cdn_logs_monitor\" {\n\t\t40 |   bucket = \"govuk-${var.aws_environment}-cdn-logs-monitor-archive\"\n\t\t41 | \n\t\t42 |   tags {\n\t\t43 |     Name            = \"govuk-${var.aws_environment}-cdn-logs-monitor-archive\"\n\t\t44 |     aws_environment = \"${var.aws_environment}\"\n\t\t45 |   }\n\t\t46 | \n\t\t47 |   logging {\n\t\t48 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t49 |     target_prefix = \"s3/govuk-${var.aws_environment}-cdn-logs-monitor-archive/\"\n\t\t50 |   }\n\t\t51 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.specialist_publisher_csvs\n\tFile: /terraform/projects/infra-specialist-publisher/main.tf:35-47\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t35 | resource \"aws_s3_bucket\" \"specialist_publisher_csvs\" {\n\t\t36 |   bucket = \"govuk-${var.aws_environment}-specialist-publisher-csvs\"\n\t\t37 | \n\t\t38 |   tags {\n\t\t39 |     name            = \"govuk-${var.aws_environment}-specialist-publisher-csvs\"\n\t\t40 |     aws_environment = \"${var.aws_environment}\"\n\t\t41 |   }\n\t\t42 | \n\t\t43 |   logging {\n\t\t44 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t45 |     target_prefix = \"s3/govuk-${var.aws_environment}-specialist-publisher-csvs/\"\n\t\t46 |   }\n\t\t47 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.support_api_csvs\n\tFile: /terraform/projects/infra-support-api/main.tf:35-47\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t35 | resource \"aws_s3_bucket\" \"support_api_csvs\" {\n\t\t36 |   bucket = \"govuk-${var.aws_environment}-support-api-csvs\"\n\t\t37 | \n\t\t38 |   tags {\n\t\t39 |     name            = \"govuk-${var.aws_environment}-support-api-csvs\"\n\t\t40 |     aws_environment = \"${var.aws_environment}\"\n\t\t41 |   }\n\t\t42 | \n\t\t43 |   logging {\n\t\t44 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t45 |     target_prefix = \"s3/govuk-${var.aws_environment}-support-api-csvs/\"\n\t\t46 |   }\n\t\t47 | }\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/alphagov-govuk-aws-f844cd8e254b161bebef04101f8ce177bcd0840c/after/terraform/projects/infra-fastly-logs/main.tfֿ\n\n",
      "stderr": "2024-06-21 12:03:08,065 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/alphagov/csw-client-role.git:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:03:08,068 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/alphagov/tech-ops.git?ref=13f54e5//cyber-security/modules/gds_security_audit_role:None (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 65.12971486699826
    }
  },
  {
    "pattern": "Object storage lifecycle rules",
    "url": "https://github.com/alphagov/govuk-terraform-provisioning/commit/ac105ab0a5ae38fbf69167e072f8970a4a61c3e8",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 6, Skipped checks: 0, Parsing errors: 1\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.private_s3_bucket.aws_s3_bucket.bucket\n\tFile: /modules/private_s3_bucket/main.tf:39-67\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.lambda_app_bucket.aws_s3_bucket.bucket\n\tFile: /modules/private_s3_bucket/main.tf:39-67\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: module.paired_user.aws_s3_bucket.bucket\n\tFile: /modules/paired_user/main.tf:38-46\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t38 | resource \"aws_s3_bucket\" \"bucket\" {\n\t\t39 |     bucket = \"${var.bucket_name}-${var.environment}\"\n\t\t40 |     policy = \"${template_file.readonly_policy_file.rendered}\"\n\t\t41 | \n\t\t42 |     tags {\n\t\t43 |         Environment = \"${var.environment}\"\n\t\t44 |         Team = \"${var.team}\"\n\t\t45 |     }\n\t\t46 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.terraform_state_bucket\n\tFile: /projects/aws_bootstrap/resources/state_bucket.tf:11-18\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t11 | resource \"aws_s3_bucket\" \"terraform_state_bucket\" {\n\t\t12 |     acl = \"private\"\n\t\t13 |     bucket = \"${var.terraform_state_bucket_name}-${var.environment}\"\n\t\t14 |     tags {\n\t\t15 |         Environment = \"${var.environment}\"\n\t\t16 |         Team = \"Infrastructure\"\n\t\t17 |     }\n\t\t18 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.email_alert_inbox_bucket\n\tFile: /projects/email_alert_notifications/resources/email_alert_notifications.tf:34-38\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t34 | resource \"aws_s3_bucket\" \"email_alert_inbox_bucket\" {\n\t\t35 |   bucket = \"${var.s3_bucket_name}-${var.environment}\"\n\t\t36 |   acl = \"public-read\"\n\t\t37 |   policy = \"${template_file.s3_bucket_policy.rendered}\"\n\t\t38 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.govuk-mongodb-backup-s3\n\tFile: /projects/mongodb-backup-s3/resources/storage_and_access.tf:33-44\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t33 | resource \"aws_s3_bucket\" \"govuk-mongodb-backup-s3\" {\n\t\t34 |     bucket = \"${var.bucket_name}-${var.environment}\"\n\t\t35 | \n\t\t36 |     tags {\n\t\t37 |         Environment = \"${var.environment}\"\n\t\t38 |         Team = \"${var.team}\"\n\t\t39 |     }\n\t\t40 | \n\t\t41 |     versioning {\n\t\t42 |         enabled = \"${var.versioning}\"\n\t\t43 |     }\n\t\t44 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.govuk-mongodb-backup-s3-daily\n\tFile: /projects/mongodb-backup-s3/resources/storage_and_access.tf:48-59\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t48 | resource \"aws_s3_bucket\" \"govuk-mongodb-backup-s3-daily\" {\n\t\t49 |     bucket = \"${var.bucket_name}-daily-${var.environment}\"\n\t\t50 | \n\t\t51 |     tags {\n\t\t52 |         Environment = \"${var.environment}\"\n\t\t53 |         Team = \"${var.team}\"\n\t\t54 |     }\n\t\t55 | \n\t\t56 |     versioning {\n\t\t57 |         enabled = \"${var.versioning}\"\n\t\t58 |     }\n\t\t59 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.uktt_data_bucket\n\tFile: /projects/uktt_data/resources/production/main.tf:6-16\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t6  | resource \"aws_s3_bucket\" \"uktt_data_bucket\" {\n\t\t7  |     acl = \"private\"\n\t\t8  |     bucket = \"${var.uktt_data_bucket_name}-${var.environment}\"\n\t\t9  |     versioning {\n\t\t10 |       enabled = true\n\t\t11 |     }\n\t\t12 |     tags {\n\t\t13 |         Environment = \"${var.environment}\"\n\t\t14 |         Team = \"Infrastructure\"\n\t\t15 |     }\n\t\t16 | }\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/alphagov-govuk-terraform-provisioning-ac105ab0a5ae38fbf69167e072f8970a4a61c3e8/before-c167e29c9d5867b897bd035315341d14fff84f29/projects/uktt_data/README.tfֿ\n\n",
        "stderr": "",
        "duration_seconds": 7.962051231006626
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 4, Failed checks: 4, Skipped checks: 0, Parsing errors: 1\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.private_s3_bucket.aws_s3_bucket.bucket\n\tFile: /modules/private_s3_bucket/main.tf:39-67\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.lambda_app_bucket.aws_s3_bucket.bucket\n\tFile: /modules/private_s3_bucket/main.tf:39-67\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.govuk-mongodb-backup-s3\n\tFile: /projects/mongodb-backup-s3/resources/storage_and_access.tf:33-53\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.govuk-mongodb-backup-s3-daily\n\tFile: /projects/mongodb-backup-s3/resources/storage_and_access.tf:57-85\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: module.paired_user.aws_s3_bucket.bucket\n\tFile: /modules/paired_user/main.tf:38-46\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t38 | resource \"aws_s3_bucket\" \"bucket\" {\n\t\t39 |     bucket = \"${var.bucket_name}-${var.environment}\"\n\t\t40 |     policy = \"${template_file.readonly_policy_file.rendered}\"\n\t\t41 | \n\t\t42 |     tags {\n\t\t43 |         Environment = \"${var.environment}\"\n\t\t44 |         Team = \"${var.team}\"\n\t\t45 |     }\n\t\t46 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.terraform_state_bucket\n\tFile: /projects/aws_bootstrap/resources/state_bucket.tf:11-18\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t11 | resource \"aws_s3_bucket\" \"terraform_state_bucket\" {\n\t\t12 |     acl = \"private\"\n\t\t13 |     bucket = \"${var.terraform_state_bucket_name}-${var.environment}\"\n\t\t14 |     tags {\n\t\t15 |         Environment = \"${var.environment}\"\n\t\t16 |         Team = \"Infrastructure\"\n\t\t17 |     }\n\t\t18 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.email_alert_inbox_bucket\n\tFile: /projects/email_alert_notifications/resources/email_alert_notifications.tf:34-38\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t34 | resource \"aws_s3_bucket\" \"email_alert_inbox_bucket\" {\n\t\t35 |   bucket = \"${var.s3_bucket_name}-${var.environment}\"\n\t\t36 |   acl = \"public-read\"\n\t\t37 |   policy = \"${template_file.s3_bucket_policy.rendered}\"\n\t\t38 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.uktt_data_bucket\n\tFile: /projects/uktt_data/resources/production/main.tf:6-16\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t6  | resource \"aws_s3_bucket\" \"uktt_data_bucket\" {\n\t\t7  |     acl = \"private\"\n\t\t8  |     bucket = \"${var.uktt_data_bucket_name}-${var.environment}\"\n\t\t9  |     versioning {\n\t\t10 |       enabled = true\n\t\t11 |     }\n\t\t12 |     tags {\n\t\t13 |         Environment = \"${var.environment}\"\n\t\t14 |         Team = \"Infrastructure\"\n\t\t15 |     }\n\t\t16 | }\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/alphagov-govuk-terraform-provisioning-ac105ab0a5ae38fbf69167e072f8970a4a61c3e8/after/projects/uktt_data/README.tfֿ\n\n",
      "stderr": "",
      "duration_seconds": 7.557499943999574
    }
  },
  {
    "pattern": "Object storage lifecycle rules",
    "url": "https://github.com/ExpediaGroup/apiary-data-lake/commit/47e62f2fc73a96611606cd619c084d1ded9d844d",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.apiary_data_bucket\n\tFile: /s3.tf:28-40\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t28 | resource \"aws_s3_bucket\" \"apiary_data_bucket\" {\n\t\t29 |   count         = \"${length(local.apiary_data_buckets)}\"\n\t\t30 |   bucket        = \"${element(local.apiary_data_buckets, count.index)}\"\n\t\t31 |   acl           = \"private\"\n\t\t32 |   request_payer = \"BucketOwner\"\n\t\t33 |   policy        = \"${data.template_file.bucket_policy.*.rendered[count.index]}\"\n\t\t34 |   tags          = \"${var.apiary_tags}\"\n\t\t35 | \n\t\t36 |   logging {\n\t\t37 |     target_bucket = \"${var.apiary_log_bucket}\"\n\t\t38 |     target_prefix = \"${var.apiary_log_prefix}${local.apiary_data_buckets[count.index]}/\"\n\t\t39 |   }\n\t\t40 | }\n\nterraform_plan scan results:\n\nPassed checks: 0, Failed checks: 0, Skipped checks: 0, Parsing errors: 2\n\nError parsing file snapshots/ExpediaGroup-apiary-data-lake-47e62f2fc73a96611606cd619c084d1ded9d844d/before-f3c3068c66185f51ba97ed71a14ffdbea2a698b1/templates/apiary-hms-readonly.jsonֿ\nError parsing file snapshots/ExpediaGroup-apiary-data-lake-47e62f2fc73a96611606cd619c084d1ded9d844d/before-f3c3068c66185f51ba97ed71a14ffdbea2a698b1/templates/apiary-hms-readwrite.jsonֿ\n\n",
        "stderr": "",
        "duration_seconds": 8.16832514500129
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.apiary_data_bucket\n\tFile: /s3.tf:28-50\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nterraform_plan scan results:\n\nPassed checks: 0, Failed checks: 0, Skipped checks: 0, Parsing errors: 2\n\nError parsing file snapshots/ExpediaGroup-apiary-data-lake-47e62f2fc73a96611606cd619c084d1ded9d844d/after/templates/apiary-hms-readonly.jsonֿ\nError parsing file snapshots/ExpediaGroup-apiary-data-lake-47e62f2fc73a96611606cd619c084d1ded9d844d/after/templates/apiary-hms-readwrite.jsonֿ\n\n",
      "stderr": "",
      "duration_seconds": 7.554762747997302
    }
  },
  {
    "pattern": "Object storage lifecycle rules",
    "url": "https://github.com/SamTowne/BasketballDrillBot/commit/4ec6d54e4d36ab02b0a7daf042e727717371eaec",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 4, Skipped checks: 0\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: module.bootstrap.aws_s3_bucket.state_bucket\n\tFile: /modules/bootstrap/bootstrap.tf:2-18\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t2  | resource \"aws_s3_bucket\" \"state_bucket\" {\n\t\t3  |   bucket = var.tfstate_bucket\n\t\t4  | \n\t\t5  |   # Tells AWS to encrypt the S3 bucket at rest by default\n\t\t6  |   server_side_encryption_configuration {\n\t\t7  |     rule {\n\t\t8  |       apply_server_side_encryption_by_default {\n\t\t9  |         sse_algorithm = \"AES256\"\n\t\t10 |       }\n\t\t11 |     }\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   # Tells AWS to keep a version history of the state file\n\t\t15 |   versioning {\n\t\t16 |     enabled = true\n\t\t17 |   }\n\t\t18 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: module.bootstrap.aws_s3_bucket.s3_logging_bucket\n\tFile: /modules/bootstrap/bootstrap.tf:39-50\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t39 | resource \"aws_s3_bucket\" \"s3_logging_bucket\" {\n\t\t40 |   bucket = var.logging_bucket\n\t\t41 |   acl    = \"private\"\n\t\t42 | \n\t\t43 |   server_side_encryption_configuration {\n\t\t44 |     rule {\n\t\t45 |       apply_server_side_encryption_by_default {\n\t\t46 |         sse_algorithm = \"AES256\"\n\t\t47 |       }\n\t\t48 |     }\n\t\t49 |   }\n\t\t50 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: module.bootstrap.aws_s3_bucket.s3_data_bucket\n\tFile: /modules/bootstrap/bootstrap.tf:53-87\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t53 | resource \"aws_s3_bucket\" \"s3_data_bucket\" {\n\t\t54 |   bucket = var.data_bucket\n\t\t55 |   acl    = \"private\"\n\t\t56 |   policy = <<EOT\n\t\t57 | {\n\t\t58 |   \"Id\": \"SIDataBucketPolicy\",\n\t\t59 |   \"Version\": \"2012-10-17\",\n\t\t60 |   \"Statement\": [\n\t\t61 |     {\n\t\t62 |       \"Sid\": \"lambda\",\n\t\t63 |       \"Action\": [\n\t\t64 |         \"s3:PutObject\"\n\t\t65 |       ],\n\t\t66 |       \"Effect\": \"Allow\",\n\t\t67 |       \"Resource\": [\n\t\t68 |         \"arn:aws:s3:::shooting-insights-data/*\"\n\t\t69 |       ],\n\t\t70 |       \"Principal\": {\n\t\t71 |         \"AWS\": [\n\t\t72 |           \"arn:aws:iam::272773485930:role/collection_lambda_role\"\n\t\t73 |         ]\n\t\t74 |       }\n\t\t75 |     }\n\t\t76 |   ]\n\t\t77 | }\n\t\t78 |   EOT\n\t\t79 | \n\t\t80 |   server_side_encryption_configuration {\n\t\t81 |     rule {\n\t\t82 |       apply_server_side_encryption_by_default {\n\t\t83 |         sse_algorithm = \"AES256\"\n\t\t84 |       }\n\t\t85 |     }\n\t\t86 |   }\n\t\t87 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: module.processing.aws_s3_bucket.athena_results_bucket\n\tFile: /modules/processing/processing.tf:2-37\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t2  | resource \"aws_s3_bucket\" \"athena_results_bucket\" {\n\t\t3  |   bucket = \"shooting-insights-athena-results\"\n\t\t4  |   acl    = \"private\"\n\t\t5  |   policy = <<EOT\n\t\t6  | {\n\t\t7  |   \"Id\": \"SIDataBucketPolicy\",\n\t\t8  |   \"Version\": \"2012-10-17\",\n\t\t9  |   \"Statement\": [\n\t\t10 |     {\n\t\t11 |       \"Sid\": \"lambda\",\n\t\t12 |       \"Action\": [\n\t\t13 |         \"s3:PutObject\"\n\t\t14 |       ],\n\t\t15 |       \"Effect\": \"Allow\",\n\t\t16 |       \"Resource\": [\n\t\t17 |         \"arn:aws:s3:::shooting-insights-athena-results/*\"\n\t\t18 |       ],\n\t\t19 |       \"Principal\": {\n\t\t20 |         \"AWS\": [\n\t\t21 |           \"arn:aws:iam::272773485930:role/collection_lambda_role\",\n\t\t22 |           \"arn:aws:iam::272773485930:role/processing_lambda_role\"\n\t\t23 |         ]\n\t\t24 |       }\n\t\t25 |     }\n\t\t26 |   ]\n\t\t27 | }\n\t\t28 |   EOT\n\t\t29 | \n\t\t30 |   server_side_encryption_configuration {\n\t\t31 |     rule {\n\t\t32 |       apply_server_side_encryption_by_default {\n\t\t33 |         sse_algorithm = \"AES256\"\n\t\t34 |       }\n\t\t35 |     }\n\t\t36 |   }\n\t\t37 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 7.033398444997147
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 5, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.bootstrap.aws_s3_bucket.state_bucket\n\tFile: /modules/bootstrap/bootstrap.tf:2-32\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.bootstrap.aws_s3_bucket.s3_data_bucket\n\tFile: /modules/bootstrap/bootstrap.tf:52-101\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.collection.aws_s3_bucket.shooting_insights_temp_bucket\n\tFile: /modules/collection/collection.tf:102-149\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.processing.aws_s3_bucket.athena_results_bucket\n\tFile: /modules/processing/processing.tf:2-53\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.processing.aws_s3_bucket.setup_processing_results_bucket\n\tFile: /modules/processing/processing.tf:56-105\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n",
      "stderr": "",
      "duration_seconds": 8.51343761899625
    }
  },
  {
    "pattern": "Object storage lifecycle rules",
    "url": "https://github.com/utilitywarehouse/tf_telecom/commit/17007456991c1a8faa26b1f4ac993883f577d124",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.bucket\n\tFile: /aws/bucket/main.tf:105-118\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t105 | resource \"aws_s3_bucket\" \"bucket\" {\n\t\t106 |   bucket = format(\n\t\t107 |     \"uw-%s-%s-%s\",\n\t\t108 |     replace(var.team, \"/^uw-/\", \"\"),\n\t\t109 |     var.name,\n\t\t110 |     var.env,\n\t\t111 |   )\n\t\t112 |   acl    = \"private\"\n\t\t113 |   policy = data.aws_iam_policy_document.access.json\n\t\t114 |   tags = {\n\t\t115 |     terraform = \"Managed by terraform\"\n\t\t116 |     team      = var.team\n\t\t117 |   }\n\t\t118 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 6.6743124530039495
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 0, Skipped checks: 0, Parsing errors: 1\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/utilitywarehouse-tf_telecom-17007456991c1a8faa26b1f4ac993883f577d124/after/aws/bucket/main.tfֿ\n\n",
      "stderr": "",
      "duration_seconds": 7.4354833269899245
    }
  },
  {
    "pattern": "Object storage lifecycle rules",
    "url": "https://github.com/trajano/terraform-s3-backend/commit/cb9f00a2f6f23b44f7db08863ef5fb0b9ea0bc0c",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: module.terraform-s3-backend.aws_s3_bucket.terraform\n\tFile: /main.tf:45-57\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t45 | resource \"aws_s3_bucket\" \"terraform\" {\n\t\t46 |   bucket = var.bucket\n\t\t47 |   acl    = \"private\"\n\t\t48 |   region = var.region\n\t\t49 | \n\t\t50 |   tags = {\n\t\t51 |     Name = \"Terraform S3 backend bucket\"\n\t\t52 |   }\n\t\t53 | \n\t\t54 |   versioning {\n\t\t55 |     enabled = true\n\t\t56 |   }\n\t\t57 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 5.969567780994112
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.terraform-s3-backend.aws_s3_bucket.terraform\n\tFile: /main.tf:45-64\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n",
      "stderr": "",
      "duration_seconds": 6.093741215998307
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/deptno/terraform-aws-modules/commit/49f447bdbb3cf23499e8194e78f852ea1e256d3a",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.token\n\tFile: /serverless-passport/main.tf:1-18\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.token\n\tFile: /serverless-passport/main.tf:1-18\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.token\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /serverless-passport/main.tf:1-18\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource aws_dynamodb_table token {\n\t\t2  |   name = var.token-table-name\n\t\t3  |   hash_key = var.token-table-hash-key\n\t\t4  |   range_key = var.token-table-range-key\n\t\t5  | \n\t\t6  |   ttl {\n\t\t7  |     attribute_name = var.token-table-ttl-key\n\t\t8  |   }\n\t\t9  | \n\t\t10 |   attribute {\n\t\t11 |     name = var.token-table-hash-key\n\t\t12 |     type = \"S\"\n\t\t13 |   }\n\t\t14 |   attribute {\n\t\t15 |     name = var.token-table-range-key\n\t\t16 |     type = \"S\"\n\t\t17 |   }\n\t\t18 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 5.646603661996778
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.token\n\tFile: /serverless-passport/main.tf:1-19\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.token\n\tFile: /serverless-passport/main.tf:1-19\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.token\n\tFile: /serverless-passport/main.tf:1-19\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "",
      "duration_seconds": 6.593637911995756
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/ONSdigital/eq-terraform-dynamodb/commit/40eb651a50d0dfd5cf047ef62c8a6259c1c66e02",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 4, Failed checks: 8, Skipped checks: 0\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.eq_session_table\n\tFile: /eq_session.tf:1-29\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.questionnaire_state_table\n\tFile: /questionnaire_state.tf:1-20\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.submitted_responses_table\n\tFile: /submitted_responses.tf:1-25\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.used_jti_claim_table\n\tFile: /used_jti_claim.tf:1-25\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.eq_session_table\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /eq_session.tf:1-29\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"eq_session_table\" {\n\t\t2  |   name           = \"${var.env}-eq-session\"\n\t\t3  |   read_capacity  = \"${var.eq_session_min_read_capacity}\"\n\t\t4  |   write_capacity = \"${var.eq_session_min_write_capacity}\"\n\t\t5  |   hash_key       = \"eq_session_id\"\n\t\t6  | \n\t\t7  |   attribute {\n\t\t8  |     name = \"eq_session_id\"\n\t\t9  |     type = \"S\"\n\t\t10 |   }\n\t\t11 | \n\t\t12 |   ttl {\n\t\t13 |     attribute_name = \"expires_at\"\n\t\t14 |     enabled        = true\n\t\t15 |   }\n\t\t16 | \n\t\t17 |   tags {\n\t\t18 |     Name        = \"${var.env}-eq-session\"\n\t\t19 |     Environment = \"${var.env}\"\n\t\t20 |   }\n\t\t21 | \n\t\t22 |   point_in_time_recovery {\n\t\t23 |     enabled = true\n\t\t24 |   }\n\t\t25 | \n\t\t26 |   lifecycle {\n\t\t27 |     ignore_changes = [\"read_capacity\", \"write_capacity\"]\n\t\t28 |   }\n\t\t29 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.eq_session_table\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /eq_session.tf:1-29\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"eq_session_table\" {\n\t\t2  |   name           = \"${var.env}-eq-session\"\n\t\t3  |   read_capacity  = \"${var.eq_session_min_read_capacity}\"\n\t\t4  |   write_capacity = \"${var.eq_session_min_write_capacity}\"\n\t\t5  |   hash_key       = \"eq_session_id\"\n\t\t6  | \n\t\t7  |   attribute {\n\t\t8  |     name = \"eq_session_id\"\n\t\t9  |     type = \"S\"\n\t\t10 |   }\n\t\t11 | \n\t\t12 |   ttl {\n\t\t13 |     attribute_name = \"expires_at\"\n\t\t14 |     enabled        = true\n\t\t15 |   }\n\t\t16 | \n\t\t17 |   tags {\n\t\t18 |     Name        = \"${var.env}-eq-session\"\n\t\t19 |     Environment = \"${var.env}\"\n\t\t20 |   }\n\t\t21 | \n\t\t22 |   point_in_time_recovery {\n\t\t23 |     enabled = true\n\t\t24 |   }\n\t\t25 | \n\t\t26 |   lifecycle {\n\t\t27 |     ignore_changes = [\"read_capacity\", \"write_capacity\"]\n\t\t28 |   }\n\t\t29 | }\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.questionnaire_state_table\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /questionnaire_state.tf:1-20\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"questionnaire_state_table\" {\n\t\t2  |   name           = \"${var.env}-questionnaire-state\"\n\t\t3  |   read_capacity  = \"${var.questionnaire_state_min_read_capacity}\"\n\t\t4  |   write_capacity = \"${var.questionnaire_state_min_write_capacity}\"\n\t\t5  |   hash_key       = \"user_id\"\n\t\t6  | \n\t\t7  |   attribute {\n\t\t8  |     name = \"user_id\"\n\t\t9  |     type = \"S\"\n\t\t10 |   }\n\t\t11 | \n\t\t12 |   tags {\n\t\t13 |     Name        = \"${var.env}-questionnaire-state\"\n\t\t14 |     Environment = \"${var.env}\"\n\t\t15 |   }\n\t\t16 | \n\t\t17 |   lifecycle {\n\t\t18 |     ignore_changes = [\"read_capacity\", \"write_capacity\"]\n\t\t19 |   }\n\t\t20 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.questionnaire_state_table\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /questionnaire_state.tf:1-20\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"questionnaire_state_table\" {\n\t\t2  |   name           = \"${var.env}-questionnaire-state\"\n\t\t3  |   read_capacity  = \"${var.questionnaire_state_min_read_capacity}\"\n\t\t4  |   write_capacity = \"${var.questionnaire_state_min_write_capacity}\"\n\t\t5  |   hash_key       = \"user_id\"\n\t\t6  | \n\t\t7  |   attribute {\n\t\t8  |     name = \"user_id\"\n\t\t9  |     type = \"S\"\n\t\t10 |   }\n\t\t11 | \n\t\t12 |   tags {\n\t\t13 |     Name        = \"${var.env}-questionnaire-state\"\n\t\t14 |     Environment = \"${var.env}\"\n\t\t15 |   }\n\t\t16 | \n\t\t17 |   lifecycle {\n\t\t18 |     ignore_changes = [\"read_capacity\", \"write_capacity\"]\n\t\t19 |   }\n\t\t20 | }\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.submitted_responses_table\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /submitted_responses.tf:1-25\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"submitted_responses_table\" {\n\t\t2  |   name           = \"${var.env}-submitted-responses\"\n\t\t3  |   read_capacity  = \"${var.submitted_responses_min_read_capacity}\"\n\t\t4  |   write_capacity = \"${var.submitted_responses_min_write_capacity}\"\n\t\t5  |   hash_key       = \"tx_id\"\n\t\t6  | \n\t\t7  |   attribute {\n\t\t8  |     name = \"tx_id\"\n\t\t9  |     type = \"S\"\n\t\t10 |   }\n\t\t11 | \n\t\t12 |   ttl {\n\t\t13 |     attribute_name = \"valid_until\"\n\t\t14 |     enabled        = true\n\t\t15 |   }\n\t\t16 | \n\t\t17 |   tags {\n\t\t18 |     Name        = \"${var.env}-submitted-responses\"\n\t\t19 |     Environment = \"${var.env}\"\n\t\t20 |   }\n\t\t21 | \n\t\t22 |   lifecycle {\n\t\t23 |     ignore_changes = [\"read_capacity\", \"write_capacity\"]\n\t\t24 |   }\n\t\t25 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.submitted_responses_table\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /submitted_responses.tf:1-25\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"submitted_responses_table\" {\n\t\t2  |   name           = \"${var.env}-submitted-responses\"\n\t\t3  |   read_capacity  = \"${var.submitted_responses_min_read_capacity}\"\n\t\t4  |   write_capacity = \"${var.submitted_responses_min_write_capacity}\"\n\t\t5  |   hash_key       = \"tx_id\"\n\t\t6  | \n\t\t7  |   attribute {\n\t\t8  |     name = \"tx_id\"\n\t\t9  |     type = \"S\"\n\t\t10 |   }\n\t\t11 | \n\t\t12 |   ttl {\n\t\t13 |     attribute_name = \"valid_until\"\n\t\t14 |     enabled        = true\n\t\t15 |   }\n\t\t16 | \n\t\t17 |   tags {\n\t\t18 |     Name        = \"${var.env}-submitted-responses\"\n\t\t19 |     Environment = \"${var.env}\"\n\t\t20 |   }\n\t\t21 | \n\t\t22 |   lifecycle {\n\t\t23 |     ignore_changes = [\"read_capacity\", \"write_capacity\"]\n\t\t24 |   }\n\t\t25 | }\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.used_jti_claim_table\n\tDetails: Using high write capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /used_jti_claim.tf:1-25\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"used_jti_claim_table\" {\n\t\t2  |   name           = \"${var.env}-used-jti-claim\"\n\t\t3  |   read_capacity  = \"${var.used_jti_claim_min_read_capacity}\"\n\t\t4  |   write_capacity = \"${var.used_jti_claim_min_write_capacity}\"\n\t\t5  |   hash_key       = \"jti_claim\"\n\t\t6  | \n\t\t7  |   attribute {\n\t\t8  |     name = \"jti_claim\"\n\t\t9  |     type = \"S\"\n\t\t10 |   }\n\t\t11 | \n\t\t12 |   ttl {\n\t\t13 |     attribute_name = \"expires\"\n\t\t14 |     enabled        = true\n\t\t15 |   }\n\t\t16 | \n\t\t17 |   tags {\n\t\t18 |     Name        = \"${var.env}-used-jti-claim\"\n\t\t19 |     Environment = \"${var.env}\"\n\t\t20 |   }\n\t\t21 | \n\t\t22 |   lifecycle {\n\t\t23 |     ignore_changes = [\"read_capacity\", \"write_capacity\"]\n\t\t24 |   }\n\t\t25 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.used_jti_claim_table\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /used_jti_claim.tf:1-25\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"used_jti_claim_table\" {\n\t\t2  |   name           = \"${var.env}-used-jti-claim\"\n\t\t3  |   read_capacity  = \"${var.used_jti_claim_min_read_capacity}\"\n\t\t4  |   write_capacity = \"${var.used_jti_claim_min_write_capacity}\"\n\t\t5  |   hash_key       = \"jti_claim\"\n\t\t6  | \n\t\t7  |   attribute {\n\t\t8  |     name = \"jti_claim\"\n\t\t9  |     type = \"S\"\n\t\t10 |   }\n\t\t11 | \n\t\t12 |   ttl {\n\t\t13 |     attribute_name = \"expires\"\n\t\t14 |     enabled        = true\n\t\t15 |   }\n\t\t16 | \n\t\t17 |   tags {\n\t\t18 |     Name        = \"${var.env}-used-jti-claim\"\n\t\t19 |     Environment = \"${var.env}\"\n\t\t20 |   }\n\t\t21 | \n\t\t22 |   lifecycle {\n\t\t23 |     ignore_changes = [\"read_capacity\", \"write_capacity\"]\n\t\t24 |   }\n\t\t25 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 6.6789816379896365
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 12, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.eq_session_table\n\tFile: /eq_session.tf:1-28\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.eq_session_table\n\tFile: /eq_session.tf:1-28\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.eq_session_table\n\tFile: /eq_session.tf:1-28\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.questionnaire_state_table\n\tFile: /questionnaire_state.tf:1-19\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.questionnaire_state_table\n\tFile: /questionnaire_state.tf:1-19\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.questionnaire_state_table\n\tFile: /questionnaire_state.tf:1-19\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.submitted_responses_table\n\tFile: /submitted_responses.tf:1-24\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.submitted_responses_table\n\tFile: /submitted_responses.tf:1-24\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.submitted_responses_table\n\tFile: /submitted_responses.tf:1-24\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.used_jti_claim_table\n\tFile: /used_jti_claim.tf:1-24\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.used_jti_claim_table\n\tFile: /used_jti_claim.tf:1-24\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.used_jti_claim_table\n\tFile: /used_jti_claim.tf:1-24\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "",
      "duration_seconds": 6.327732541001751
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/olliefr/aws-terraform-cloud1/commit/bf753832a519b0649f8d58d93aa643afe3f94fc7",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.tfc_example_table\n\tFile: /example.tf:45-56\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.tfc_example_table\n\tFile: /example.tf:45-56\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.tfc_example_table\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /example.tf:45-56\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t45 | resource \"aws_dynamodb_table\" \"tfc_example_table\" {\n\t\t46 |   name = \"${var.db_table_name}-${random_pet.table_name.id}\"\n\t\t47 | \n\t\t48 |   read_capacity  = var.db_read_capacity\n\t\t49 |   write_capacity = var.db_write_capacity\n\t\t50 |   hash_key       = \"UUID\"\n\t\t51 | \n\t\t52 |   attribute {\n\t\t53 |     name = \"UUID\"\n\t\t54 |     type = \"S\"\n\t\t55 |   }\n\t\t56 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 5.766746485998738
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.tfc_example_table\n\tFile: /example.tf:45-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.tfc_example_table\n\tFile: /example.tf:45-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.tfc_example_table\n\tFile: /example.tf:45-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "",
      "duration_seconds": 6.3766350820078515
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/garylb2/terraform-example-patterns/commit/6de6d83d930bd9459e1cf8c311fa7b45c3f90987",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 6, Failed checks: 12, Skipped checks: 0, Parsing errors: 9\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.data\n\tFile: /basic-terraform/awsaccnt1/us-west-2/lookup/dynamodb.tf:3-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.data\n\tFile: /basic-terraform/nonprod/us-west-2/lookup/dynamodb.tf:3-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.persistence.aws_dynamodb_table.data\n\tFile: /dry-workspace-terragrunt/modules/persistence/main.tf:3-57\n\tCalling File: /dry-workspace-terragrunt/modules/plumbing/main.tf:14-21\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.persistence.aws_dynamodb_table.data\n\tFile: /envvar-terragrunt/modules/persistence/main.tf:3-57\n\tCalling File: /envvar-terragrunt/modules/plumbing/main.tf:6-12\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.persistence.aws_dynamodb_table.data\n\tFile: /module-terraform/modules/persistence/main.tf:3-57\n\tCalling File: /module-terraform/awsaccnt1/us-west-2/lookup/main.tf:34-40\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.data\n\tFile: /module-terragrunt/modules/persistence/main.tf:3-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: aws_dynamodb_table.data\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /basic-terraform/awsaccnt1/us-west-2/lookup/dynamodb.tf:3-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.data\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /basic-terraform/awsaccnt1/us-west-2/lookup/dynamodb.tf:3-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: aws_dynamodb_table.data\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /basic-terraform/nonprod/us-west-2/lookup/dynamodb.tf:3-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.data\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /basic-terraform/nonprod/us-west-2/lookup/dynamodb.tf:3-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: module.persistence.aws_dynamodb_table.data\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /dry-workspace-terragrunt/modules/persistence/main.tf:3-57\n\tCalling File: /dry-workspace-terragrunt/modules/plumbing/main.tf:14-21\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.persistence.aws_dynamodb_table.data\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /dry-workspace-terragrunt/modules/persistence/main.tf:3-57\n\tCalling File: /dry-workspace-terragrunt/modules/plumbing/main.tf:14-21\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: module.persistence.aws_dynamodb_table.data\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /envvar-terragrunt/modules/persistence/main.tf:3-57\n\tCalling File: /envvar-terragrunt/modules/plumbing/main.tf:6-12\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.persistence.aws_dynamodb_table.data\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /envvar-terragrunt/modules/persistence/main.tf:3-57\n\tCalling File: /envvar-terragrunt/modules/plumbing/main.tf:6-12\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: module.persistence.aws_dynamodb_table.data\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /module-terraform/modules/persistence/main.tf:3-57\n\tCalling File: /module-terraform/awsaccnt1/us-west-2/lookup/main.tf:34-40\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.persistence.aws_dynamodb_table.data\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /module-terraform/modules/persistence/main.tf:3-57\n\tCalling File: /module-terraform/awsaccnt1/us-west-2/lookup/main.tf:34-40\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: aws_dynamodb_table.data\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /module-terragrunt/modules/persistence/main.tf:3-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.data\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /module-terragrunt/modules/persistence/main.tf:3-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/before-2701c8528649a1f31badd02b46cee2f390d593d5/basic-terraform/awsaccnt1/us-west-2/lookup/api.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/before-2701c8528649a1f31badd02b46cee2f390d593d5/basic-terraform/nonprod/us-west-2/lookup/api.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/before-2701c8528649a1f31badd02b46cee2f390d593d5/dry-workspace-terragrunt/modules/api/lookup-method.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/before-2701c8528649a1f31badd02b46cee2f390d593d5/dry-workspace-terragrunt/systems/terraform.tfvarsֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/before-2701c8528649a1f31badd02b46cee2f390d593d5/envvar-terragrunt/modules/api/lookup-method.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/before-2701c8528649a1f31badd02b46cee2f390d593d5/envvar-terragrunt/systems/terraform.tfvarsֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/before-2701c8528649a1f31badd02b46cee2f390d593d5/module-terraform/modules/api/lookup-method.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/before-2701c8528649a1f31badd02b46cee2f390d593d5/module-terragrunt/modules/api/lookup-method.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/before-2701c8528649a1f31badd02b46cee2f390d593d5/module-terragrunt/systems/terraform.tfvarsֿ\n\n",
        "stderr": "",
        "duration_seconds": 8.788350204995368
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 12, Failed checks: 6, Skipped checks: 0, Parsing errors: 9\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.data\n\tFile: /basic-terraform/awsaccnt1/us-west-2/lookup/dynamodb.tf:3-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.data\n\tFile: /basic-terraform/awsaccnt1/us-west-2/lookup/dynamodb.tf:3-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.data\n\tFile: /basic-terraform/nonprod/us-west-2/lookup/dynamodb.tf:3-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.data\n\tFile: /basic-terraform/nonprod/us-west-2/lookup/dynamodb.tf:3-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.persistence.aws_dynamodb_table.data\n\tFile: /dry-workspace-terragrunt/modules/persistence/main.tf:3-47\n\tCalling File: /dry-workspace-terragrunt/modules/plumbing/main.tf:14-21\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.persistence.aws_dynamodb_table.data\n\tFile: /dry-workspace-terragrunt/modules/persistence/main.tf:3-47\n\tCalling File: /dry-workspace-terragrunt/modules/plumbing/main.tf:14-21\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.persistence.aws_dynamodb_table.data\n\tFile: /envvar-terragrunt/modules/persistence/main.tf:3-47\n\tCalling File: /envvar-terragrunt/modules/plumbing/main.tf:6-12\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.persistence.aws_dynamodb_table.data\n\tFile: /envvar-terragrunt/modules/persistence/main.tf:3-47\n\tCalling File: /envvar-terragrunt/modules/plumbing/main.tf:6-12\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.persistence.aws_dynamodb_table.data\n\tFile: /module-terraform/modules/persistence/main.tf:3-47\n\tCalling File: /module-terraform/awsaccnt1/us-west-2/lookup/main.tf:34-40\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.persistence.aws_dynamodb_table.data\n\tFile: /module-terraform/modules/persistence/main.tf:3-47\n\tCalling File: /module-terraform/awsaccnt1/us-west-2/lookup/main.tf:34-40\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.data\n\tFile: /module-terragrunt/modules/persistence/main.tf:3-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.data\n\tFile: /module-terragrunt/modules/persistence/main.tf:3-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.data\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /basic-terraform/awsaccnt1/us-west-2/lookup/dynamodb.tf:3-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t3  | resource \"aws_dynamodb_table\" \"data\" {\n\t\t4  |   name           = \"${local.application-name}-data\"\n\t\t5  |   read_capacity  = 1\n\t\t6  |   write_capacity = 1\n\t\t7  |   hash_key       = \"customerId\"\n\t\t8  |   range_key      = \"\"\n\t\t9  | \n\t\t10 |   attribute = [{\n\t\t11 |     name = \"customerId\"\n\t\t12 |     type = \"S\"\n\t\t13 |   }]\n\t\t14 | \n\t\t15 |   ttl {\n\t\t16 |     attribute_name = \"TimeToExist\"\n\t\t17 |     enabled = false\n\t\t18 |   }\n\t\t19 | \n\t\t20 |   ## stop redeploying TTL\n\t\t21 |   lifecycle {\n\t\t22 |     ignore_changes = [\"ttl\"]\n\t\t23 |   }\n\t\t24 | \n\t\t25 |   server_side_encryption {\n\t\t26 |     enabled = \"true\"\n\t\t27 |   }\n\t\t28 | \n\t\t29 |   point_in_time_recovery {\n\t\t30 |     enabled = \"false\"\n\t\t31 |   }\n\t\t32 | \n\t\t33 |   stream_enabled = \"false\"\n\t\t34 |   stream_view_type = \"\"\n\t\t35 | \n\t\t36 |   timeouts {\n\t\t37 |     create = \"10m\"\n\t\t38 |     delete = \"10m\"\n\t\t39 |     update = \"10m\"\n\t\t40 |   }\n\t\t41 | \n\t\t42 |   tags {\n\t\t43 |     Name        = \"${local.application-name}\"\n\t\t44 |     Application = \"example\"\n\t\t45 |     Environment = \"${local.env}\"\n\t\t46 |   }\n\t\t47 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.data\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /basic-terraform/nonprod/us-west-2/lookup/dynamodb.tf:3-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t3  | resource \"aws_dynamodb_table\" \"data\" {\n\t\t4  |   name           = \"${local.application-name}-data\"\n\t\t5  |   read_capacity  = 1\n\t\t6  |   write_capacity = 1\n\t\t7  |   hash_key       = \"customerId\"\n\t\t8  |   range_key      = \"\"\n\t\t9  | \n\t\t10 |   attribute = [{\n\t\t11 |     name = \"customerId\"\n\t\t12 |     type = \"S\"\n\t\t13 |   }]\n\t\t14 | \n\t\t15 |   ttl {\n\t\t16 |     attribute_name = \"TimeToExist\"\n\t\t17 |     enabled = false\n\t\t18 |   }\n\t\t19 | \n\t\t20 |   ## stop redeploying TTL\n\t\t21 |   lifecycle {\n\t\t22 |     ignore_changes = [\"ttl\"]\n\t\t23 |   }\n\t\t24 | \n\t\t25 |   server_side_encryption {\n\t\t26 |     enabled = \"true\"\n\t\t27 |   }\n\t\t28 | \n\t\t29 |   point_in_time_recovery {\n\t\t30 |     enabled = \"false\"\n\t\t31 |   }\n\t\t32 | \n\t\t33 |   stream_enabled = \"false\"\n\t\t34 |   stream_view_type = \"\"\n\t\t35 | \n\t\t36 |   timeouts {\n\t\t37 |     create = \"10m\"\n\t\t38 |     delete = \"10m\"\n\t\t39 |     update = \"10m\"\n\t\t40 |   }\n\t\t41 | \n\t\t42 |   tags {\n\t\t43 |     Name        = \"${local.application-name}\"\n\t\t44 |     Application = \"example\"\n\t\t45 |     Environment = \"${local.env}\"\n\t\t46 |   }\n\t\t47 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.persistence.aws_dynamodb_table.data\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /dry-workspace-terragrunt/modules/persistence/main.tf:3-47\n\tCalling File: /dry-workspace-terragrunt/modules/plumbing/main.tf:14-21\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t3  | resource \"aws_dynamodb_table\" \"data\" {\n\t\t4  |   name           = \"${var.resource-prefix}-data${var.resource-suffix}\"\n\t\t5  |   read_capacity  = 1\n\t\t6  |   write_capacity = 1\n\t\t7  |   hash_key       = \"customerId\"\n\t\t8  |   range_key      = \"\"\n\t\t9  | \n\t\t10 |   attribute = [{\n\t\t11 |     name = \"customerId\"\n\t\t12 |     type = \"S\"\n\t\t13 |   }]\n\t\t14 | \n\t\t15 |   ttl {\n\t\t16 |     attribute_name = \"TimeToExist\"\n\t\t17 |     enabled = false\n\t\t18 |   }\n\t\t19 | \n\t\t20 |   ## stop redeploying TTL\n\t\t21 |   lifecycle {\n\t\t22 |     ignore_changes = [\"ttl\"]\n\t\t23 |   }\n\t\t24 | \n\t\t25 |   server_side_encryption {\n\t\t26 |     enabled = \"true\"\n\t\t27 |   }\n\t\t28 | \n\t\t29 |   point_in_time_recovery {\n\t\t30 |     enabled = \"false\"\n\t\t31 |   }\n\t\t32 | \n\t\t33 |   stream_enabled = \"false\"\n\t\t34 |   stream_view_type = \"\"\n\t\t35 | \n\t\t36 |   timeouts {\n\t\t37 |     create = \"10m\"\n\t\t38 |     delete = \"10m\"\n\t\t39 |     update = \"10m\"\n\t\t40 |   }\n\t\t41 | \n\t\t42 |   tags {\n\t\t43 |     Name        = \"${var.resource-prefix}-data${var.resource-suffix}\"\n\t\t44 |     Application = \"example\"\n\t\t45 |     Environment = \"${var.env}\"\n\t\t46 |   }\n\t\t47 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.persistence.aws_dynamodb_table.data\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /envvar-terragrunt/modules/persistence/main.tf:3-47\n\tCalling File: /envvar-terragrunt/modules/plumbing/main.tf:6-12\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t3  | resource \"aws_dynamodb_table\" \"data\" {\n\t\t4  |   name           = \"${var.application-name}-data-${var.env}\"\n\t\t5  |   read_capacity  = 1\n\t\t6  |   write_capacity = 1\n\t\t7  |   hash_key       = \"customerId\"\n\t\t8  |   range_key      = \"\"\n\t\t9  | \n\t\t10 |   attribute = [{\n\t\t11 |     name = \"customerId\"\n\t\t12 |     type = \"S\"\n\t\t13 |   }]\n\t\t14 | \n\t\t15 |   ttl {\n\t\t16 |     attribute_name = \"TimeToExist\"\n\t\t17 |     enabled = false\n\t\t18 |   }\n\t\t19 | \n\t\t20 |   ## stop redeploying TTL\n\t\t21 |   lifecycle {\n\t\t22 |     ignore_changes = [\"ttl\"]\n\t\t23 |   }\n\t\t24 | \n\t\t25 |   server_side_encryption {\n\t\t26 |     enabled = \"true\"\n\t\t27 |   }\n\t\t28 | \n\t\t29 |   point_in_time_recovery {\n\t\t30 |     enabled = \"false\"\n\t\t31 |   }\n\t\t32 | \n\t\t33 |   stream_enabled = \"false\"\n\t\t34 |   stream_view_type = \"\"\n\t\t35 | \n\t\t36 |   timeouts {\n\t\t37 |     create = \"10m\"\n\t\t38 |     delete = \"10m\"\n\t\t39 |     update = \"10m\"\n\t\t40 |   }\n\t\t41 | \n\t\t42 |   tags {\n\t\t43 |     Name        = \"${var.application-name}-data-${var.env}\"\n\t\t44 |     Application = \"example\"\n\t\t45 |     Environment = \"${var.env}\"\n\t\t46 |   }\n\t\t47 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.persistence.aws_dynamodb_table.data\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /module-terraform/modules/persistence/main.tf:3-47\n\tCalling File: /module-terraform/awsaccnt1/us-west-2/lookup/main.tf:34-40\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t3  | resource \"aws_dynamodb_table\" \"data\" {\n\t\t4  |   name           = \"${var.application-name}-data\"\n\t\t5  |   read_capacity  = 1\n\t\t6  |   write_capacity = 1\n\t\t7  |   hash_key       = \"customerId\"\n\t\t8  |   range_key      = \"\"\n\t\t9  | \n\t\t10 |   attribute = [{\n\t\t11 |     name = \"customerId\"\n\t\t12 |     type = \"S\"\n\t\t13 |   }]\n\t\t14 | \n\t\t15 |   ttl {\n\t\t16 |     attribute_name = \"TimeToExist\"\n\t\t17 |     enabled = false\n\t\t18 |   }\n\t\t19 | \n\t\t20 |   ## stop redeploying TTL\n\t\t21 |   lifecycle {\n\t\t22 |     ignore_changes = [\"ttl\"]\n\t\t23 |   }\n\t\t24 | \n\t\t25 |   server_side_encryption {\n\t\t26 |     enabled = \"true\"\n\t\t27 |   }\n\t\t28 | \n\t\t29 |   point_in_time_recovery {\n\t\t30 |     enabled = \"false\"\n\t\t31 |   }\n\t\t32 | \n\t\t33 |   stream_enabled = \"false\"\n\t\t34 |   stream_view_type = \"\"\n\t\t35 | \n\t\t36 |   timeouts {\n\t\t37 |     create = \"10m\"\n\t\t38 |     delete = \"10m\"\n\t\t39 |     update = \"10m\"\n\t\t40 |   }\n\t\t41 | \n\t\t42 |   tags {\n\t\t43 |     Name        = \"${var.application-name}\"\n\t\t44 |     Application = \"example\"\n\t\t45 |     Environment = \"${var.env}\"\n\t\t46 |   }\n\t\t47 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.data\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /module-terragrunt/modules/persistence/main.tf:3-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t3  | resource \"aws_dynamodb_table\" \"data\" {\n\t\t4  |   name           = \"${var.application-name}-data\"\n\t\t5  |   read_capacity  = 1\n\t\t6  |   write_capacity = 1\n\t\t7  |   hash_key       = \"customerId\"\n\t\t8  |   range_key      = \"\"\n\t\t9  | \n\t\t10 |   attribute = [{\n\t\t11 |     name = \"customerId\"\n\t\t12 |     type = \"S\"\n\t\t13 |   }]\n\t\t14 | \n\t\t15 |   ttl {\n\t\t16 |     attribute_name = \"TimeToExist\"\n\t\t17 |     enabled = false\n\t\t18 |   }\n\t\t19 | \n\t\t20 |   ## stop redeploying TTL\n\t\t21 |   lifecycle {\n\t\t22 |     ignore_changes = [\"ttl\"]\n\t\t23 |   }\n\t\t24 | \n\t\t25 |   server_side_encryption {\n\t\t26 |     enabled = \"true\"\n\t\t27 |   }\n\t\t28 | \n\t\t29 |   point_in_time_recovery {\n\t\t30 |     enabled = \"false\"\n\t\t31 |   }\n\t\t32 | \n\t\t33 |   stream_enabled = \"false\"\n\t\t34 |   stream_view_type = \"\"\n\t\t35 | \n\t\t36 |   timeouts {\n\t\t37 |     create = \"10m\"\n\t\t38 |     delete = \"10m\"\n\t\t39 |     update = \"10m\"\n\t\t40 |   }\n\t\t41 | \n\t\t42 |   tags {\n\t\t43 |     Name        = \"${var.application-name}\"\n\t\t44 |     Application = \"example\"\n\t\t45 |     Environment = \"${var.env}\"\n\t\t46 |   }\n\t\t47 | }\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/after/basic-terraform/awsaccnt1/us-west-2/lookup/api.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/after/basic-terraform/nonprod/us-west-2/lookup/api.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/after/dry-workspace-terragrunt/modules/api/lookup-method.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/after/dry-workspace-terragrunt/systems/terraform.tfvarsֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/after/envvar-terragrunt/modules/api/lookup-method.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/after/envvar-terragrunt/systems/terraform.tfvarsֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/after/module-terraform/modules/api/lookup-method.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/after/module-terragrunt/modules/api/lookup-method.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/after/module-terragrunt/systems/terraform.tfvarsֿ\n\n",
      "stderr": "",
      "duration_seconds": 7.94951680599479
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/Arkoprabho/TerraformTutorial/commit/ba317d7e402f014589e230fad8c7384016211ba2",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.terraform_locks\n\tFile: /tfstate/main.tf:36-44\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.terraform_locks\n\tFile: /tfstate/main.tf:36-44\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.terraform_locks\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /tfstate/main.tf:36-44\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t36 | resource \"aws_dynamodb_table\" \"terraform_locks\" {\n\t\t37 |   name         = \"terraform-state-locks\"\n\t\t38 |   hash_key     = \"LockID\"\n\t\t39 | \n\t\t40 |   attribute {\n\t\t41 |     name = \"LockID\"\n\t\t42 |     type = \"S\"\n\t\t43 |   }\n\t\t44 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 6.582119571001385
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.terraform_locks\n\tFile: /tfstate/main.tf:36-45\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.terraform_locks\n\tFile: /tfstate/main.tf:36-45\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.terraform_locks\n\tFile: /tfstate/main.tf:36-45\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "",
      "duration_seconds": 5.726407762005692
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/jkstenzel95/jks.gameservers/commit/411ab992ba07e698cb08b56eb4cfc9d6e001d43f",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 11, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.game_servers.module.ark_resources.module.kv_store.aws_dynamodb_table.game_key_value_store\n\tFile: /infra/service/game-servers/modules/game-kv-store/main.tf:1-17\n\tCalling File: /infra/service/game-servers/modules/Ark/ark-resources/main.tf:34-41\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.game_servers.module.ark_resources.module.kv_store.aws_dynamodb_table.game_key_value_store\n\tFile: /infra/service/game-servers/modules/game-kv-store/main.tf:1-17\n\tCalling File: /infra/service/game-servers/modules/Ark/ark-resources/main.tf:34-41\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.dev_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:6-9\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.dev_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:6-9\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.dev_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:6-9\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.prod_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:11-14\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.prod_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:11-14\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.prod_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:11-14\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.shared_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:16-19\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.shared_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:16-19\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.shared_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:16-19\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.game_servers.module.ark_resources.module.kv_store.aws_dynamodb_table.game_key_value_store\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /infra/service/game-servers/modules/game-kv-store/main.tf:1-17\n\tCalling File: /infra/service/game-servers/modules/Ark/ark-resources/main.tf:34-41\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"game_key_value_store\" {\n\t\t2  |   name             = \"jks-gs-${var.env}-${var.region_shortname}-${var.game_name}-${var.map_name}-kv_table\"\n\t\t3  |   hash_key         = \"Key\"\n\t\t4  | \n\t\t5  |   attribute {\n\t\t6  |     name = \"Key\"\n\t\t7  |     type = \"S\"\n\t\t8  |   }\n\t\t9  | \n\t\t10 |   replica {\n\t\t11 |     region_name = \"us-east-2\"\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   replica {\n\t\t15 |     region_name = \"us-west-2\"\n\t\t16 |   }\n\t\t17 | }\n\n",
        "stderr": "2024-06-21 12:07:47,992 [MainThread  ] [WARNI]  Failed processing helm chart game-server at dir: snapshots/jkstenzel95-jks.gameservers-411ab992ba07e698cb08b56eb4cfc9d6e001d43f/before-79323c3894373739c61477b17736bc260834fa6f/game-server/helm/game-server. Working dir: /tmp/tmp70tnzc67. Failure details: Error: template: game-server/templates/deployment.yaml:55:21: executing \"game-server/templates/deployment.yaml\" at <.Values.environmentVariableFile>: wrong type for value; expected string; got interface {}\n\nUse --debug flag to render out invalid YAML\n\n",
        "duration_seconds": 9.866481472010491
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 12, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.game_servers.module.ark_resources.module.kv_store.aws_dynamodb_table.game_key_value_store\n\tFile: /infra/service/game-servers/modules/game-kv-store/main.tf:1-18\n\tCalling File: /infra/service/game-servers/modules/Ark/ark-resources/main.tf:34-41\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.game_servers.module.ark_resources.module.kv_store.aws_dynamodb_table.game_key_value_store\n\tFile: /infra/service/game-servers/modules/game-kv-store/main.tf:1-18\n\tCalling File: /infra/service/game-servers/modules/Ark/ark-resources/main.tf:34-41\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.game_servers.module.ark_resources.module.kv_store.aws_dynamodb_table.game_key_value_store\n\tFile: /infra/service/game-servers/modules/game-kv-store/main.tf:1-18\n\tCalling File: /infra/service/game-servers/modules/Ark/ark-resources/main.tf:34-41\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.dev_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:6-9\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.dev_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:6-9\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.dev_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:6-9\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.prod_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:11-14\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.prod_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:11-14\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.prod_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:11-14\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.shared_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:16-19\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.shared_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:16-19\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.shared_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:16-19\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "2024-06-21 12:07:37,847 [MainThread  ] [WARNI]  Failed processing helm chart game-server at dir: snapshots/jkstenzel95-jks.gameservers-411ab992ba07e698cb08b56eb4cfc9d6e001d43f/after/game-server/helm/game-server. Working dir: /tmp/tmp8a0_2dfg. Failure details: Error: template: game-server/templates/deployment.yaml:55:21: executing \"game-server/templates/deployment.yaml\" at <.Values.environmentVariableFile>: wrong type for value; expected string; got interface {}\n\nUse --debug flag to render out invalid YAML\n\n",
      "duration_seconds": 9.969535909011029
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/techservicesillinois/aws-enterprise-vpc/commit/0d21bea79e1936e2bdaee58bd6e328dd08e59b30",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.lock_table\n\tFile: /modules/bootstrap/main.tf:89-108\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.lock_table\n\tFile: /modules/bootstrap/main.tf:89-108\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.lock_table\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /modules/bootstrap/main.tf:89-108\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t89  | resource \"aws_dynamodb_table\" \"lock_table\" {\n\t\t90  |   name = var.dynamodb_table\n\t\t91  |   tags = var.tags\n\t\t92  | \n\t\t93  |   billing_mode   = \"PROVISIONED\"\n\t\t94  |   read_capacity  = 1\n\t\t95  |   write_capacity = 1\n\t\t96  | \n\t\t97  |   hash_key = \"LockID\"\n\t\t98  | \n\t\t99  |   attribute {\n\t\t100 |     name = \"LockID\"\n\t\t101 |     type = \"S\"\n\t\t102 |   }\n\t\t103 | \n\t\t104 |   # Terraform should never destroy this resource\n\t\t105 |   lifecycle {\n\t\t106 |     prevent_destroy = true\n\t\t107 |   }\n\t\t108 | }\n\nterraform_plan scan results:\n\nPassed checks: 0, Failed checks: 0, Skipped checks: 0, Parsing errors: 1\n\nError parsing file snapshots/techservicesillinois-aws-enterprise-vpc-0d21bea79e1936e2bdaee58bd6e328dd08e59b30/before-11ad9a5261fb1c5d15e8f8be9ba3a59b8fc78fb2/modules/rdns-forwarder/roles/rdns-forwarder/templates/opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.jsonֿ\n\n",
        "stderr": "2024-06-21 12:08:05,986 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/customer-gateways?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:08:05,986 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/subnet-common?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:08:05,986 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/nat-gateway?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:08:05,987 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/vpn-connection?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:08:05,987 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/public-facing-subnet?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:08:05,987 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/campus-facing-subnet?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:08:05,987 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/private-facing-subnet?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:08:05,988 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/rdns-forwarder?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 8.609310435000225
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.lock_table\n\tFile: /modules/bootstrap/main.tf:89-106\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.lock_table\n\tFile: /modules/bootstrap/main.tf:89-106\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.lock_table\n\tFile: /modules/bootstrap/main.tf:89-106\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nterraform_plan scan results:\n\nPassed checks: 0, Failed checks: 0, Skipped checks: 0, Parsing errors: 1\n\nError parsing file snapshots/techservicesillinois-aws-enterprise-vpc-0d21bea79e1936e2bdaee58bd6e328dd08e59b30/after/modules/rdns-forwarder/roles/rdns-forwarder/templates/opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.jsonֿ\n\n",
      "stderr": "2024-06-21 12:07:57,407 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/customer-gateways?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:07:57,407 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/subnet-common?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:07:57,408 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/nat-gateway?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:07:57,408 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/vpn-connection?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:07:57,408 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/public-facing-subnet?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:07:57,409 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/campus-facing-subnet?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:07:57,409 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/private-facing-subnet?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:07:57,409 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/rdns-forwarder?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 7.844044876008411
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/austin1237/gifbot/commit/c11dabf1ea02c0e044c62448986bb3f9abdf3967",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 4, Skipped checks: 0\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.terraform_state_lock\n\tFile: /terraform/dev/remote-state/main.tf:17-27\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.terraform_state_lock\n\tFile: /terraform/prod/remote-state/main.tf:17-27\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.terraform_state_lock\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/dev/remote-state/main.tf:17-27\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t17 | resource \"aws_dynamodb_table\" \"terraform_state_lock\" {\n\t\t18 |   name           = \"gifbot-state-lock-${var.ENVIRONMENT}\"\n\t\t19 |   read_capacity  = 20\n\t\t20 |   write_capacity = 20\n\t\t21 |   hash_key       = \"LockID\"\n\t\t22 | \n\t\t23 |   attribute {\n\t\t24 |     name = \"LockID\"\n\t\t25 |     type = \"S\"\n\t\t26 |   }\n\t\t27 | }\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.terraform_state_lock\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/dev/remote-state/main.tf:17-27\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t17 | resource \"aws_dynamodb_table\" \"terraform_state_lock\" {\n\t\t18 |   name           = \"gifbot-state-lock-${var.ENVIRONMENT}\"\n\t\t19 |   read_capacity  = 20\n\t\t20 |   write_capacity = 20\n\t\t21 |   hash_key       = \"LockID\"\n\t\t22 | \n\t\t23 |   attribute {\n\t\t24 |     name = \"LockID\"\n\t\t25 |     type = \"S\"\n\t\t26 |   }\n\t\t27 | }\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.terraform_state_lock\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/prod/remote-state/main.tf:17-27\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t17 | resource \"aws_dynamodb_table\" \"terraform_state_lock\" {\n\t\t18 |   name           = \"gifbot-state-lock-${var.ENVIRONMENT}\"\n\t\t19 |   read_capacity  = 20\n\t\t20 |   write_capacity = 20\n\t\t21 |   hash_key       = \"LockID\"\n\t\t22 | \n\t\t23 |   attribute {\n\t\t24 |     name = \"LockID\"\n\t\t25 |     type = \"S\"\n\t\t26 |   }\n\t\t27 | }\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.terraform_state_lock\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/prod/remote-state/main.tf:17-27\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t17 | resource \"aws_dynamodb_table\" \"terraform_state_lock\" {\n\t\t18 |   name           = \"gifbot-state-lock-${var.ENVIRONMENT}\"\n\t\t19 |   read_capacity  = 20\n\t\t20 |   write_capacity = 20\n\t\t21 |   hash_key       = \"LockID\"\n\t\t22 | \n\t\t23 |   attribute {\n\t\t24 |     name = \"LockID\"\n\t\t25 |     type = \"S\"\n\t\t26 |   }\n\t\t27 | }\n\n",
        "stderr": "",
        "duration_seconds": 6.764790111003094
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 4, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.terraform_state_lock\n\tFile: /terraform/dev/remote-state/main.tf:17-27\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.terraform_state_lock\n\tFile: /terraform/dev/remote-state/main.tf:17-27\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.terraform_state_lock\n\tFile: /terraform/prod/remote-state/main.tf:17-27\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.terraform_state_lock\n\tFile: /terraform/prod/remote-state/main.tf:17-27\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.terraform_state_lock\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/dev/remote-state/main.tf:17-27\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t17 | resource \"aws_dynamodb_table\" \"terraform_state_lock\" {\n\t\t18 |   name           = \"gifbot-state-lock-${var.ENVIRONMENT}\"\n\t\t19 |   read_capacity  = 1\n\t\t20 |   write_capacity = 1\n\t\t21 |   hash_key       = \"LockID\"\n\t\t22 | \n\t\t23 |   attribute {\n\t\t24 |     name = \"LockID\"\n\t\t25 |     type = \"S\"\n\t\t26 |   }\n\t\t27 | }\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.terraform_state_lock\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/prod/remote-state/main.tf:17-27\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t17 | resource \"aws_dynamodb_table\" \"terraform_state_lock\" {\n\t\t18 |   name           = \"gifbot-state-lock-${var.ENVIRONMENT}\"\n\t\t19 |   read_capacity  = 1\n\t\t20 |   write_capacity = 1\n\t\t21 |   hash_key       = \"LockID\"\n\t\t22 | \n\t\t23 |   attribute {\n\t\t24 |     name = \"LockID\"\n\t\t25 |     type = \"S\"\n\t\t26 |   }\n\t\t27 | }\n\n",
      "stderr": "",
      "duration_seconds": 7.489196082009585
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/servers-tf/infrastructure/commit/cc9e50a3864511f9fb9f871293e6a6e7e2719d2c",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.tf2_competitive_auth\n\tFile: /main.tf:29-39\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.tf2_competitive_auth\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /main.tf:29-39\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t29 | resource \"aws_dynamodb_table\" \"tf2_competitive_auth\" {\n\t\t30 |     name = \"tf2_competitive_auth\"\n\t\t31 |     hash_key = \"steam_id\"\n\t\t32 |     read_capacity  = 5\n\t\t33 |     write_capacity = 5\n\t\t34 | \n\t\t35 |     attribute {\n\t\t36 |         name = \"steam_id\"\n\t\t37 |         type = \"S\"\n\t\t38 |     }\n\t\t39 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.tf2_competitive_auth\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /main.tf:29-39\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t29 | resource \"aws_dynamodb_table\" \"tf2_competitive_auth\" {\n\t\t30 |     name = \"tf2_competitive_auth\"\n\t\t31 |     hash_key = \"steam_id\"\n\t\t32 |     read_capacity  = 5\n\t\t33 |     write_capacity = 5\n\t\t34 | \n\t\t35 |     attribute {\n\t\t36 |         name = \"steam_id\"\n\t\t37 |         type = \"S\"\n\t\t38 |     }\n\t\t39 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 8.551358147000428
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.tf2_competitive_auth\n\tFile: /main.tf:29-39\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.tf2_competitive_auth\n\tFile: /main.tf:29-39\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.tf2_competitive_auth\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /main.tf:29-39\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t29 | resource \"aws_dynamodb_table\" \"tf2_competitive_auth\" {\n\t\t30 |     name = \"tf2_competitive_auth\"\n\t\t31 |     hash_key = \"steam_id\"\n\t\t32 |     read_capacity  = 1\n\t\t33 |     write_capacity = 1\n\t\t34 | \n\t\t35 |     attribute {\n\t\t36 |         name = \"steam_id\"\n\t\t37 |         type = \"S\"\n\t\t38 |     }\n\t\t39 | }\n\n\n",
      "stderr": "",
      "duration_seconds": 8.432541543006664
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/jsoconno/aws-terraform-remote-state-infrastructure/commit/fed8be2748bc2286a6f9888d282d66763ba612ed",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.dynamodb.aws_dynamodb_table.standard[0]\n\tFile: /modules/dynamodb/main.tf:16-91\n\tCalling File: /terraform/main.tf:9-28\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.dynamodb.aws_dynamodb_table.standard[0]\n\tFile: /modules/dynamodb/main.tf:16-91\n\tCalling File: /terraform/main.tf:9-28\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: module.dynamodb.aws_dynamodb_table.standard[0]\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /modules/dynamodb/main.tf:16-91\n\tCalling File: /terraform/main.tf:9-28\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\n\n",
        "stderr": "",
        "duration_seconds": 7.480107153009158
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.dynamodb.aws_dynamodb_table.standard\n\tFile: /modules/dynamodb/main.tf:16-87\n\tCalling File: /terraform/main.tf:9-28\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.dynamodb.aws_dynamodb_table.standard\n\tFile: /modules/dynamodb/main.tf:16-87\n\tCalling File: /terraform/main.tf:9-28\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: module.dynamodb.aws_dynamodb_table.standard\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /modules/dynamodb/main.tf:16-87\n\tCalling File: /terraform/main.tf:9-28\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\n\n",
      "stderr": "",
      "duration_seconds": 6.39210355799878
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/ONSdigital/eq-terraform/commit/6eaf697bf9f111214a6d74ee3094e5784a57d1bb",
    "before": [
      {
        "return_code": 0,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 0, Skipped checks: 0, Parsing errors: 4\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/ONSdigital-eq-terraform-6eaf697bf9f111214a6d74ee3094e5784a57d1bb/before-e2d4cd25e676ffbfdd7d578795b76ed2866a17f4/survey-runner-alerting/iam.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/ONSdigital-eq-terraform-6eaf697bf9f111214a6d74ee3094e5784a57d1bb/before-e2d4cd25e676ffbfdd7d578795b76ed2866a17f4/survey-runner-application/iam.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/ONSdigital-eq-terraform-6eaf697bf9f111214a6d74ee3094e5784a57d1bb/before-e2d4cd25e676ffbfdd7d578795b76ed2866a17f4/survey-runner-database/cloudwatch.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/ONSdigital-eq-terraform-6eaf697bf9f111214a6d74ee3094e5784a57d1bb/before-e2d4cd25e676ffbfdd7d578795b76ed2866a17f4/survey-runner-queue/cloudwatch.tfֿ\n\n",
        "stderr": "2024-06-21 12:09:07,735 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/eq-terraform-ecs?ref=v7.0:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:09:07,735 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/eq-ecs-deploy?ref=v2.0:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:09:07,735 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/eq-terraform-elasticsearch:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:09:07,736 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/eq-terraform-dynamodb?ref=v2.0:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:09:07,736 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/ebs_bckup:None (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 9.306569110005512
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 0, Skipped checks: 0, Parsing errors: 4\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/ONSdigital-eq-terraform-6eaf697bf9f111214a6d74ee3094e5784a57d1bb/after/survey-runner-alerting/iam.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/ONSdigital-eq-terraform-6eaf697bf9f111214a6d74ee3094e5784a57d1bb/after/survey-runner-application/iam.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/ONSdigital-eq-terraform-6eaf697bf9f111214a6d74ee3094e5784a57d1bb/after/survey-runner-database/cloudwatch.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/ONSdigital-eq-terraform-6eaf697bf9f111214a6d74ee3094e5784a57d1bb/after/survey-runner-queue/cloudwatch.tfֿ\n\n",
      "stderr": "2024-06-21 12:08:59,052 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/eq-terraform-ecs?ref=v7.0:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:08:59,053 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/eq-ecs-deploy?ref=v2.0:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:08:59,053 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/eq-terraform-elasticsearch:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:08:59,054 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/eq-terraform-dynamodb?ref=v2.2:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:08:59,054 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/ebs_bckup:None (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 7.9499212369992165
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/nikkiwritescode/flask-app-terraform-deployment/commit/af47bb6201f1dcc8264e60da429e4ff8d126e56c",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.db.aws_dynamodb_table.flask-db-table-1\n\tFile: /modules/db/main.tf:1-28\n\tCalling File: /main.tf:49-53\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.db.aws_dynamodb_table.flask-db-table-1\n\tFile: /modules/db/main.tf:1-28\n\tCalling File: /main.tf:49-53\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.db.aws_dynamodb_table.flask-db-table-1\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /modules/db/main.tf:1-28\n\tCalling File: /main.tf:49-53\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"flask-db-table-1\" {\n\t\t2  |   name           = \"${var.app_name}-${var.env_prefix}-FlaskDB\"\n\t\t3  |   billing_mode   = \"PROVISIONED\"\n\t\t4  |   read_capacity  = 1\n\t\t5  |   write_capacity = 1\n\t\t6  |   hash_key       = \"Name\"\n\t\t7  |   range_key      = \"Party\"\n\t\t8  | \n\t\t9  |   attribute {\n\t\t10 |     name = \"Name\"\n\t\t11 |     type = \"S\"\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   attribute {\n\t\t15 |     name = \"Party\"\n\t\t16 |     type = \"S\"\n\t\t17 |   }\n\t\t18 | \n\t\t19 |   ttl {\n\t\t20 |     attribute_name = \"TimeToExist\"\n\t\t21 |     enabled        = false\n\t\t22 |   }\n\t\t23 | \n\t\t24 |   tags = {\n\t\t25 |     Name        = \"${var.app_name}-${var.env_prefix}-flask-db-table-1\"\n\t\t26 |     Environment = \"${var.env_prefix}\"\n\t\t27 |   }\n\t\t28 | }\n\n",
        "stderr": "",
        "duration_seconds": 7.157180109003093
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.db.aws_dynamodb_table.candidate-table\n\tFile: /modules/db/main.tf:1-20\n\tCalling File: /main.tf:50-54\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.db.aws_dynamodb_table.candidate-table\n\tFile: /modules/db/main.tf:1-20\n\tCalling File: /main.tf:50-54\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.db.aws_dynamodb_table.candidate-table\n\tFile: /modules/db/main.tf:1-20\n\tCalling File: /main.tf:50-54\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "",
      "duration_seconds": 7.410597011010395
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/kperson/terraform-modules/commit/53bd2d84776f9ed7ae287fc59ed42f87bd7bbc4b",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.table\n\tFile: /auto-scaled-dynamo/main.tf:46-102\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: aws_dynamodb_table.table\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /auto-scaled-dynamo/main.tf:46-102\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.table\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /auto-scaled-dynamo/main.tf:46-102\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\n\n",
        "stderr": "",
        "duration_seconds": 7.669993871997576
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.table\n\tFile: /auto-scaled-dynamo/main.tf:50-107\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: aws_dynamodb_table.table\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /auto-scaled-dynamo/main.tf:50-107\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.table\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /auto-scaled-dynamo/main.tf:50-107\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\n\n",
      "stderr": "",
      "duration_seconds": 7.318416647991398
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/kody-abe/terraform/commit/169c7768b0b1584945362c035a2b227d2f579466",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 5, Failed checks: 4, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.geopoiesis-scopes\n\tFile: /aws/dynamodb.tf:1-20\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.geopoiesis-scopes\n\tFile: /aws/dynamodb.tf:1-20\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.geopoiesis-runs\n\tFile: /aws/dynamodb.tf:29-114\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.geopoiesis-workers\n\tFile: /aws/dynamodb.tf:155-174\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.geopoiesis-workers\n\tFile: /aws/dynamodb.tf:155-174\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.geopoiesis-scopes\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /aws/dynamodb.tf:1-20\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"geopoiesis-scopes\" {\n\t\t2  |   name           = \"${var.scopes_table_name}\"\n\t\t3  |   read_capacity  = \"${var.min_capacity}\"\n\t\t4  |   write_capacity = \"${var.min_capacity}\"\n\t\t5  |   hash_key       = \"scope\"\n\t\t6  | \n\t\t7  |   attribute {\n\t\t8  |     name = \"scope\"\n\t\t9  |     type = \"S\"\n\t\t10 |   }\n\t\t11 | \n\t\t12 |   lifecycle {\n\t\t13 |     ignore_changes = [\"read_capacity\", \"write_capacity\"]\n\t\t14 |   }\n\t\t15 | \n\t\t16 |   tags {\n\t\t17 |     Name        = \"Owner\"\n\t\t18 |     Description = \"Geopoiesis\"\n\t\t19 |   }\n\t\t20 | }\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: aws_dynamodb_table.geopoiesis-runs\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /aws/dynamodb.tf:29-114\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.geopoiesis-runs\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /aws/dynamodb.tf:29-114\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.geopoiesis-workers\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /aws/dynamodb.tf:155-174\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t155 | resource \"aws_dynamodb_table\" \"geopoiesis-workers\" {\n\t\t156 |   name           = \"${var.workers_table_name}\"\n\t\t157 |   read_capacity  = \"${var.min_capacity}\"\n\t\t158 |   write_capacity = \"${var.min_capacity}\"\n\t\t159 |   hash_key       = \"worker_id\"\n\t\t160 | \n\t\t161 |   attribute {\n\t\t162 |     name = \"worker_id\"\n\t\t163 |     type = \"S\"\n\t\t164 |   }\n\t\t165 | \n\t\t166 |   lifecycle {\n\t\t167 |     ignore_changes = [\"read_capacity\", \"write_capacity\"]\n\t\t168 |   }\n\t\t169 | \n\t\t170 |   tags {\n\t\t171 |     Name        = \"Owner\"\n\t\t172 |     Description = \"Geopoiesis\"\n\t\t173 |   }\n\t\t174 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 6.653156251006294
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 7, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.geopoiesis-scopes\n\tFile: /aws/dynamodb.tf:1-14\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.geopoiesis-scopes\n\tFile: /aws/dynamodb.tf:1-14\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.geopoiesis-runs\n\tFile: /aws/dynamodb.tf:16-84\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.geopoiesis-runs\n\tFile: /aws/dynamodb.tf:16-84\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.geopoiesis-workers\n\tFile: /aws/dynamodb.tf:86-100\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.geopoiesis-workers\n\tFile: /aws/dynamodb.tf:86-100\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.geopoiesis-workers\n\tFile: /aws/dynamodb.tf:86-100\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.geopoiesis-scopes\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /aws/dynamodb.tf:1-14\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"geopoiesis-scopes\" {\n\t\t2  |   name     = \"${var.scopes_table_name}\"\n\t\t3  |   hash_key = \"scope\"\n\t\t4  | \n\t\t5  |   attribute {\n\t\t6  |     name = \"scope\"\n\t\t7  |     type = \"S\"\n\t\t8  |   }\n\t\t9  | \n\t\t10 |   tags {\n\t\t11 |     Name        = \"Owner\"\n\t\t12 |     Description = \"Geopoiesis\"\n\t\t13 |   }\n\t\t14 | }\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: aws_dynamodb_table.geopoiesis-runs\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /aws/dynamodb.tf:16-84\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\n\n",
      "stderr": "",
      "duration_seconds": 7.1434538409957895
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/jenkins-x/terraform-aws-eks-jx/commit/cce6b14692fccd30c027851607a9526151d4c3d2",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.vault.aws_dynamodb_table.vault-dynamodb-table[0]\n\tFile: /modules/vault/main.tf:48-71\n\tCalling File: /main.tf:56-62\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: module.vault.aws_dynamodb_table.vault-dynamodb-table[0]\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /modules/vault/main.tf:48-71\n\tCalling File: /main.tf:56-62\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t48 | resource \"aws_dynamodb_table\" \"vault-dynamodb-table\" {\n\t\t49 |   count = var.external_vault ? 0 : 1 \n\t\t50 | \n\t\t51 |   name           = \"vault-unseal-${var.cluster_name}-${local.vault_seed}\"\n\t\t52 |   billing_mode   = \"PROVISIONED\"\n\t\t53 |   read_capacity  = 2\n\t\t54 |   write_capacity = 2\n\t\t55 |   hash_key       = \"Path\"\n\t\t56 |   range_key      = \"Key\"\n\t\t57 | \n\t\t58 |   attribute {\n\t\t59 |     name = \"Path\"\n\t\t60 |     type = \"S\"\n\t\t61 |   }\n\t\t62 | \n\t\t63 |   attribute {\n\t\t64 |     name = \"Key\"\n\t\t65 |     type = \"S\"\n\t\t66 |   }\n\t\t67 | \n\t\t68 |   tags = {\n\t\t69 |     Name = \"vault-dynamo-db-table\"\n\t\t70 |   }\n\t\t71 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.vault.aws_dynamodb_table.vault-dynamodb-table[0]\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /modules/vault/main.tf:48-71\n\tCalling File: /main.tf:56-62\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t48 | resource \"aws_dynamodb_table\" \"vault-dynamodb-table\" {\n\t\t49 |   count = var.external_vault ? 0 : 1 \n\t\t50 | \n\t\t51 |   name           = \"vault-unseal-${var.cluster_name}-${local.vault_seed}\"\n\t\t52 |   billing_mode   = \"PROVISIONED\"\n\t\t53 |   read_capacity  = 2\n\t\t54 |   write_capacity = 2\n\t\t55 |   hash_key       = \"Path\"\n\t\t56 |   range_key      = \"Key\"\n\t\t57 | \n\t\t58 |   attribute {\n\t\t59 |     name = \"Path\"\n\t\t60 |     type = \"S\"\n\t\t61 |   }\n\t\t62 | \n\t\t63 |   attribute {\n\t\t64 |     name = \"Key\"\n\t\t65 |     type = \"S\"\n\t\t66 |   }\n\t\t67 | \n\t\t68 |   tags = {\n\t\t69 |     Name = \"vault-dynamo-db-table\"\n\t\t70 |   }\n\t\t71 | }\n\n\n",
        "stderr": "2024-06-21 12:10:07,936 [MainThread  ] [WARNI]  Failed to download module jenkins-x/eks-jx/aws:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:10:07,936 [MainThread  ] [WARNI]  Failed to download module terraform-aws-modules/iam/aws//modules/iam-assumable-role-with-oidc:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:10:07,936 [MainThread  ] [WARNI]  Failed to download module terraform-aws-modules/vpc/aws:2.39.0 (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:10:07,937 [MainThread  ] [WARNI]  Failed to download module terraform-aws-modules/eks/aws:12.1.0 (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 7.284258826999576
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.vault.aws_dynamodb_table.vault-dynamodb-table[0]\n\tFile: /modules/vault/main.tf:48-71\n\tCalling File: /main.tf:56-62\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.vault.aws_dynamodb_table.vault-dynamodb-table[0]\n\tFile: /modules/vault/main.tf:48-71\n\tCalling File: /main.tf:56-62\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.vault.aws_dynamodb_table.vault-dynamodb-table[0]\n\tFile: /modules/vault/main.tf:48-71\n\tCalling File: /main.tf:56-62\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "2024-06-21 12:10:00,522 [MainThread  ] [WARNI]  Failed to download module jenkins-x/eks-jx/aws:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:10:00,522 [MainThread  ] [WARNI]  Failed to download module terraform-aws-modules/iam/aws//modules/iam-assumable-role-with-oidc:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:10:00,522 [MainThread  ] [WARNI]  Failed to download module terraform-aws-modules/vpc/aws:2.39.0 (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:10:00,523 [MainThread  ] [WARNI]  Failed to download module terraform-aws-modules/eks/aws:12.1.0 (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 8.18885598599445
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/telia-oss/terraform-aws-terraform-init/commit/e8c7b2eb22d08ddd1a1bb375cb6efa4165c9098f",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.terraform_init.aws_dynamodb_table.lock\n\tFile: /main.tf:20-37\n\tCalling File: /examples/basic/main.tf:12-20\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: module.terraform_init.aws_dynamodb_table.lock\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /main.tf:20-37\n\tCalling File: /examples/basic/main.tf:12-20\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t20 | resource \"aws_dynamodb_table\" \"lock\" {\n\t\t21 |   name           = \"${var.name_prefix}-terraform-state\"\n\t\t22 |   read_capacity  = 20\n\t\t23 |   write_capacity = 20\n\t\t24 |   hash_key       = \"LockID\"\n\t\t25 | \n\t\t26 |   attribute {\n\t\t27 |     name = \"LockID\"\n\t\t28 |     type = \"S\"\n\t\t29 |   }\n\t\t30 | \n\t\t31 |   tags = merge(\n\t\t32 |     var.tags,\n\t\t33 |     {\n\t\t34 |       \"Name\" = \"${var.name_prefix}-terraform-state\"\n\t\t35 |     },\n\t\t36 |   )\n\t\t37 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.terraform_init.aws_dynamodb_table.lock\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /main.tf:20-37\n\tCalling File: /examples/basic/main.tf:12-20\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t20 | resource \"aws_dynamodb_table\" \"lock\" {\n\t\t21 |   name           = \"${var.name_prefix}-terraform-state\"\n\t\t22 |   read_capacity  = 20\n\t\t23 |   write_capacity = 20\n\t\t24 |   hash_key       = \"LockID\"\n\t\t25 | \n\t\t26 |   attribute {\n\t\t27 |     name = \"LockID\"\n\t\t28 |     type = \"S\"\n\t\t29 |   }\n\t\t30 | \n\t\t31 |   tags = merge(\n\t\t32 |     var.tags,\n\t\t33 |     {\n\t\t34 |       \"Name\" = \"${var.name_prefix}-terraform-state\"\n\t\t35 |     },\n\t\t36 |   )\n\t\t37 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 6.958011847993475
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.terraform_init.aws_dynamodb_table.lock\n\tFile: /main.tf:20-38\n\tCalling File: /examples/basic/main.tf:12-20\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.terraform_init.aws_dynamodb_table.lock\n\tFile: /main.tf:20-38\n\tCalling File: /examples/basic/main.tf:12-20\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.terraform_init.aws_dynamodb_table.lock\n\tFile: /main.tf:20-38\n\tCalling File: /examples/basic/main.tf:12-20\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "",
      "duration_seconds": 6.958857873003581
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/trajano/terraform-s3-backend/commit/f4b61c7bedae856439f01499de1ec9050b4c40fc",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.terraform-s3-backend.aws_dynamodb_table.terraform\n\tFile: /main.tf:68-83\n\tCalling File: /examples/sample/terraform-s3-backend.tf:1-5\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: module.terraform-s3-backend.aws_dynamodb_table.terraform\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /main.tf:68-83\n\tCalling File: /examples/sample/terraform-s3-backend.tf:1-5\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t68 | resource \"aws_dynamodb_table\" \"terraform\" {\n\t\t69 |   name      = \"${var.bucket}-locks\"\n\t\t70 |   hash_key  = \"LockID\"\n\t\t71 | \n\t\t72 |   # Not sure if this is okay or not, it may be better to use PAY_PER_REQUEST since Terraforms do not happen often.\n\t\t73 |   read_capacity  = 20\n\t\t74 |   write_capacity = 20\n\t\t75 |   attribute {\n\t\t76 |     name = \"LockID\"\n\t\t77 |     type = \"S\"\n\t\t78 |   }\n\t\t79 | \n\t\t80 |   tags = {\n\t\t81 |     Name = \"${var.bucket} Terraform S3 Backend Locks\"\n\t\t82 |   }\n\t\t83 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.terraform-s3-backend.aws_dynamodb_table.terraform\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /main.tf:68-83\n\tCalling File: /examples/sample/terraform-s3-backend.tf:1-5\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t68 | resource \"aws_dynamodb_table\" \"terraform\" {\n\t\t69 |   name      = \"${var.bucket}-locks\"\n\t\t70 |   hash_key  = \"LockID\"\n\t\t71 | \n\t\t72 |   # Not sure if this is okay or not, it may be better to use PAY_PER_REQUEST since Terraforms do not happen often.\n\t\t73 |   read_capacity  = 20\n\t\t74 |   write_capacity = 20\n\t\t75 |   attribute {\n\t\t76 |     name = \"LockID\"\n\t\t77 |     type = \"S\"\n\t\t78 |   }\n\t\t79 | \n\t\t80 |   tags = {\n\t\t81 |     Name = \"${var.bucket} Terraform S3 Backend Locks\"\n\t\t82 |   }\n\t\t83 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 5.836486949992832
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.terraform-s3-backend.aws_dynamodb_table.terraform\n\tFile: /main.tf:68-81\n\tCalling File: /examples/sample/terraform-s3-backend.tf:1-5\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.terraform-s3-backend.aws_dynamodb_table.terraform\n\tFile: /main.tf:68-81\n\tCalling File: /examples/sample/terraform-s3-backend.tf:1-5\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.terraform-s3-backend.aws_dynamodb_table.terraform\n\tFile: /main.tf:68-81\n\tCalling File: /examples/sample/terraform-s3-backend.tf:1-5\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "",
      "duration_seconds": 6.966377220989671
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/poldi2015/chat-app/commit/cb45bf17da799afaa789206e3fcd39d9403e0567",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.chat-app-messages\n\tFile: /chat-app/terraform/dynamodb.tf:1-12\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.chat-app-messages\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /chat-app/terraform/dynamodb.tf:1-12\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"chat-app-messages\" {\n\t\t2  |   name           = \"ChatAppMessages\"\n\t\t3  |   read_capacity  = 5\n\t\t4  |   write_capacity = 5\n\t\t5  | \n\t\t6  |   hash_key       = \"connectionId\"\n\t\t7  | \n\t\t8  |   attribute {\n\t\t9  |     name = \"connectionId\"\n\t\t10 |     type = \"S\"\n\t\t11 |   }\n\t\t12 | }\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.chat-app-messages\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /chat-app/terraform/dynamodb.tf:1-12\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"chat-app-messages\" {\n\t\t2  |   name           = \"ChatAppMessages\"\n\t\t3  |   read_capacity  = 5\n\t\t4  |   write_capacity = 5\n\t\t5  | \n\t\t6  |   hash_key       = \"connectionId\"\n\t\t7  | \n\t\t8  |   attribute {\n\t\t9  |     name = \"connectionId\"\n\t\t10 |     type = \"S\"\n\t\t11 |   }\n\t\t12 | }\n\n",
        "stderr": "",
        "duration_seconds": 7.384374961999129
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.chat-app-messages\n\tFile: /chat-app/terraform/dynamodb.tf:1-13\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.chat-app-messages\n\tFile: /chat-app/terraform/dynamodb.tf:1-13\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.chat-app-messages\n\tFile: /chat-app/terraform/dynamodb.tf:1-13\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "",
      "duration_seconds": 6.896891165990382
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/tesera/terraform-modules/commit/3cd4d7b55ac2003153fd0670151ab395ae182431",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 4, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.main\n\tFile: /dynamodb/main.tf:1-32\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.main\n\tFile: /dynamodb/main.tf:1-32\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.main\n\tFile: /state/dynamodb.tf:1-21\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.main\n\tFile: /state/dynamodb.tf:1-21\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.main\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /dynamodb/main.tf:1-32\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"main\" {\n\t\t2  |   name           = local.name\n\t\t3  |   read_capacity  = var.min_read_capacity\n\t\t4  |   write_capacity = var.min_write_capacity\n\t\t5  |   hash_key       = var.hash_key\n\t\t6  | \n\t\t7  |   #range_key      = \"${var.range_key}\"\n\t\t8  | \n\t\t9  |   attribute {\n\t\t10 |     name = var.hash_key\n\t\t11 |     type = \"S\"\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   #attribute {\n\t\t15 |   #  name = \"${var.range_key}\"\n\t\t16 |   #  type = \"S\"\n\t\t17 |   #}\n\t\t18 | \n\t\t19 |   ttl {\n\t\t20 |     enabled        = var.ttl_enabled\n\t\t21 |     attribute_name = \"timeToLive\"\n\t\t22 |   }\n\t\t23 |   server_side_encryption {\n\t\t24 |     enabled = var.encryption_enabled\n\t\t25 |   }\n\t\t26 |   tags = merge(\n\t\t27 |     local.tags,\n\t\t28 |     {\n\t\t29 |       \"Name\" = local.name\n\t\t30 |     },\n\t\t31 |   )\n\t\t32 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.main\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /state/dynamodb.tf:1-21\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"main\" {\n\t\t2  |   name           = \"terraform-state${local.name}\"\n\t\t3  |   read_capacity  = 1\n\t\t4  |   write_capacity = 1\n\t\t5  |   hash_key       = \"LockID\"\n\t\t6  | \n\t\t7  |   attribute {\n\t\t8  |     name = \"LockID\"\n\t\t9  |     type = \"S\"\n\t\t10 |   }\n\t\t11 | \n\t\t12 |   server_side_encryption {\n\t\t13 |     enabled = true\n\t\t14 |   }\n\t\t15 | \n\t\t16 |   tags = {\n\t\t17 |     Name      = \"Terraform Remote State\"\n\t\t18 |     Terraform = true\n\t\t19 |     Security  = \"SSE:AWS\"\n\t\t20 |   }\n\t\t21 | }\n\n\n",
        "stderr": "2024-06-21 12:11:15,295 [MainThread  ] [WARNI]  Failed to download module terraform-aws-modules/eks/aws:None (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 17.73975467699347
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 5, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.main\n\tFile: /dynamodb/main.tf:1-32\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.main\n\tFile: /dynamodb/main.tf:1-32\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.main\n\tFile: /state/dynamodb.tf:1-26\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.main\n\tFile: /state/dynamodb.tf:1-26\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.main\n\tFile: /state/dynamodb.tf:1-26\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.main\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /dynamodb/main.tf:1-32\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"main\" {\n\t\t2  |   name           = local.name\n\t\t3  |   read_capacity  = var.min_read_capacity\n\t\t4  |   write_capacity = var.min_write_capacity\n\t\t5  |   hash_key       = var.hash_key\n\t\t6  | \n\t\t7  |   #range_key      = \"${var.range_key}\"\n\t\t8  | \n\t\t9  |   attribute {\n\t\t10 |     name = var.hash_key\n\t\t11 |     type = \"S\"\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   #attribute {\n\t\t15 |   #  name = \"${var.range_key}\"\n\t\t16 |   #  type = \"S\"\n\t\t17 |   #}\n\t\t18 | \n\t\t19 |   ttl {\n\t\t20 |     enabled        = var.ttl_enabled\n\t\t21 |     attribute_name = \"timeToLive\"\n\t\t22 |   }\n\t\t23 |   server_side_encryption {\n\t\t24 |     enabled = var.encryption_enabled\n\t\t25 |   }\n\t\t26 |   tags = merge(\n\t\t27 |     local.tags,\n\t\t28 |     {\n\t\t29 |       \"Name\" = local.name\n\t\t30 |     },\n\t\t31 |   )\n\t\t32 | }\n\n\n",
      "stderr": "2024-06-21 12:10:56,243 [MainThread  ] [WARNI]  Failed to download module terraform-aws-modules/eks/aws:None (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 18.436821196999517
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/MichaelDeCorte/TerraForm/commit/3799ee8b9677d02254eb6d6f50f3732df4c8374e",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 3, Skipped checks: 0, Parsing errors: 4\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.dynamo_table\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /dynamo/dynamo.tf:140-174\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t140 | resource \"aws_dynamodb_table\" \"dynamo_table\" {\n\t\t141 |     name            \t= \"${var.name}\"\n\t\t142 |     read_capacity   \t= \"${var.read_capacity}\"\n\t\t143 |     write_capacity  \t= \"${var.write_capacity}\"\n\t\t144 |     hash_key        \t= \"${var.hash_key}\"\n\t\t145 |     range_key        \t= \"${var.range_key}\"\n\t\t146 | \n\t\t147 |     \n\t\t148 |     attribute = [\n\t\t149 |         \"${local.attributes}\"\n\t\t150 |     ]\n\t\t151 | \n\t\t152 | \n\t\t153 |     global_secondary_index\t\t= [\n\t\t154 |         # # \"${null_resource.global_secondary_index.*.triggers}\"\n\t\t155 |         \"${var.global_secondary_indexes}\"\n\t\t156 |      ]\n\t\t157 | \n\t\t158 |     stream_enabled\t\t= \"${var.stream_view_type == \"\" ? false : true}\"\n\t\t159 |     stream_view_type\t= \"${var.stream_view_type}\"\n\t\t160 |     \n\t\t161 |     tags \t\t\t\t\t= \"${merge(var.tags, var.globals[\"tags\"])}\"\n\t\t162 | \n\t\t163 |     # server_side_encryption { enabled = \"true\" }  # MRD\n\t\t164 |     point_in_time_recovery { enabled = true }\n\t\t165 | \n\t\t166 |     # lifecycle {\n\t\t167 |     #     ignore_changes = [\n\t\t168 |     #         \"global_secondary_index\",\n\t\t169 |     #         \"read_capacity\",\n\t\t170 |     #         \"write_capacity\",\n\t\t171 |     #     ]\n\t\t172 |     # }\n\t\t173 |     \n\t\t174 | }\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: aws_dynamodb_table.dynamo_table\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /dynamo/dynamo.tf:140-174\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t140 | resource \"aws_dynamodb_table\" \"dynamo_table\" {\n\t\t141 |     name            \t= \"${var.name}\"\n\t\t142 |     read_capacity   \t= \"${var.read_capacity}\"\n\t\t143 |     write_capacity  \t= \"${var.write_capacity}\"\n\t\t144 |     hash_key        \t= \"${var.hash_key}\"\n\t\t145 |     range_key        \t= \"${var.range_key}\"\n\t\t146 | \n\t\t147 |     \n\t\t148 |     attribute = [\n\t\t149 |         \"${local.attributes}\"\n\t\t150 |     ]\n\t\t151 | \n\t\t152 | \n\t\t153 |     global_secondary_index\t\t= [\n\t\t154 |         # # \"${null_resource.global_secondary_index.*.triggers}\"\n\t\t155 |         \"${var.global_secondary_indexes}\"\n\t\t156 |      ]\n\t\t157 | \n\t\t158 |     stream_enabled\t\t= \"${var.stream_view_type == \"\" ? false : true}\"\n\t\t159 |     stream_view_type\t= \"${var.stream_view_type}\"\n\t\t160 |     \n\t\t161 |     tags \t\t\t\t\t= \"${merge(var.tags, var.globals[\"tags\"])}\"\n\t\t162 | \n\t\t163 |     # server_side_encryption { enabled = \"true\" }  # MRD\n\t\t164 |     point_in_time_recovery { enabled = true }\n\t\t165 | \n\t\t166 |     # lifecycle {\n\t\t167 |     #     ignore_changes = [\n\t\t168 |     #         \"global_secondary_index\",\n\t\t169 |     #         \"read_capacity\",\n\t\t170 |     #         \"write_capacity\",\n\t\t171 |     #     ]\n\t\t172 |     # }\n\t\t173 |     \n\t\t174 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.dynamo_table\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /dynamo/dynamo.tf:140-174\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t140 | resource \"aws_dynamodb_table\" \"dynamo_table\" {\n\t\t141 |     name            \t= \"${var.name}\"\n\t\t142 |     read_capacity   \t= \"${var.read_capacity}\"\n\t\t143 |     write_capacity  \t= \"${var.write_capacity}\"\n\t\t144 |     hash_key        \t= \"${var.hash_key}\"\n\t\t145 |     range_key        \t= \"${var.range_key}\"\n\t\t146 | \n\t\t147 |     \n\t\t148 |     attribute = [\n\t\t149 |         \"${local.attributes}\"\n\t\t150 |     ]\n\t\t151 | \n\t\t152 | \n\t\t153 |     global_secondary_index\t\t= [\n\t\t154 |         # # \"${null_resource.global_secondary_index.*.triggers}\"\n\t\t155 |         \"${var.global_secondary_indexes}\"\n\t\t156 |      ]\n\t\t157 | \n\t\t158 |     stream_enabled\t\t= \"${var.stream_view_type == \"\" ? false : true}\"\n\t\t159 |     stream_view_type\t= \"${var.stream_view_type}\"\n\t\t160 |     \n\t\t161 |     tags \t\t\t\t\t= \"${merge(var.tags, var.globals[\"tags\"])}\"\n\t\t162 | \n\t\t163 |     # server_side_encryption { enabled = \"true\" }  # MRD\n\t\t164 |     point_in_time_recovery { enabled = true }\n\t\t165 | \n\t\t166 |     # lifecycle {\n\t\t167 |     #     ignore_changes = [\n\t\t168 |     #         \"global_secondary_index\",\n\t\t169 |     #         \"read_capacity\",\n\t\t170 |     #         \"write_capacity\",\n\t\t171 |     #     ]\n\t\t172 |     # }\n\t\t173 |     \n\t\t174 | }\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/MichaelDeCorte-TerraForm-3799ee8b9677d02254eb6d6f50f3732df4c8374e/before-b6cd7fbd0cf34fba853f56bc9e0b6da18e4994ed/apiGateway/method/method.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/MichaelDeCorte-TerraForm-3799ee8b9677d02254eb6d6f50f3732df4c8374e/before-b6cd7fbd0cf34fba853f56bc9e0b6da18e4994ed/cloudwatch/logGroup/logGroup.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/MichaelDeCorte-TerraForm-3799ee8b9677d02254eb6d6f50f3732df4c8374e/before-b6cd7fbd0cf34fba853f56bc9e0b6da18e4994ed/codebuild/CodeBuild.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/MichaelDeCorte-TerraForm-3799ee8b9677d02254eb6d6f50f3732df4c8374e/before-b6cd7fbd0cf34fba853f56bc9e0b6da18e4994ed/files/files.tfֿ\n\n",
        "stderr": "2024-06-21 12:11:41,157 [MainThread  ] [WARNI]  Failed to download module git@github.com:MichaelDeCorte/Terraform.git//apiGateway/role:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:11:41,158 [MainThread  ] [WARNI]  Failed to download module git@github.com:MichaelDeCorte/Terraform.git//cloudwatch/logGroup:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:11:41,158 [MainThread  ] [WARNI]  Failed to download module git@github.com:MichaelDeCorte/TerraForm.git//cloudwatch/logGroup:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:11:41,158 [MainThread  ] [WARNI]  Failed to download module git@github.com:MichaelDeCorte/TerraForm.git//instance/basic:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:11:41,159 [MainThread  ] [WARNI]  Failed to download module git@github.com:MichaelDeCorte/Terraform.git//lambda/role:None (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 8.106876962003298
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 1, Skipped checks: 0, Parsing errors: 4\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.dynamo_table\n\tFile: /dynamo/dynamo.tf:132-174\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.dynamo_table\n\tFile: /dynamo/dynamo.tf:132-174\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: aws_dynamodb_table.dynamo_table\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /dynamo/dynamo.tf:132-174\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t132 | resource \"aws_dynamodb_table\" \"dynamo_table\" {\n\t\t133 |     name            \t= \"${var.name}\"\n\t\t134 |     read_capacity   \t= \"${var.read_capacity}\"\n\t\t135 |     write_capacity  \t= \"${var.write_capacity}\"\n\t\t136 |     hash_key        \t= \"${var.hash_key}\"\n\t\t137 |     range_key        \t= \"${var.range_key}\"\n\t\t138 | \n\t\t139 |     lifecycle {\n\t\t140 |         ignore_changes = [\n\t\t141 |             \"read_capacity\",\n\t\t142 |             \"write_capacity\"\n\t\t143 |         ]\n\t\t144 |     }\n\t\t145 |     \n\t\t146 |     attribute = [\n\t\t147 |         \"${local.attributes}\"\n\t\t148 |     ]\n\t\t149 | \n\t\t150 | \n\t\t151 |     billing_mode = \"${var.billing_mode}\"\n\t\t152 | \n\t\t153 |     global_secondary_index\t\t= [\n\t\t154 |         # # \"${null_resource.global_secondary_index.*.triggers}\"\n\t\t155 |         \"${var.global_secondary_indexes}\"\n\t\t156 |      ]\n\t\t157 | \n\t\t158 |     stream_enabled\t\t= \"${var.stream_view_type == \"\" ? false : true}\"\n\t\t159 |     stream_view_type\t= \"${var.stream_view_type}\"\n\t\t160 |     \n\t\t161 |     tags \t\t\t\t\t= \"${merge(var.tags, var.globals[\"tags\"])}\"\n\t\t162 | \n\t\t163 |     # server_side_encryption { enabled = \"true\" }  # MRD\n\t\t164 |     point_in_time_recovery { enabled = true }\n\t\t165 | \n\t\t166 |     # lifecycle {\n\t\t167 |     #     ignore_changes = [\n\t\t168 |     #         \"global_secondary_index\",\n\t\t169 |     #         \"read_capacity\",\n\t\t170 |     #         \"write_capacity\",\n\t\t171 |     #     ]\n\t\t172 |     # }\n\t\t173 |     \n\t\t174 | }\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/MichaelDeCorte-TerraForm-3799ee8b9677d02254eb6d6f50f3732df4c8374e/after/apiGateway/method/method.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/MichaelDeCorte-TerraForm-3799ee8b9677d02254eb6d6f50f3732df4c8374e/after/cloudwatch/logGroup/logGroup.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/MichaelDeCorte-TerraForm-3799ee8b9677d02254eb6d6f50f3732df4c8374e/after/codebuild/CodeBuild.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/MichaelDeCorte-TerraForm-3799ee8b9677d02254eb6d6f50f3732df4c8374e/after/files/files.tfֿ\n\n",
      "stderr": "2024-06-21 12:11:33,049 [MainThread  ] [WARNI]  Failed to download module git@github.com:MichaelDeCorte/Terraform.git//apiGateway/role:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:11:33,050 [MainThread  ] [WARNI]  Failed to download module git@github.com:MichaelDeCorte/Terraform.git//cloudwatch/logGroup:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:11:33,050 [MainThread  ] [WARNI]  Failed to download module git@github.com:MichaelDeCorte/TerraForm.git//cloudwatch/logGroup:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:11:33,050 [MainThread  ] [WARNI]  Failed to download module git@github.com:MichaelDeCorte/TerraForm.git//instance/basic:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:11:33,050 [MainThread  ] [WARNI]  Failed to download module git@github.com:MichaelDeCorte/Terraform.git//lambda/role:None (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 8.12811885899282
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/TalkingFox/SignalWs/commit/935d9d683608b4d8a97ef6ccc2c8ab7c14eec0d0",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 6, Skipped checks: 0\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.signalrooms\n\tFile: /terraform/data.tf:5-17\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.signalhosts\n\tFile: /terraform/data.tf:19-31\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.signalwords\n\tFile: /terraform/data.tf:33-45\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.signalrooms\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/data.tf:5-17\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t5  | resource \"aws_dynamodb_table\" \"signalrooms\" {\n\t\t6  |   name           = \"SignalRooms\"\n\t\t7  |   read_capacity  = 20\n\t\t8  |   write_capacity = 20\n\t\t9  |   hash_key       = \"roomName\"\n\t\t10 | \n\t\t11 |   attribute = [\n\t\t12 |     {\n\t\t13 |       name = \"roomName\"\n\t\t14 |       type = \"S\"\n\t\t15 |     }\n\t\t16 |   ]\n\t\t17 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.signalrooms\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/data.tf:5-17\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t5  | resource \"aws_dynamodb_table\" \"signalrooms\" {\n\t\t6  |   name           = \"SignalRooms\"\n\t\t7  |   read_capacity  = 20\n\t\t8  |   write_capacity = 20\n\t\t9  |   hash_key       = \"roomName\"\n\t\t10 | \n\t\t11 |   attribute = [\n\t\t12 |     {\n\t\t13 |       name = \"roomName\"\n\t\t14 |       type = \"S\"\n\t\t15 |     }\n\t\t16 |   ]\n\t\t17 | }\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.signalhosts\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/data.tf:19-31\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t19 | resource \"aws_dynamodb_table\" \"signalhosts\" {\n\t\t20 |   name           = \"SignalHosts\"\n\t\t21 |   read_capacity  = 20\n\t\t22 |   write_capacity = 20\n\t\t23 |   hash_key       = \"host\"\n\t\t24 | \n\t\t25 |   attribute = [\n\t\t26 |     {\n\t\t27 |       name = \"host\"\n\t\t28 |       type = \"S\"\n\t\t29 |     }\n\t\t30 |   ]\n\t\t31 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.signalhosts\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/data.tf:19-31\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t19 | resource \"aws_dynamodb_table\" \"signalhosts\" {\n\t\t20 |   name           = \"SignalHosts\"\n\t\t21 |   read_capacity  = 20\n\t\t22 |   write_capacity = 20\n\t\t23 |   hash_key       = \"host\"\n\t\t24 | \n\t\t25 |   attribute = [\n\t\t26 |     {\n\t\t27 |       name = \"host\"\n\t\t28 |       type = \"S\"\n\t\t29 |     }\n\t\t30 |   ]\n\t\t31 | }\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.signalwords\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/data.tf:33-45\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t33 | resource \"aws_dynamodb_table\" \"signalwords\" {\n\t\t34 |   name           = \"SignalWords\"\n\t\t35 |   read_capacity  = 20\n\t\t36 |   write_capacity = 20\n\t\t37 |   hash_key       = \"wordsProperty\"\n\t\t38 | \n\t\t39 |   attribute = [\n\t\t40 |     {\n\t\t41 |       name = \"wordsProperty\"\n\t\t42 |       type = \"S\"\n\t\t43 |     },\n\t\t44 |   ]\n\t\t45 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.signalwords\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/data.tf:33-45\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t33 | resource \"aws_dynamodb_table\" \"signalwords\" {\n\t\t34 |   name           = \"SignalWords\"\n\t\t35 |   read_capacity  = 20\n\t\t36 |   write_capacity = 20\n\t\t37 |   hash_key       = \"wordsProperty\"\n\t\t38 | \n\t\t39 |   attribute = [\n\t\t40 |     {\n\t\t41 |       name = \"wordsProperty\"\n\t\t42 |       type = \"S\"\n\t\t43 |     },\n\t\t44 |   ]\n\t\t45 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 6.7805154849920655
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 6, Failed checks: 3, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.signalrooms\n\tFile: /terraform/data.tf:5-17\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.signalrooms\n\tFile: /terraform/data.tf:5-17\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.signalhosts\n\tFile: /terraform/data.tf:19-31\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.signalhosts\n\tFile: /terraform/data.tf:19-31\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.signalwords\n\tFile: /terraform/data.tf:33-45\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.signalwords\n\tFile: /terraform/data.tf:33-45\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.signalrooms\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/data.tf:5-17\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t5  | resource \"aws_dynamodb_table\" \"signalrooms\" {\n\t\t6  |   name           = \"SignalRooms\"\n\t\t7  |   read_capacity  = 1\n\t\t8  |   write_capacity = 1\n\t\t9  |   hash_key       = \"roomName\"\n\t\t10 | \n\t\t11 |   attribute = [\n\t\t12 |     {\n\t\t13 |       name = \"roomName\"\n\t\t14 |       type = \"S\"\n\t\t15 |     }\n\t\t16 |   ]\n\t\t17 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.signalhosts\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/data.tf:19-31\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t19 | resource \"aws_dynamodb_table\" \"signalhosts\" {\n\t\t20 |   name           = \"SignalHosts\"\n\t\t21 |   read_capacity  = 1\n\t\t22 |   write_capacity = 1\n\t\t23 |   hash_key       = \"host\"\n\t\t24 | \n\t\t25 |   attribute = [\n\t\t26 |     {\n\t\t27 |       name = \"host\"\n\t\t28 |       type = \"S\"\n\t\t29 |     }\n\t\t30 |   ]\n\t\t31 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.signalwords\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/data.tf:33-45\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t33 | resource \"aws_dynamodb_table\" \"signalwords\" {\n\t\t34 |   name           = \"SignalWords\"\n\t\t35 |   read_capacity  = 1\n\t\t36 |   write_capacity = 1\n\t\t37 |   hash_key       = \"wordsProperty\"\n\t\t38 | \n\t\t39 |   attribute = [\n\t\t40 |     {\n\t\t41 |       name = \"wordsProperty\"\n\t\t42 |       type = \"S\"\n\t\t43 |     },\n\t\t44 |   ]\n\t\t45 | }\n\n\n",
      "stderr": "",
      "duration_seconds": 5.90009586699307
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/codequest-eu/terraform-modules/commit/ffe23d4c2cd78035bef0dfb261701e7ed8dd588d",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 4, Skipped checks: 0\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.meta.aws_dynamodb_table.state_lock\n\tFile: /meta/main.tf:61-73\n\tCalling File: /meta/aws_account/example/main.tf:25-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.meta.aws_dynamodb_table.meta_lock\n\tFile: /meta/main.tf:75-87\n\tCalling File: /meta/aws_account/example/main.tf:25-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: module.meta.aws_dynamodb_table.state_lock\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /meta/main.tf:61-73\n\tCalling File: /meta/aws_account/example/main.tf:25-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t61 | resource \"aws_dynamodb_table\" \"state_lock\" {\n\t\t62 |   name           = \"${local.name_prefix}-state-lock\"\n\t\t63 |   hash_key       = \"LockID\"\n\t\t64 |   read_capacity  = 20\n\t\t65 |   write_capacity = 20\n\t\t66 | \n\t\t67 |   attribute {\n\t\t68 |     name = \"LockID\"\n\t\t69 |     type = \"S\"\n\t\t70 |   }\n\t\t71 | \n\t\t72 |   tags = \"${local.tags}\"\n\t\t73 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.meta.aws_dynamodb_table.state_lock\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /meta/main.tf:61-73\n\tCalling File: /meta/aws_account/example/main.tf:25-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t61 | resource \"aws_dynamodb_table\" \"state_lock\" {\n\t\t62 |   name           = \"${local.name_prefix}-state-lock\"\n\t\t63 |   hash_key       = \"LockID\"\n\t\t64 |   read_capacity  = 20\n\t\t65 |   write_capacity = 20\n\t\t66 | \n\t\t67 |   attribute {\n\t\t68 |     name = \"LockID\"\n\t\t69 |     type = \"S\"\n\t\t70 |   }\n\t\t71 | \n\t\t72 |   tags = \"${local.tags}\"\n\t\t73 | }\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: module.meta.aws_dynamodb_table.meta_lock\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /meta/main.tf:75-87\n\tCalling File: /meta/aws_account/example/main.tf:25-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t75 | resource \"aws_dynamodb_table\" \"meta_lock\" {\n\t\t76 |   name           = \"${local.name_prefix}-meta-lock\"\n\t\t77 |   hash_key       = \"LockID\"\n\t\t78 |   read_capacity  = 20\n\t\t79 |   write_capacity = 20\n\t\t80 | \n\t\t81 |   attribute {\n\t\t82 |     name = \"LockID\"\n\t\t83 |     type = \"S\"\n\t\t84 |   }\n\t\t85 | \n\t\t86 |   tags = \"${local.tags}\"\n\t\t87 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.meta.aws_dynamodb_table.meta_lock\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /meta/main.tf:75-87\n\tCalling File: /meta/aws_account/example/main.tf:25-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t75 | resource \"aws_dynamodb_table\" \"meta_lock\" {\n\t\t76 |   name           = \"${local.name_prefix}-meta-lock\"\n\t\t77 |   hash_key       = \"LockID\"\n\t\t78 |   read_capacity  = 20\n\t\t79 |   write_capacity = 20\n\t\t80 | \n\t\t81 |   attribute {\n\t\t82 |     name = \"LockID\"\n\t\t83 |     type = \"S\"\n\t\t84 |   }\n\t\t85 | \n\t\t86 |   tags = \"${local.tags}\"\n\t\t87 | }\n\n\n",
        "stderr": "2024-06-21 12:12:10,903 [MainThread  ] [WARNI]  Failed to download module ..:None (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 10.017236068990314
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 4, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.meta.aws_dynamodb_table.state_lock\n\tFile: /meta/main.tf:61-73\n\tCalling File: /meta/aws_account/example/main.tf:25-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.meta.aws_dynamodb_table.state_lock\n\tFile: /meta/main.tf:61-73\n\tCalling File: /meta/aws_account/example/main.tf:25-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.meta.aws_dynamodb_table.meta_lock\n\tFile: /meta/main.tf:75-87\n\tCalling File: /meta/aws_account/example/main.tf:25-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.meta.aws_dynamodb_table.meta_lock\n\tFile: /meta/main.tf:75-87\n\tCalling File: /meta/aws_account/example/main.tf:25-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.meta.aws_dynamodb_table.state_lock\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /meta/main.tf:61-73\n\tCalling File: /meta/aws_account/example/main.tf:25-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t61 | resource \"aws_dynamodb_table\" \"state_lock\" {\n\t\t62 |   name           = \"${local.name_prefix}-state-lock\"\n\t\t63 |   hash_key       = \"LockID\"\n\t\t64 |   read_capacity  = 1\n\t\t65 |   write_capacity = 1\n\t\t66 | \n\t\t67 |   attribute {\n\t\t68 |     name = \"LockID\"\n\t\t69 |     type = \"S\"\n\t\t70 |   }\n\t\t71 | \n\t\t72 |   tags = \"${local.tags}\"\n\t\t73 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.meta.aws_dynamodb_table.meta_lock\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /meta/main.tf:75-87\n\tCalling File: /meta/aws_account/example/main.tf:25-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t75 | resource \"aws_dynamodb_table\" \"meta_lock\" {\n\t\t76 |   name           = \"${local.name_prefix}-meta-lock\"\n\t\t77 |   hash_key       = \"LockID\"\n\t\t78 |   read_capacity  = 1\n\t\t79 |   write_capacity = 1\n\t\t80 | \n\t\t81 |   attribute {\n\t\t82 |     name = \"LockID\"\n\t\t83 |     type = \"S\"\n\t\t84 |   }\n\t\t85 | \n\t\t86 |   tags = \"${local.tags}\"\n\t\t87 | }\n\n\n",
      "stderr": "2024-06-21 12:12:01,256 [MainThread  ] [WARNI]  Failed to download module ..:None (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 8.96156565999263
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/dgorbov/terraform-s3-backend-setup/commit/81f82740760a357a86b3a77f9ed400624edcb218",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.tf_state_lock\n\tFile: /main.tf:25-37\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.tf_state_lock\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /main.tf:25-37\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t25 | resource \"aws_dynamodb_table\" \"tf_state_lock\" {\n\t\t26 |   name = \"tf-state-lock-${var.s3_bucket_name}\"\n\t\t27 |   hash_key = \"LockID\"\n\t\t28 |   read_capacity = 20\n\t\t29 |   write_capacity = 20\n\t\t30 |   attribute {\n\t\t31 |     name = \"LockID\"\n\t\t32 |     type = \"S\"\n\t\t33 |   }\n\t\t34 |   tags = {\n\t\t35 |     Name = \"DynamoDB table for locking terraform state\"\n\t\t36 |   }\n\t\t37 | }\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.tf_state_lock\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /main.tf:25-37\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t25 | resource \"aws_dynamodb_table\" \"tf_state_lock\" {\n\t\t26 |   name = \"tf-state-lock-${var.s3_bucket_name}\"\n\t\t27 |   hash_key = \"LockID\"\n\t\t28 |   read_capacity = 20\n\t\t29 |   write_capacity = 20\n\t\t30 |   attribute {\n\t\t31 |     name = \"LockID\"\n\t\t32 |     type = \"S\"\n\t\t33 |   }\n\t\t34 |   tags = {\n\t\t35 |     Name = \"DynamoDB table for locking terraform state\"\n\t\t36 |   }\n\t\t37 | }\n\n",
        "stderr": "",
        "duration_seconds": 5.891910881997319
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.tf_state_lock\n\tFile: /main.tf:25-38\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.tf_state_lock\n\tFile: /main.tf:25-38\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.tf_state_lock\n\tFile: /main.tf:25-38\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "",
      "duration_seconds": 6.475255829995149
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/sbogacz/terraform-aws-state-backend/commit/174486319f3b956807d56e5433880f9978884f93",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.dynamodb_terraform_state_lock\n\tFile: /main.tf:42-58\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.dynamodb_terraform_state_lock\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /main.tf:42-58\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t42 | resource \"aws_dynamodb_table\" \"dynamodb_terraform_state_lock\" {\n\t\t43 |   name = \"${format(\"%s-state-file-lock\", var.bucket_prefix)}\"\n\t\t44 | \n\t\t45 |   # This is required per the Terraform documentation\n\t\t46 |   # https://www.terraform.io/docs/backends/types/s3.html#dynamodb_table\n\t\t47 |   hash_key = \"LockID\"\n\t\t48 | \n\t\t49 |   read_capacity  = \"${var.lock_table_read_capacity}\"\n\t\t50 |   write_capacity = \"${var.lock_table_write_capacity}\"\n\t\t51 | \n\t\t52 |   attribute {\n\t\t53 |     name = \"LockID\"\n\t\t54 |     type = \"S\"\n\t\t55 |   }\n\t\t56 | \n\t\t57 |   tags = \"${var.tags}\"\n\t\t58 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.dynamodb_terraform_state_lock\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /main.tf:42-58\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t42 | resource \"aws_dynamodb_table\" \"dynamodb_terraform_state_lock\" {\n\t\t43 |   name = \"${format(\"%s-state-file-lock\", var.bucket_prefix)}\"\n\t\t44 | \n\t\t45 |   # This is required per the Terraform documentation\n\t\t46 |   # https://www.terraform.io/docs/backends/types/s3.html#dynamodb_table\n\t\t47 |   hash_key = \"LockID\"\n\t\t48 | \n\t\t49 |   read_capacity  = \"${var.lock_table_read_capacity}\"\n\t\t50 |   write_capacity = \"${var.lock_table_write_capacity}\"\n\t\t51 | \n\t\t52 |   attribute {\n\t\t53 |     name = \"LockID\"\n\t\t54 |     type = \"S\"\n\t\t55 |   }\n\t\t56 | \n\t\t57 |   tags = \"${var.tags}\"\n\t\t58 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 6.0021675739990314
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.dynamodb_terraform_state_lock\n\tFile: /main.tf:42-58\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.dynamodb_terraform_state_lock\n\tFile: /main.tf:42-58\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.dynamodb_terraform_state_lock\n\tFile: /main.tf:42-58\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "",
      "duration_seconds": 5.704382531999727
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/giuseppeborgese/terraform-locking-s3-state/commit/6b4e59e8b844417dc5c247bdef1b0adb8e2e7028",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.dynamodb-terraform-state-lock\n\tFile: /remote.tf:33-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.dynamodb-terraform-state-lock\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /remote.tf:33-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t33 | resource \"aws_dynamodb_table\" \"dynamodb-terraform-state-lock\" {\n\t\t34 |   name = \"terraform-state-lock-dynamo\"\n\t\t35 |   hash_key = \"LockID\"\n\t\t36 |   read_capacity = 20\n\t\t37 |   write_capacity = 20\n\t\t38 | \n\t\t39 |   attribute {\n\t\t40 |     name = \"LockID\"\n\t\t41 |     type = \"S\"\n\t\t42 |   }\n\t\t43 | \n\t\t44 |   tags = {\n\t\t45 |     Name = \"DynamoDB Terraform State Lock Table\"\n\t\t46 |   }\n\t\t47 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.dynamodb-terraform-state-lock\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /remote.tf:33-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t33 | resource \"aws_dynamodb_table\" \"dynamodb-terraform-state-lock\" {\n\t\t34 |   name = \"terraform-state-lock-dynamo\"\n\t\t35 |   hash_key = \"LockID\"\n\t\t36 |   read_capacity = 20\n\t\t37 |   write_capacity = 20\n\t\t38 | \n\t\t39 |   attribute {\n\t\t40 |     name = \"LockID\"\n\t\t41 |     type = \"S\"\n\t\t42 |   }\n\t\t43 | \n\t\t44 |   tags = {\n\t\t45 |     Name = \"DynamoDB Terraform State Lock Table\"\n\t\t46 |   }\n\t\t47 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 6.313598546999856
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.dynamodb-terraform-state-lock\n\tFile: /remote.tf:33-50\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.dynamodb-terraform-state-lock\n\tFile: /remote.tf:33-50\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.dynamodb-terraform-state-lock\n\tFile: /remote.tf:33-50\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "",
      "duration_seconds": 6.465181302992278
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/gudlyf/TerraformOpenVPN/commit/be1245d8634025277ba79a4155ee88d7eaffcdfb",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_instance.ovpn\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /AWS/ec2.tf:17-72\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\n\n",
        "stderr": "",
        "duration_seconds": 6.144707107989234
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.ovpn\n\tFile: /AWS/ec2.tf:12-67\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n",
      "stderr": "",
      "duration_seconds": 7.083076688009896
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/alphagov/govuk-aws/commit/6cfda6ada5137b232ff442ae9f2aedc8520ee1b4",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 9, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.graphite-1\n\tFile: /terraform/projects/app-graphite/main.tf:213-227\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.apt\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-apt/main.tf:195-209\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t195 | resource \"aws_ebs_volume\" \"apt\" {\n\t\t196 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.apt_1_subnet)}\"\n\t\t197 |   size              = 40\n\t\t198 |   type              = \"gp2\"\n\t\t199 | \n\t\t200 |   tags {\n\t\t201 |     Name            = \"${var.stackname}-apt\"\n\t\t202 |     Project         = \"${var.stackname}\"\n\t\t203 |     Device          = \"xvdf\"\n\t\t204 |     aws_hostname    = \"apt-1\"\n\t\t205 |     aws_migration   = \"apt\"\n\t\t206 |     aws_stackname   = \"${var.stackname}\"\n\t\t207 |     aws_environment = \"${var.aws_environment}\"\n\t\t208 |   }\n\t\t209 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.deploy\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-deploy/main.tf:205-219\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t205 | resource \"aws_ebs_volume\" \"deploy\" {\n\t\t206 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.deploy_subnet)}\"\n\t\t207 |   size              = 40\n\t\t208 |   type              = \"gp2\"\n\t\t209 | \n\t\t210 |   tags {\n\t\t211 |     Name            = \"${var.stackname}-deploy\"\n\t\t212 |     Project         = \"${var.stackname}\"\n\t\t213 |     Device          = \"xvdf\"\n\t\t214 |     aws_hostname    = \"jenkins-1\"\n\t\t215 |     aws_migration   = \"jenkins\"\n\t\t216 |     aws_stackname   = \"${var.stackname}\"\n\t\t217 |     aws_environment = \"${var.aws_environment}\"\n\t\t218 |   }\n\t\t219 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.logs-cdn\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-logs-cdn/main.tf:131-145\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t131 | resource \"aws_ebs_volume\" \"logs-cdn\" {\n\t\t132 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.logs_cdn_subnet)}\"\n\t\t133 |   size              = 500\n\t\t134 |   type              = \"gp2\"\n\t\t135 | \n\t\t136 |   tags {\n\t\t137 |     Name            = \"${var.stackname}-logs-cdn\"\n\t\t138 |     Project         = \"${var.stackname}\"\n\t\t139 |     aws_stackname   = \"${var.stackname}\"\n\t\t140 |     aws_environment = \"${var.aws_environment}\"\n\t\t141 |     aws_migration   = \"logs_cdn\"\n\t\t142 |     aws_hostname    = \"logs-cdn-1\"\n\t\t143 |     Device          = \"xvdf\"\n\t\t144 |   }\n\t\t145 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mapit-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mapit/main.tf:144-157\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t144 | resource \"aws_ebs_volume\" \"mapit-1\" {\n\t\t145 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mapit_1_subnet)}\"\n\t\t146 |   size              = 20\n\t\t147 |   type              = \"gp2\"\n\t\t148 | \n\t\t149 |   tags {\n\t\t150 |     Name            = \"${var.stackname}-mapit\"\n\t\t151 |     Project         = \"${var.stackname}\"\n\t\t152 |     aws_hostname    = \"mapit-1\"\n\t\t153 |     aws_migration   = \"mapit\"\n\t\t154 |     aws_stackname   = \"${var.stackname}\"\n\t\t155 |     aws_environment = \"${var.aws_environment}\"\n\t\t156 |   }\n\t\t157 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mapit-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mapit/main.tf:177-190\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t177 | resource \"aws_ebs_volume\" \"mapit-2\" {\n\t\t178 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mapit_2_subnet)}\"\n\t\t179 |   size              = 20\n\t\t180 |   type              = \"gp2\"\n\t\t181 | \n\t\t182 |   tags {\n\t\t183 |     Name            = \"${var.stackname}-mapit\"\n\t\t184 |     Project         = \"${var.stackname}\"\n\t\t185 |     aws_hostname    = \"mapit-2\"\n\t\t186 |     aws_migration   = \"mapit\"\n\t\t187 |     aws_stackname   = \"${var.stackname}\"\n\t\t188 |     aws_environment = \"${var.aws_environment}\"\n\t\t189 |   }\n\t\t190 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mirrorer\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mirrorer/main.tf:71-85\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t71 | resource \"aws_ebs_volume\" \"mirrorer\" {\n\t\t72 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mirrorer_subnet)}\"\n\t\t73 |   size              = 100\n\t\t74 |   type              = \"gp2\"\n\t\t75 | \n\t\t76 |   tags {\n\t\t77 |     Name            = \"${var.stackname}-mirrorer\"\n\t\t78 |     Project         = \"${var.stackname}\"\n\t\t79 |     Device          = \"xvdf\"\n\t\t80 |     aws_hostname    = \"mirrorer-1\"\n\t\t81 |     aws_migration   = \"mirrorer\"\n\t\t82 |     aws_stackname   = \"${var.stackname}\"\n\t\t83 |     aws_environment = \"${var.aws_environment}\"\n\t\t84 |   }\n\t\t85 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.rummager-elasticsearch-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-rummager-elasticsearch/main.tf:160-174\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t160 | resource \"aws_ebs_volume\" \"rummager-elasticsearch-1\" {\n\t\t161 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.rummager_elasticsearch_1_subnet)}\"\n\t\t162 |   size              = 100\n\t\t163 |   type              = \"gp2\"\n\t\t164 | \n\t\t165 |   tags {\n\t\t166 |     Name            = \"${var.stackname}-rummager-elasticsearch-1\"\n\t\t167 |     Project         = \"${var.stackname}\"\n\t\t168 |     aws_stackname   = \"${var.stackname}\"\n\t\t169 |     aws_environment = \"${var.aws_environment}\"\n\t\t170 |     aws_migration   = \"rummager_elasticsearch\"\n\t\t171 |     aws_hostname    = \"rummager-elasticsearch-1\"\n\t\t172 |     Device          = \"xvdf\"\n\t\t173 |   }\n\t\t174 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.rummager-elasticsearch-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-rummager-elasticsearch/main.tf:194-208\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t194 | resource \"aws_ebs_volume\" \"rummager-elasticsearch-2\" {\n\t\t195 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.rummager_elasticsearch_2_subnet)}\"\n\t\t196 |   size              = 100\n\t\t197 |   type              = \"gp2\"\n\t\t198 | \n\t\t199 |   tags {\n\t\t200 |     Name            = \"${var.stackname}-rummager-elasticsearch-2\"\n\t\t201 |     Project         = \"${var.stackname}\"\n\t\t202 |     aws_stackname   = \"${var.stackname}\"\n\t\t203 |     aws_environment = \"${var.aws_environment}\"\n\t\t204 |     aws_migration   = \"rummager_elasticsearch\"\n\t\t205 |     aws_hostname    = \"rummager-elasticsearch-2\"\n\t\t206 |     Device          = \"xvdf\"\n\t\t207 |   }\n\t\t208 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.rummager-elasticsearch-3\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-rummager-elasticsearch/main.tf:228-242\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t228 | resource \"aws_ebs_volume\" \"rummager-elasticsearch-3\" {\n\t\t229 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.rummager_elasticsearch_3_subnet)}\"\n\t\t230 |   size              = 100\n\t\t231 |   type              = \"gp2\"\n\t\t232 | \n\t\t233 |   tags {\n\t\t234 |     Name            = \"${var.stackname}-rummager-elasticsearch-3\"\n\t\t235 |     Project         = \"${var.stackname}\"\n\t\t236 |     aws_stackname   = \"${var.stackname}\"\n\t\t237 |     aws_environment = \"${var.aws_environment}\"\n\t\t238 |     aws_migration   = \"rummager_elasticsearch\"\n\t\t239 |     aws_hostname    = \"rummager-elasticsearch-3\"\n\t\t240 |     Device          = \"xvdf\"\n\t\t241 |   }\n\t\t242 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 29.39041295700008
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 9, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.graphite-1\n\tFile: /terraform/projects/app-graphite/main.tf:213-227\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.apt\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-apt/main.tf:195-209\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t195 | resource \"aws_ebs_volume\" \"apt\" {\n\t\t196 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.apt_1_subnet)}\"\n\t\t197 |   size              = 40\n\t\t198 |   type              = \"gp2\"\n\t\t199 | \n\t\t200 |   tags {\n\t\t201 |     Name            = \"${var.stackname}-apt\"\n\t\t202 |     Project         = \"${var.stackname}\"\n\t\t203 |     Device          = \"xvdf\"\n\t\t204 |     aws_hostname    = \"apt-1\"\n\t\t205 |     aws_migration   = \"apt\"\n\t\t206 |     aws_stackname   = \"${var.stackname}\"\n\t\t207 |     aws_environment = \"${var.aws_environment}\"\n\t\t208 |   }\n\t\t209 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.deploy\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-deploy/main.tf:205-219\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t205 | resource \"aws_ebs_volume\" \"deploy\" {\n\t\t206 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.deploy_subnet)}\"\n\t\t207 |   size              = 40\n\t\t208 |   type              = \"gp2\"\n\t\t209 | \n\t\t210 |   tags {\n\t\t211 |     Name            = \"${var.stackname}-deploy\"\n\t\t212 |     Project         = \"${var.stackname}\"\n\t\t213 |     Device          = \"xvdf\"\n\t\t214 |     aws_hostname    = \"jenkins-1\"\n\t\t215 |     aws_migration   = \"jenkins\"\n\t\t216 |     aws_stackname   = \"${var.stackname}\"\n\t\t217 |     aws_environment = \"${var.aws_environment}\"\n\t\t218 |   }\n\t\t219 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.logs-cdn\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-logs-cdn/main.tf:131-145\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t131 | resource \"aws_ebs_volume\" \"logs-cdn\" {\n\t\t132 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.logs_cdn_subnet)}\"\n\t\t133 |   size              = 500\n\t\t134 |   type              = \"gp2\"\n\t\t135 | \n\t\t136 |   tags {\n\t\t137 |     Name            = \"${var.stackname}-logs-cdn\"\n\t\t138 |     Project         = \"${var.stackname}\"\n\t\t139 |     aws_stackname   = \"${var.stackname}\"\n\t\t140 |     aws_environment = \"${var.aws_environment}\"\n\t\t141 |     aws_migration   = \"logs_cdn\"\n\t\t142 |     aws_hostname    = \"logs-cdn-1\"\n\t\t143 |     Device          = \"xvdf\"\n\t\t144 |   }\n\t\t145 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mapit-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mapit/main.tf:144-157\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t144 | resource \"aws_ebs_volume\" \"mapit-1\" {\n\t\t145 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mapit_1_subnet)}\"\n\t\t146 |   size              = 20\n\t\t147 |   type              = \"gp2\"\n\t\t148 | \n\t\t149 |   tags {\n\t\t150 |     Name            = \"${var.stackname}-mapit\"\n\t\t151 |     Project         = \"${var.stackname}\"\n\t\t152 |     aws_hostname    = \"mapit-1\"\n\t\t153 |     aws_migration   = \"mapit\"\n\t\t154 |     aws_stackname   = \"${var.stackname}\"\n\t\t155 |     aws_environment = \"${var.aws_environment}\"\n\t\t156 |   }\n\t\t157 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mapit-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mapit/main.tf:177-190\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t177 | resource \"aws_ebs_volume\" \"mapit-2\" {\n\t\t178 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mapit_2_subnet)}\"\n\t\t179 |   size              = 20\n\t\t180 |   type              = \"gp2\"\n\t\t181 | \n\t\t182 |   tags {\n\t\t183 |     Name            = \"${var.stackname}-mapit\"\n\t\t184 |     Project         = \"${var.stackname}\"\n\t\t185 |     aws_hostname    = \"mapit-2\"\n\t\t186 |     aws_migration   = \"mapit\"\n\t\t187 |     aws_stackname   = \"${var.stackname}\"\n\t\t188 |     aws_environment = \"${var.aws_environment}\"\n\t\t189 |   }\n\t\t190 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mirrorer\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mirrorer/main.tf:71-85\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t71 | resource \"aws_ebs_volume\" \"mirrorer\" {\n\t\t72 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mirrorer_subnet)}\"\n\t\t73 |   size              = 100\n\t\t74 |   type              = \"gp2\"\n\t\t75 | \n\t\t76 |   tags {\n\t\t77 |     Name            = \"${var.stackname}-mirrorer\"\n\t\t78 |     Project         = \"${var.stackname}\"\n\t\t79 |     Device          = \"xvdf\"\n\t\t80 |     aws_hostname    = \"mirrorer-1\"\n\t\t81 |     aws_migration   = \"mirrorer\"\n\t\t82 |     aws_stackname   = \"${var.stackname}\"\n\t\t83 |     aws_environment = \"${var.aws_environment}\"\n\t\t84 |   }\n\t\t85 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.rummager-elasticsearch-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-rummager-elasticsearch/main.tf:160-174\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t160 | resource \"aws_ebs_volume\" \"rummager-elasticsearch-1\" {\n\t\t161 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.rummager_elasticsearch_1_subnet)}\"\n\t\t162 |   size              = 100\n\t\t163 |   type              = \"gp2\"\n\t\t164 | \n\t\t165 |   tags {\n\t\t166 |     Name            = \"${var.stackname}-rummager-elasticsearch-1\"\n\t\t167 |     Project         = \"${var.stackname}\"\n\t\t168 |     aws_stackname   = \"${var.stackname}\"\n\t\t169 |     aws_environment = \"${var.aws_environment}\"\n\t\t170 |     aws_migration   = \"rummager_elasticsearch\"\n\t\t171 |     aws_hostname    = \"rummager-elasticsearch-1\"\n\t\t172 |     Device          = \"xvdf\"\n\t\t173 |   }\n\t\t174 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.rummager-elasticsearch-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-rummager-elasticsearch/main.tf:194-208\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t194 | resource \"aws_ebs_volume\" \"rummager-elasticsearch-2\" {\n\t\t195 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.rummager_elasticsearch_2_subnet)}\"\n\t\t196 |   size              = 100\n\t\t197 |   type              = \"gp2\"\n\t\t198 | \n\t\t199 |   tags {\n\t\t200 |     Name            = \"${var.stackname}-rummager-elasticsearch-2\"\n\t\t201 |     Project         = \"${var.stackname}\"\n\t\t202 |     aws_stackname   = \"${var.stackname}\"\n\t\t203 |     aws_environment = \"${var.aws_environment}\"\n\t\t204 |     aws_migration   = \"rummager_elasticsearch\"\n\t\t205 |     aws_hostname    = \"rummager-elasticsearch-2\"\n\t\t206 |     Device          = \"xvdf\"\n\t\t207 |   }\n\t\t208 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.rummager-elasticsearch-3\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-rummager-elasticsearch/main.tf:228-242\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t228 | resource \"aws_ebs_volume\" \"rummager-elasticsearch-3\" {\n\t\t229 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.rummager_elasticsearch_3_subnet)}\"\n\t\t230 |   size              = 100\n\t\t231 |   type              = \"gp2\"\n\t\t232 | \n\t\t233 |   tags {\n\t\t234 |     Name            = \"${var.stackname}-rummager-elasticsearch-3\"\n\t\t235 |     Project         = \"${var.stackname}\"\n\t\t236 |     aws_stackname   = \"${var.stackname}\"\n\t\t237 |     aws_environment = \"${var.aws_environment}\"\n\t\t238 |     aws_migration   = \"rummager_elasticsearch\"\n\t\t239 |     aws_hostname    = \"rummager-elasticsearch-3\"\n\t\t240 |     Device          = \"xvdf\"\n\t\t241 |   }\n\t\t242 | }\n\n\n",
      "stderr": "",
      "duration_seconds": 27.812800455008983
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/alphagov/govuk-aws/commit/aeb3bfbe393cdfc02e62b812843ed75cf5f245e4",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 9, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.graphite-1\n\tFile: /terraform/projects/app-graphite/main.tf:213-227\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.apt\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-apt/main.tf:195-209\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t195 | resource \"aws_ebs_volume\" \"apt\" {\n\t\t196 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.apt_1_subnet)}\"\n\t\t197 |   size              = 40\n\t\t198 |   type              = \"gp2\"\n\t\t199 | \n\t\t200 |   tags {\n\t\t201 |     Name            = \"${var.stackname}-apt\"\n\t\t202 |     Project         = \"${var.stackname}\"\n\t\t203 |     Device          = \"xvdf\"\n\t\t204 |     aws_hostname    = \"apt-1\"\n\t\t205 |     aws_migration   = \"apt\"\n\t\t206 |     aws_stackname   = \"${var.stackname}\"\n\t\t207 |     aws_environment = \"${var.aws_environment}\"\n\t\t208 |   }\n\t\t209 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.deploy\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-deploy/main.tf:205-219\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t205 | resource \"aws_ebs_volume\" \"deploy\" {\n\t\t206 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.deploy_subnet)}\"\n\t\t207 |   size              = 40\n\t\t208 |   type              = \"gp2\"\n\t\t209 | \n\t\t210 |   tags {\n\t\t211 |     Name            = \"${var.stackname}-deploy\"\n\t\t212 |     Project         = \"${var.stackname}\"\n\t\t213 |     Device          = \"xvdf\"\n\t\t214 |     aws_hostname    = \"jenkins-1\"\n\t\t215 |     aws_migration   = \"jenkins\"\n\t\t216 |     aws_stackname   = \"${var.stackname}\"\n\t\t217 |     aws_environment = \"${var.aws_environment}\"\n\t\t218 |   }\n\t\t219 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.logs-cdn\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-logs-cdn/main.tf:131-145\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t131 | resource \"aws_ebs_volume\" \"logs-cdn\" {\n\t\t132 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.logs_cdn_subnet)}\"\n\t\t133 |   size              = 500\n\t\t134 |   type              = \"gp2\"\n\t\t135 | \n\t\t136 |   tags {\n\t\t137 |     Name            = \"${var.stackname}-logs-cdn\"\n\t\t138 |     Project         = \"${var.stackname}\"\n\t\t139 |     aws_stackname   = \"${var.stackname}\"\n\t\t140 |     aws_environment = \"${var.aws_environment}\"\n\t\t141 |     aws_migration   = \"logs_cdn\"\n\t\t142 |     aws_hostname    = \"logs-cdn-1\"\n\t\t143 |     Device          = \"xvdf\"\n\t\t144 |   }\n\t\t145 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mapit-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mapit/main.tf:144-157\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t144 | resource \"aws_ebs_volume\" \"mapit-1\" {\n\t\t145 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mapit_1_subnet)}\"\n\t\t146 |   size              = 20\n\t\t147 |   type              = \"gp2\"\n\t\t148 | \n\t\t149 |   tags {\n\t\t150 |     Name            = \"${var.stackname}-mapit\"\n\t\t151 |     Project         = \"${var.stackname}\"\n\t\t152 |     aws_hostname    = \"mapit-1\"\n\t\t153 |     aws_migration   = \"mapit\"\n\t\t154 |     aws_stackname   = \"${var.stackname}\"\n\t\t155 |     aws_environment = \"${var.aws_environment}\"\n\t\t156 |   }\n\t\t157 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mapit-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mapit/main.tf:177-190\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t177 | resource \"aws_ebs_volume\" \"mapit-2\" {\n\t\t178 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mapit_2_subnet)}\"\n\t\t179 |   size              = 20\n\t\t180 |   type              = \"gp2\"\n\t\t181 | \n\t\t182 |   tags {\n\t\t183 |     Name            = \"${var.stackname}-mapit\"\n\t\t184 |     Project         = \"${var.stackname}\"\n\t\t185 |     aws_hostname    = \"mapit-2\"\n\t\t186 |     aws_migration   = \"mapit\"\n\t\t187 |     aws_stackname   = \"${var.stackname}\"\n\t\t188 |     aws_environment = \"${var.aws_environment}\"\n\t\t189 |   }\n\t\t190 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mirrorer\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mirrorer/main.tf:71-85\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t71 | resource \"aws_ebs_volume\" \"mirrorer\" {\n\t\t72 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mirrorer_subnet)}\"\n\t\t73 |   size              = 100\n\t\t74 |   type              = \"gp2\"\n\t\t75 | \n\t\t76 |   tags {\n\t\t77 |     Name            = \"${var.stackname}-mirrorer\"\n\t\t78 |     Project         = \"${var.stackname}\"\n\t\t79 |     Device          = \"xvdf\"\n\t\t80 |     aws_hostname    = \"mirrorer-1\"\n\t\t81 |     aws_migration   = \"mirrorer\"\n\t\t82 |     aws_stackname   = \"${var.stackname}\"\n\t\t83 |     aws_environment = \"${var.aws_environment}\"\n\t\t84 |   }\n\t\t85 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.rummager-elasticsearch-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-rummager-elasticsearch/main.tf:160-174\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t160 | resource \"aws_ebs_volume\" \"rummager-elasticsearch-1\" {\n\t\t161 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.rummager_elasticsearch_1_subnet)}\"\n\t\t162 |   size              = 100\n\t\t163 |   type              = \"gp2\"\n\t\t164 | \n\t\t165 |   tags {\n\t\t166 |     Name            = \"${var.stackname}-rummager-elasticsearch-1\"\n\t\t167 |     Project         = \"${var.stackname}\"\n\t\t168 |     aws_stackname   = \"${var.stackname}\"\n\t\t169 |     aws_environment = \"${var.aws_environment}\"\n\t\t170 |     aws_migration   = \"rummager_elasticsearch\"\n\t\t171 |     aws_hostname    = \"rummager-elasticsearch-1\"\n\t\t172 |     Device          = \"xvdf\"\n\t\t173 |   }\n\t\t174 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.rummager-elasticsearch-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-rummager-elasticsearch/main.tf:194-208\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t194 | resource \"aws_ebs_volume\" \"rummager-elasticsearch-2\" {\n\t\t195 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.rummager_elasticsearch_2_subnet)}\"\n\t\t196 |   size              = 100\n\t\t197 |   type              = \"gp2\"\n\t\t198 | \n\t\t199 |   tags {\n\t\t200 |     Name            = \"${var.stackname}-rummager-elasticsearch-2\"\n\t\t201 |     Project         = \"${var.stackname}\"\n\t\t202 |     aws_stackname   = \"${var.stackname}\"\n\t\t203 |     aws_environment = \"${var.aws_environment}\"\n\t\t204 |     aws_migration   = \"rummager_elasticsearch\"\n\t\t205 |     aws_hostname    = \"rummager-elasticsearch-2\"\n\t\t206 |     Device          = \"xvdf\"\n\t\t207 |   }\n\t\t208 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.rummager-elasticsearch-3\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-rummager-elasticsearch/main.tf:228-242\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t228 | resource \"aws_ebs_volume\" \"rummager-elasticsearch-3\" {\n\t\t229 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.rummager_elasticsearch_3_subnet)}\"\n\t\t230 |   size              = 100\n\t\t231 |   type              = \"gp2\"\n\t\t232 | \n\t\t233 |   tags {\n\t\t234 |     Name            = \"${var.stackname}-rummager-elasticsearch-3\"\n\t\t235 |     Project         = \"${var.stackname}\"\n\t\t236 |     aws_stackname   = \"${var.stackname}\"\n\t\t237 |     aws_environment = \"${var.aws_environment}\"\n\t\t238 |     aws_migration   = \"rummager_elasticsearch\"\n\t\t239 |     aws_hostname    = \"rummager-elasticsearch-3\"\n\t\t240 |     Device          = \"xvdf\"\n\t\t241 |   }\n\t\t242 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 20.81062525699963
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 9, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.graphite-1\n\tFile: /terraform/projects/app-graphite/main.tf:213-227\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.apt\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-apt/main.tf:195-209\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t195 | resource \"aws_ebs_volume\" \"apt\" {\n\t\t196 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.apt_1_subnet)}\"\n\t\t197 |   size              = 40\n\t\t198 |   type              = \"gp2\"\n\t\t199 | \n\t\t200 |   tags {\n\t\t201 |     Name            = \"${var.stackname}-apt\"\n\t\t202 |     Project         = \"${var.stackname}\"\n\t\t203 |     Device          = \"xvdf\"\n\t\t204 |     aws_hostname    = \"apt-1\"\n\t\t205 |     aws_migration   = \"apt\"\n\t\t206 |     aws_stackname   = \"${var.stackname}\"\n\t\t207 |     aws_environment = \"${var.aws_environment}\"\n\t\t208 |   }\n\t\t209 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.deploy\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-deploy/main.tf:205-219\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t205 | resource \"aws_ebs_volume\" \"deploy\" {\n\t\t206 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.deploy_subnet)}\"\n\t\t207 |   size              = 40\n\t\t208 |   type              = \"gp2\"\n\t\t209 | \n\t\t210 |   tags {\n\t\t211 |     Name            = \"${var.stackname}-deploy\"\n\t\t212 |     Project         = \"${var.stackname}\"\n\t\t213 |     Device          = \"xvdf\"\n\t\t214 |     aws_hostname    = \"jenkins-1\"\n\t\t215 |     aws_migration   = \"jenkins\"\n\t\t216 |     aws_stackname   = \"${var.stackname}\"\n\t\t217 |     aws_environment = \"${var.aws_environment}\"\n\t\t218 |   }\n\t\t219 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.logs-cdn\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-logs-cdn/main.tf:131-145\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t131 | resource \"aws_ebs_volume\" \"logs-cdn\" {\n\t\t132 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.logs_cdn_subnet)}\"\n\t\t133 |   size              = 500\n\t\t134 |   type              = \"gp2\"\n\t\t135 | \n\t\t136 |   tags {\n\t\t137 |     Name            = \"${var.stackname}-logs-cdn\"\n\t\t138 |     Project         = \"${var.stackname}\"\n\t\t139 |     aws_stackname   = \"${var.stackname}\"\n\t\t140 |     aws_environment = \"${var.aws_environment}\"\n\t\t141 |     aws_migration   = \"logs_cdn\"\n\t\t142 |     aws_hostname    = \"logs-cdn-1\"\n\t\t143 |     Device          = \"xvdf\"\n\t\t144 |   }\n\t\t145 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mapit-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mapit/main.tf:144-157\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t144 | resource \"aws_ebs_volume\" \"mapit-1\" {\n\t\t145 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mapit_1_subnet)}\"\n\t\t146 |   size              = 20\n\t\t147 |   type              = \"gp2\"\n\t\t148 | \n\t\t149 |   tags {\n\t\t150 |     Name            = \"${var.stackname}-mapit\"\n\t\t151 |     Project         = \"${var.stackname}\"\n\t\t152 |     aws_hostname    = \"mapit-1\"\n\t\t153 |     aws_migration   = \"mapit\"\n\t\t154 |     aws_stackname   = \"${var.stackname}\"\n\t\t155 |     aws_environment = \"${var.aws_environment}\"\n\t\t156 |   }\n\t\t157 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mapit-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mapit/main.tf:177-190\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t177 | resource \"aws_ebs_volume\" \"mapit-2\" {\n\t\t178 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mapit_2_subnet)}\"\n\t\t179 |   size              = 20\n\t\t180 |   type              = \"gp2\"\n\t\t181 | \n\t\t182 |   tags {\n\t\t183 |     Name            = \"${var.stackname}-mapit\"\n\t\t184 |     Project         = \"${var.stackname}\"\n\t\t185 |     aws_hostname    = \"mapit-2\"\n\t\t186 |     aws_migration   = \"mapit\"\n\t\t187 |     aws_stackname   = \"${var.stackname}\"\n\t\t188 |     aws_environment = \"${var.aws_environment}\"\n\t\t189 |   }\n\t\t190 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mirrorer\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mirrorer/main.tf:71-85\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t71 | resource \"aws_ebs_volume\" \"mirrorer\" {\n\t\t72 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mirrorer_subnet)}\"\n\t\t73 |   size              = 100\n\t\t74 |   type              = \"gp2\"\n\t\t75 | \n\t\t76 |   tags {\n\t\t77 |     Name            = \"${var.stackname}-mirrorer\"\n\t\t78 |     Project         = \"${var.stackname}\"\n\t\t79 |     Device          = \"xvdf\"\n\t\t80 |     aws_hostname    = \"mirrorer-1\"\n\t\t81 |     aws_migration   = \"mirrorer\"\n\t\t82 |     aws_stackname   = \"${var.stackname}\"\n\t\t83 |     aws_environment = \"${var.aws_environment}\"\n\t\t84 |   }\n\t\t85 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.rummager-elasticsearch-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-rummager-elasticsearch/main.tf:160-174\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t160 | resource \"aws_ebs_volume\" \"rummager-elasticsearch-1\" {\n\t\t161 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.rummager_elasticsearch_1_subnet)}\"\n\t\t162 |   size              = 100\n\t\t163 |   type              = \"gp2\"\n\t\t164 | \n\t\t165 |   tags {\n\t\t166 |     Name            = \"${var.stackname}-rummager-elasticsearch-1\"\n\t\t167 |     Project         = \"${var.stackname}\"\n\t\t168 |     aws_stackname   = \"${var.stackname}\"\n\t\t169 |     aws_environment = \"${var.aws_environment}\"\n\t\t170 |     aws_migration   = \"rummager_elasticsearch\"\n\t\t171 |     aws_hostname    = \"rummager-elasticsearch-1\"\n\t\t172 |     Device          = \"xvdf\"\n\t\t173 |   }\n\t\t174 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.rummager-elasticsearch-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-rummager-elasticsearch/main.tf:194-208\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t194 | resource \"aws_ebs_volume\" \"rummager-elasticsearch-2\" {\n\t\t195 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.rummager_elasticsearch_2_subnet)}\"\n\t\t196 |   size              = 100\n\t\t197 |   type              = \"gp2\"\n\t\t198 | \n\t\t199 |   tags {\n\t\t200 |     Name            = \"${var.stackname}-rummager-elasticsearch-2\"\n\t\t201 |     Project         = \"${var.stackname}\"\n\t\t202 |     aws_stackname   = \"${var.stackname}\"\n\t\t203 |     aws_environment = \"${var.aws_environment}\"\n\t\t204 |     aws_migration   = \"rummager_elasticsearch\"\n\t\t205 |     aws_hostname    = \"rummager-elasticsearch-2\"\n\t\t206 |     Device          = \"xvdf\"\n\t\t207 |   }\n\t\t208 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.rummager-elasticsearch-3\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-rummager-elasticsearch/main.tf:228-242\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t228 | resource \"aws_ebs_volume\" \"rummager-elasticsearch-3\" {\n\t\t229 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.rummager_elasticsearch_3_subnet)}\"\n\t\t230 |   size              = 100\n\t\t231 |   type              = \"gp2\"\n\t\t232 | \n\t\t233 |   tags {\n\t\t234 |     Name            = \"${var.stackname}-rummager-elasticsearch-3\"\n\t\t235 |     Project         = \"${var.stackname}\"\n\t\t236 |     aws_stackname   = \"${var.stackname}\"\n\t\t237 |     aws_environment = \"${var.aws_environment}\"\n\t\t238 |     aws_migration   = \"rummager_elasticsearch\"\n\t\t239 |     aws_hostname    = \"rummager-elasticsearch-3\"\n\t\t240 |     Device          = \"xvdf\"\n\t\t241 |   }\n\t\t242 | }\n\n\n",
      "stderr": "",
      "duration_seconds": 27.242720918002306
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/alphagov/govuk-aws/commit/5fa5da9756f12559b490217dd5b173db48e7f2a9",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 9, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.graphite-1\n\tFile: /terraform/projects/app-graphite/main.tf:206-221\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.apt\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-apt/main.tf:140-154\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t140 | resource \"aws_ebs_volume\" \"apt\" {\n\t\t141 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.apt_1_subnet)}\"\n\t\t142 |   size              = 40\n\t\t143 |   type              = \"gp2\"\n\t\t144 | \n\t\t145 |   tags {\n\t\t146 |     Name            = \"${var.stackname}-apt\"\n\t\t147 |     Project         = \"${var.stackname}\"\n\t\t148 |     Device          = \"xvdf\"\n\t\t149 |     aws_hostname    = \"apt-1\"\n\t\t150 |     aws_migration   = \"apt\"\n\t\t151 |     aws_stackname   = \"${var.stackname}\"\n\t\t152 |     aws_environment = \"${var.aws_environment}\"\n\t\t153 |   }\n\t\t154 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.deploy\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-deploy/main.tf:198-212\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t198 | resource \"aws_ebs_volume\" \"deploy\" {\n\t\t199 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.deploy_subnet)}\"\n\t\t200 |   size              = 40\n\t\t201 |   type              = \"gp2\"\n\t\t202 | \n\t\t203 |   tags {\n\t\t204 |     Name            = \"${var.stackname}-deploy\"\n\t\t205 |     Project         = \"${var.stackname}\"\n\t\t206 |     Device          = \"xvdf\"\n\t\t207 |     aws_hostname    = \"jenkins-1\"\n\t\t208 |     aws_migration   = \"jenkins\"\n\t\t209 |     aws_stackname   = \"${var.stackname}\"\n\t\t210 |     aws_environment = \"${var.aws_environment}\"\n\t\t211 |   }\n\t\t212 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.logs-cdn\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-logs-cdn/main.tf:124-138\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t124 | resource \"aws_ebs_volume\" \"logs-cdn\" {\n\t\t125 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.logs_cdn_subnet)}\"\n\t\t126 |   size              = 500\n\t\t127 |   type              = \"gp2\"\n\t\t128 | \n\t\t129 |   tags {\n\t\t130 |     Name            = \"${var.stackname}-logs-cdn\"\n\t\t131 |     Project         = \"${var.stackname}\"\n\t\t132 |     aws_stackname   = \"${var.stackname}\"\n\t\t133 |     aws_environment = \"${var.aws_environment}\"\n\t\t134 |     aws_migration   = \"logs_cdn\"\n\t\t135 |     aws_hostname    = \"logs-cdn-1\"\n\t\t136 |     Device          = \"xvdf\"\n\t\t137 |   }\n\t\t138 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mapit-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mapit/main.tf:132-146\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t132 | resource \"aws_ebs_volume\" \"mapit-1\" {\n\t\t133 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mapit_1_subnet)}\"\n\t\t134 |   size              = 20\n\t\t135 |   type              = \"gp2\"\n\t\t136 | \n\t\t137 |   tags {\n\t\t138 |     Name            = \"${var.stackname}-mapit\"\n\t\t139 |     Project         = \"${var.stackname}\"\n\t\t140 |     Device          = \"xvdf\"\n\t\t141 |     aws_hostname    = \"mapit-1\"\n\t\t142 |     aws_migration   = \"mapit\"\n\t\t143 |     aws_stackname   = \"${var.stackname}\"\n\t\t144 |     aws_environment = \"${var.aws_environment}\"\n\t\t145 |   }\n\t\t146 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mapit-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mapit/main.tf:164-178\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t164 | resource \"aws_ebs_volume\" \"mapit-2\" {\n\t\t165 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mapit_2_subnet)}\"\n\t\t166 |   size              = 20\n\t\t167 |   type              = \"gp2\"\n\t\t168 | \n\t\t169 |   tags {\n\t\t170 |     Name            = \"${var.stackname}-mapit\"\n\t\t171 |     Project         = \"${var.stackname}\"\n\t\t172 |     Device          = \"xvdf\"\n\t\t173 |     aws_hostname    = \"mapit-2\"\n\t\t174 |     aws_migration   = \"mapit\"\n\t\t175 |     aws_stackname   = \"${var.stackname}\"\n\t\t176 |     aws_environment = \"${var.aws_environment}\"\n\t\t177 |   }\n\t\t178 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mirrorer\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mirrorer/main.tf:64-78\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t64 | resource \"aws_ebs_volume\" \"mirrorer\" {\n\t\t65 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mirrorer_subnet)}\"\n\t\t66 |   size              = 100\n\t\t67 |   type              = \"gp2\"\n\t\t68 | \n\t\t69 |   tags {\n\t\t70 |     Name            = \"${var.stackname}-mirrorer\"\n\t\t71 |     Project         = \"${var.stackname}\"\n\t\t72 |     Device          = \"xvdf\"\n\t\t73 |     aws_hostname    = \"mirrorer-1\"\n\t\t74 |     aws_migration   = \"mirrorer\"\n\t\t75 |     aws_stackname   = \"${var.stackname}\"\n\t\t76 |     aws_environment = \"${var.aws_environment}\"\n\t\t77 |   }\n\t\t78 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.rummager-elasticsearch-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-rummager-elasticsearch/main.tf:149-163\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t149 | resource \"aws_ebs_volume\" \"rummager-elasticsearch-1\" {\n\t\t150 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.rummager_elasticsearch_1_subnet)}\"\n\t\t151 |   size              = 100\n\t\t152 |   type              = \"gp2\"\n\t\t153 | \n\t\t154 |   tags {\n\t\t155 |     Name            = \"${var.stackname}-rummager-elasticsearch-1\"\n\t\t156 |     Project         = \"${var.stackname}\"\n\t\t157 |     aws_stackname   = \"${var.stackname}\"\n\t\t158 |     aws_environment = \"${var.aws_environment}\"\n\t\t159 |     aws_migration   = \"rummager_elasticsearch\"\n\t\t160 |     aws_hostname    = \"rummager-elasticsearch-1\"\n\t\t161 |     Device          = \"xvdf\"\n\t\t162 |   }\n\t\t163 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.rummager-elasticsearch-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-rummager-elasticsearch/main.tf:182-196\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t182 | resource \"aws_ebs_volume\" \"rummager-elasticsearch-2\" {\n\t\t183 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.rummager_elasticsearch_2_subnet)}\"\n\t\t184 |   size              = 100\n\t\t185 |   type              = \"gp2\"\n\t\t186 | \n\t\t187 |   tags {\n\t\t188 |     Name            = \"${var.stackname}-rummager-elasticsearch-2\"\n\t\t189 |     Project         = \"${var.stackname}\"\n\t\t190 |     aws_stackname   = \"${var.stackname}\"\n\t\t191 |     aws_environment = \"${var.aws_environment}\"\n\t\t192 |     aws_migration   = \"rummager_elasticsearch\"\n\t\t193 |     aws_hostname    = \"rummager-elasticsearch-2\"\n\t\t194 |     Device          = \"xvdf\"\n\t\t195 |   }\n\t\t196 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.rummager-elasticsearch-3\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-rummager-elasticsearch/main.tf:215-229\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t215 | resource \"aws_ebs_volume\" \"rummager-elasticsearch-3\" {\n\t\t216 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.rummager_elasticsearch_3_subnet)}\"\n\t\t217 |   size              = 100\n\t\t218 |   type              = \"gp2\"\n\t\t219 | \n\t\t220 |   tags {\n\t\t221 |     Name            = \"${var.stackname}-rummager-elasticsearch-3\"\n\t\t222 |     Project         = \"${var.stackname}\"\n\t\t223 |     aws_stackname   = \"${var.stackname}\"\n\t\t224 |     aws_environment = \"${var.aws_environment}\"\n\t\t225 |     aws_migration   = \"rummager_elasticsearch\"\n\t\t226 |     aws_hostname    = \"rummager-elasticsearch-3\"\n\t\t227 |     Device          = \"xvdf\"\n\t\t228 |   }\n\t\t229 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 25.533832032000646
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 9, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.graphite-1\n\tFile: /terraform/projects/app-graphite/main.tf:206-221\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.apt\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-apt/main.tf:140-154\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t140 | resource \"aws_ebs_volume\" \"apt\" {\n\t\t141 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.apt_1_subnet)}\"\n\t\t142 |   size              = 40\n\t\t143 |   type              = \"gp2\"\n\t\t144 | \n\t\t145 |   tags {\n\t\t146 |     Name            = \"${var.stackname}-apt\"\n\t\t147 |     Project         = \"${var.stackname}\"\n\t\t148 |     Device          = \"xvdf\"\n\t\t149 |     aws_hostname    = \"apt-1\"\n\t\t150 |     aws_migration   = \"apt\"\n\t\t151 |     aws_stackname   = \"${var.stackname}\"\n\t\t152 |     aws_environment = \"${var.aws_environment}\"\n\t\t153 |   }\n\t\t154 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.deploy\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-deploy/main.tf:198-212\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t198 | resource \"aws_ebs_volume\" \"deploy\" {\n\t\t199 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.deploy_subnet)}\"\n\t\t200 |   size              = 40\n\t\t201 |   type              = \"gp2\"\n\t\t202 | \n\t\t203 |   tags {\n\t\t204 |     Name            = \"${var.stackname}-deploy\"\n\t\t205 |     Project         = \"${var.stackname}\"\n\t\t206 |     Device          = \"xvdf\"\n\t\t207 |     aws_hostname    = \"jenkins-1\"\n\t\t208 |     aws_migration   = \"jenkins\"\n\t\t209 |     aws_stackname   = \"${var.stackname}\"\n\t\t210 |     aws_environment = \"${var.aws_environment}\"\n\t\t211 |   }\n\t\t212 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.logs-cdn\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-logs-cdn/main.tf:124-138\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t124 | resource \"aws_ebs_volume\" \"logs-cdn\" {\n\t\t125 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.logs_cdn_subnet)}\"\n\t\t126 |   size              = 500\n\t\t127 |   type              = \"gp2\"\n\t\t128 | \n\t\t129 |   tags {\n\t\t130 |     Name            = \"${var.stackname}-logs-cdn\"\n\t\t131 |     Project         = \"${var.stackname}\"\n\t\t132 |     aws_stackname   = \"${var.stackname}\"\n\t\t133 |     aws_environment = \"${var.aws_environment}\"\n\t\t134 |     aws_migration   = \"logs_cdn\"\n\t\t135 |     aws_hostname    = \"logs-cdn-1\"\n\t\t136 |     Device          = \"xvdf\"\n\t\t137 |   }\n\t\t138 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mapit-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mapit/main.tf:132-146\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t132 | resource \"aws_ebs_volume\" \"mapit-1\" {\n\t\t133 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mapit_1_subnet)}\"\n\t\t134 |   size              = 20\n\t\t135 |   type              = \"gp2\"\n\t\t136 | \n\t\t137 |   tags {\n\t\t138 |     Name            = \"${var.stackname}-mapit\"\n\t\t139 |     Project         = \"${var.stackname}\"\n\t\t140 |     Device          = \"xvdf\"\n\t\t141 |     aws_hostname    = \"mapit-1\"\n\t\t142 |     aws_migration   = \"mapit\"\n\t\t143 |     aws_stackname   = \"${var.stackname}\"\n\t\t144 |     aws_environment = \"${var.aws_environment}\"\n\t\t145 |   }\n\t\t146 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mapit-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mapit/main.tf:164-178\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t164 | resource \"aws_ebs_volume\" \"mapit-2\" {\n\t\t165 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mapit_2_subnet)}\"\n\t\t166 |   size              = 20\n\t\t167 |   type              = \"gp2\"\n\t\t168 | \n\t\t169 |   tags {\n\t\t170 |     Name            = \"${var.stackname}-mapit\"\n\t\t171 |     Project         = \"${var.stackname}\"\n\t\t172 |     Device          = \"xvdf\"\n\t\t173 |     aws_hostname    = \"mapit-2\"\n\t\t174 |     aws_migration   = \"mapit\"\n\t\t175 |     aws_stackname   = \"${var.stackname}\"\n\t\t176 |     aws_environment = \"${var.aws_environment}\"\n\t\t177 |   }\n\t\t178 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mirrorer\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mirrorer/main.tf:64-78\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t64 | resource \"aws_ebs_volume\" \"mirrorer\" {\n\t\t65 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mirrorer_subnet)}\"\n\t\t66 |   size              = 100\n\t\t67 |   type              = \"gp2\"\n\t\t68 | \n\t\t69 |   tags {\n\t\t70 |     Name            = \"${var.stackname}-mirrorer\"\n\t\t71 |     Project         = \"${var.stackname}\"\n\t\t72 |     Device          = \"xvdf\"\n\t\t73 |     aws_hostname    = \"mirrorer-1\"\n\t\t74 |     aws_migration   = \"mirrorer\"\n\t\t75 |     aws_stackname   = \"${var.stackname}\"\n\t\t76 |     aws_environment = \"${var.aws_environment}\"\n\t\t77 |   }\n\t\t78 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.rummager-elasticsearch-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-rummager-elasticsearch/main.tf:149-163\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t149 | resource \"aws_ebs_volume\" \"rummager-elasticsearch-1\" {\n\t\t150 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.rummager_elasticsearch_1_subnet)}\"\n\t\t151 |   size              = 100\n\t\t152 |   type              = \"gp2\"\n\t\t153 | \n\t\t154 |   tags {\n\t\t155 |     Name            = \"${var.stackname}-rummager-elasticsearch-1\"\n\t\t156 |     Project         = \"${var.stackname}\"\n\t\t157 |     aws_stackname   = \"${var.stackname}\"\n\t\t158 |     aws_environment = \"${var.aws_environment}\"\n\t\t159 |     aws_migration   = \"rummager_elasticsearch\"\n\t\t160 |     aws_hostname    = \"rummager-elasticsearch-1\"\n\t\t161 |     Device          = \"xvdf\"\n\t\t162 |   }\n\t\t163 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.rummager-elasticsearch-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-rummager-elasticsearch/main.tf:182-196\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t182 | resource \"aws_ebs_volume\" \"rummager-elasticsearch-2\" {\n\t\t183 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.rummager_elasticsearch_2_subnet)}\"\n\t\t184 |   size              = 100\n\t\t185 |   type              = \"gp2\"\n\t\t186 | \n\t\t187 |   tags {\n\t\t188 |     Name            = \"${var.stackname}-rummager-elasticsearch-2\"\n\t\t189 |     Project         = \"${var.stackname}\"\n\t\t190 |     aws_stackname   = \"${var.stackname}\"\n\t\t191 |     aws_environment = \"${var.aws_environment}\"\n\t\t192 |     aws_migration   = \"rummager_elasticsearch\"\n\t\t193 |     aws_hostname    = \"rummager-elasticsearch-2\"\n\t\t194 |     Device          = \"xvdf\"\n\t\t195 |   }\n\t\t196 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.rummager-elasticsearch-3\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-rummager-elasticsearch/main.tf:215-229\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t215 | resource \"aws_ebs_volume\" \"rummager-elasticsearch-3\" {\n\t\t216 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.rummager_elasticsearch_3_subnet)}\"\n\t\t217 |   size              = 100\n\t\t218 |   type              = \"gp2\"\n\t\t219 | \n\t\t220 |   tags {\n\t\t221 |     Name            = \"${var.stackname}-rummager-elasticsearch-3\"\n\t\t222 |     Project         = \"${var.stackname}\"\n\t\t223 |     aws_stackname   = \"${var.stackname}\"\n\t\t224 |     aws_environment = \"${var.aws_environment}\"\n\t\t225 |     aws_migration   = \"rummager_elasticsearch\"\n\t\t226 |     aws_hostname    = \"rummager-elasticsearch-3\"\n\t\t227 |     Device          = \"xvdf\"\n\t\t228 |   }\n\t\t229 | }\n\n\n",
      "stderr": "",
      "duration_seconds": 25.25630545000604
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/alphagov/govuk-aws/commit/19d187e4a29147cbcf1cfae456cfcbfa8ad52b45",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 20, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.graphite-1\n\tFile: /terraform/projects/app-graphite/main.tf:217-233\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.apt\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-apt/main.tf:147-162\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t147 | resource \"aws_ebs_volume\" \"apt\" {\n\t\t148 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.apt_1_subnet)}\"\n\t\t149 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t150 |   size              = 40\n\t\t151 |   type              = \"gp2\"\n\t\t152 | \n\t\t153 |   tags {\n\t\t154 |     Name            = \"${var.stackname}-apt\"\n\t\t155 |     Project         = \"${var.stackname}\"\n\t\t156 |     Device          = \"xvdf\"\n\t\t157 |     aws_hostname    = \"apt-1\"\n\t\t158 |     aws_migration   = \"apt\"\n\t\t159 |     aws_stackname   = \"${var.stackname}\"\n\t\t160 |     aws_environment = \"${var.aws_environment}\"\n\t\t161 |   }\n\t\t162 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ckan\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ckan/main.tf:207-223\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t207 | resource \"aws_ebs_volume\" \"ckan\" {\n\t\t208 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ckan_subnet)}\"\n\t\t209 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t210 |   type              = \"gp2\"\n\t\t211 |   size              = 20\n\t\t212 | \n\t\t213 |   tags {\n\t\t214 |     Name            = \"${var.stackname}-ckan\"\n\t\t215 |     Project         = \"${var.stackname}\"\n\t\t216 |     ManagedBy       = \"terraform\"\n\t\t217 |     aws_stackname   = \"${var.stackname}\"\n\t\t218 |     aws_environment = \"${var.aws_environment}\"\n\t\t219 |     aws_migration   = \"ckan\"\n\t\t220 |     aws_hostname    = \"ckan-1\"\n\t\t221 |     Device          = \"xvdf\"\n\t\t222 |   }\n\t\t223 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.deploy\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-deploy/main.tf:203-218\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t203 | resource \"aws_ebs_volume\" \"deploy\" {\n\t\t204 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.deploy_subnet)}\"\n\t\t205 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t206 |   size              = 40\n\t\t207 |   type              = \"gp2\"\n\t\t208 | \n\t\t209 |   tags {\n\t\t210 |     Name            = \"${var.stackname}-deploy\"\n\t\t211 |     Project         = \"${var.stackname}\"\n\t\t212 |     Device          = \"xvdf\"\n\t\t213 |     aws_hostname    = \"jenkins-1\"\n\t\t214 |     aws_migration   = \"jenkins\"\n\t\t215 |     aws_stackname   = \"${var.stackname}\"\n\t\t216 |     aws_environment = \"${var.aws_environment}\"\n\t\t217 |   }\n\t\t218 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.elasticsearch5-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-elasticsearch5/main.tf:154-169\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t154 | resource \"aws_ebs_volume\" \"elasticsearch5-1\" {\n\t\t155 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.elasticsearch5_1_subnet)}\"\n\t\t156 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t157 |   size              = 100\n\t\t158 |   type              = \"gp2\"\n\t\t159 | \n\t\t160 |   tags {\n\t\t161 |     Name            = \"${var.stackname}-elasticsearch5-1\"\n\t\t162 |     Project         = \"${var.stackname}\"\n\t\t163 |     aws_stackname   = \"${var.stackname}\"\n\t\t164 |     aws_environment = \"${var.aws_environment}\"\n\t\t165 |     aws_migration   = \"elasticsearch5\"\n\t\t166 |     aws_hostname    = \"elasticsearch5-1\"\n\t\t167 |     Device          = \"xvdf\"\n\t\t168 |   }\n\t\t169 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.elasticsearch5-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-elasticsearch5/main.tf:188-203\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t188 | resource \"aws_ebs_volume\" \"elasticsearch5-2\" {\n\t\t189 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.elasticsearch5_2_subnet)}\"\n\t\t190 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t191 |   size              = 100\n\t\t192 |   type              = \"gp2\"\n\t\t193 | \n\t\t194 |   tags {\n\t\t195 |     Name            = \"${var.stackname}-elasticsearch5-2\"\n\t\t196 |     Project         = \"${var.stackname}\"\n\t\t197 |     aws_stackname   = \"${var.stackname}\"\n\t\t198 |     aws_environment = \"${var.aws_environment}\"\n\t\t199 |     aws_migration   = \"elasticsearch5\"\n\t\t200 |     aws_hostname    = \"elasticsearch5-2\"\n\t\t201 |     Device          = \"xvdf\"\n\t\t202 |   }\n\t\t203 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.elasticsearch5-3\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-elasticsearch5/main.tf:222-237\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t222 | resource \"aws_ebs_volume\" \"elasticsearch5-3\" {\n\t\t223 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.elasticsearch5_3_subnet)}\"\n\t\t224 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t225 |   size              = 100\n\t\t226 |   type              = \"gp2\"\n\t\t227 | \n\t\t228 |   tags {\n\t\t229 |     Name            = \"${var.stackname}-elasticsearch5-3\"\n\t\t230 |     Project         = \"${var.stackname}\"\n\t\t231 |     aws_stackname   = \"${var.stackname}\"\n\t\t232 |     aws_environment = \"${var.aws_environment}\"\n\t\t233 |     aws_migration   = \"elasticsearch5\"\n\t\t234 |     aws_hostname    = \"elasticsearch5-3\"\n\t\t235 |     Device          = \"xvdf\"\n\t\t236 |   }\n\t\t237 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mapit-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mapit/main.tf:137-152\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t137 | resource \"aws_ebs_volume\" \"mapit-1\" {\n\t\t138 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mapit_1_subnet)}\"\n\t\t139 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t140 |   size              = 20\n\t\t141 |   type              = \"gp2\"\n\t\t142 | \n\t\t143 |   tags {\n\t\t144 |     Name            = \"${var.stackname}-mapit\"\n\t\t145 |     Project         = \"${var.stackname}\"\n\t\t146 |     Device          = \"xvdf\"\n\t\t147 |     aws_hostname    = \"mapit-1\"\n\t\t148 |     aws_migration   = \"mapit\"\n\t\t149 |     aws_stackname   = \"${var.stackname}\"\n\t\t150 |     aws_environment = \"${var.aws_environment}\"\n\t\t151 |   }\n\t\t152 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mapit-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mapit/main.tf:170-185\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t170 | resource \"aws_ebs_volume\" \"mapit-2\" {\n\t\t171 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mapit_2_subnet)}\"\n\t\t172 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t173 |   size              = 20\n\t\t174 |   type              = \"gp2\"\n\t\t175 | \n\t\t176 |   tags {\n\t\t177 |     Name            = \"${var.stackname}-mapit\"\n\t\t178 |     Project         = \"${var.stackname}\"\n\t\t179 |     Device          = \"xvdf\"\n\t\t180 |     aws_hostname    = \"mapit-2\"\n\t\t181 |     aws_migration   = \"mapit\"\n\t\t182 |     aws_stackname   = \"${var.stackname}\"\n\t\t183 |     aws_environment = \"${var.aws_environment}\"\n\t\t184 |   }\n\t\t185 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mirrorer\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mirrorer/main.tf:75-90\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t75 | resource \"aws_ebs_volume\" \"mirrorer\" {\n\t\t76 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mirrorer_subnet)}\"\n\t\t77 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t78 |   size              = 100\n\t\t79 |   type              = \"gp2\"\n\t\t80 | \n\t\t81 |   tags {\n\t\t82 |     Name            = \"${var.stackname}-mirrorer\"\n\t\t83 |     Project         = \"${var.stackname}\"\n\t\t84 |     Device          = \"xvdf\"\n\t\t85 |     aws_hostname    = \"mirrorer-1\"\n\t\t86 |     aws_migration   = \"mirrorer\"\n\t\t87 |     aws_stackname   = \"${var.stackname}\"\n\t\t88 |     aws_environment = \"${var.aws_environment}\"\n\t\t89 |   }\n\t\t90 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mongo-api-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mongo-api/main.tf:136-152\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t136 | resource \"aws_ebs_volume\" \"mongo-api-1\" {\n\t\t137 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mongo_1_subnet)}\"\n\t\t138 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t139 |   type              = \"gp2\"\n\t\t140 |   size              = 300\n\t\t141 | \n\t\t142 |   tags {\n\t\t143 |     Name            = \"${var.stackname}-mongo-api-1\"\n\t\t144 |     Project         = \"${var.stackname}\"\n\t\t145 |     ManagedBy       = \"terraform\"\n\t\t146 |     aws_stackname   = \"${var.stackname}\"\n\t\t147 |     aws_environment = \"${var.aws_environment}\"\n\t\t148 |     aws_migration   = \"mongo_api\"\n\t\t149 |     aws_hostname    = \"mongo-api-1\"\n\t\t150 |     Device          = \"xvdf\"\n\t\t151 |   }\n\t\t152 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mongo-api-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mongo-api/main.tf:194-210\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t194 | resource \"aws_ebs_volume\" \"mongo-api-2\" {\n\t\t195 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mongo_2_subnet)}\"\n\t\t196 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t197 |   type              = \"gp2\"\n\t\t198 |   size              = 300\n\t\t199 | \n\t\t200 |   tags {\n\t\t201 |     Name            = \"${var.stackname}-mongo-api-2\"\n\t\t202 |     Project         = \"${var.stackname}\"\n\t\t203 |     ManagedBy       = \"terraform\"\n\t\t204 |     aws_stackname   = \"${var.stackname}\"\n\t\t205 |     aws_environment = \"${var.aws_environment}\"\n\t\t206 |     aws_migration   = \"mongo_api\"\n\t\t207 |     aws_hostname    = \"mongo-api-2\"\n\t\t208 |     Device          = \"xvdf\"\n\t\t209 |   }\n\t\t210 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mongo-api-3\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mongo-api/main.tf:252-268\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t252 | resource \"aws_ebs_volume\" \"mongo-api-3\" {\n\t\t253 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mongo_3_subnet)}\"\n\t\t254 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t255 |   type              = \"gp2\"\n\t\t256 |   size              = 300\n\t\t257 | \n\t\t258 |   tags {\n\t\t259 |     Name            = \"${var.stackname}-mongo-api-3\"\n\t\t260 |     Project         = \"${var.stackname}\"\n\t\t261 |     ManagedBy       = \"terraform\"\n\t\t262 |     aws_stackname   = \"${var.stackname}\"\n\t\t263 |     aws_environment = \"${var.aws_environment}\"\n\t\t264 |     aws_migration   = \"mongo_api\"\n\t\t265 |     aws_hostname    = \"mongo-api-3\"\n\t\t266 |     Device          = \"xvdf\"\n\t\t267 |   }\n\t\t268 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mongo-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mongo/main.tf:136-152\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t136 | resource \"aws_ebs_volume\" \"mongo-1\" {\n\t\t137 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mongo_1_subnet)}\"\n\t\t138 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t139 |   type              = \"gp2\"\n\t\t140 |   size              = 300\n\t\t141 | \n\t\t142 |   tags {\n\t\t143 |     Name            = \"${var.stackname}-mongo-1\"\n\t\t144 |     Project         = \"${var.stackname}\"\n\t\t145 |     ManagedBy       = \"terraform\"\n\t\t146 |     aws_stackname   = \"${var.stackname}\"\n\t\t147 |     aws_environment = \"${var.aws_environment}\"\n\t\t148 |     aws_migration   = \"mongo\"\n\t\t149 |     aws_hostname    = \"mongo-1\"\n\t\t150 |     Device          = \"xvdf\"\n\t\t151 |   }\n\t\t152 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mongo-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mongo/main.tf:194-210\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t194 | resource \"aws_ebs_volume\" \"mongo-2\" {\n\t\t195 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mongo_2_subnet)}\"\n\t\t196 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t197 |   type              = \"gp2\"\n\t\t198 |   size              = 300\n\t\t199 | \n\t\t200 |   tags {\n\t\t201 |     Name            = \"${var.stackname}-mongo-2\"\n\t\t202 |     Project         = \"${var.stackname}\"\n\t\t203 |     ManagedBy       = \"terraform\"\n\t\t204 |     aws_stackname   = \"${var.stackname}\"\n\t\t205 |     aws_environment = \"${var.aws_environment}\"\n\t\t206 |     aws_migration   = \"mongo\"\n\t\t207 |     aws_hostname    = \"mongo-2\"\n\t\t208 |     Device          = \"xvdf\"\n\t\t209 |   }\n\t\t210 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mongo-3\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mongo/main.tf:252-268\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t252 | resource \"aws_ebs_volume\" \"mongo-3\" {\n\t\t253 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mongo_3_subnet)}\"\n\t\t254 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t255 |   type              = \"gp2\"\n\t\t256 |   size              = 300\n\t\t257 | \n\t\t258 |   tags {\n\t\t259 |     Name            = \"${var.stackname}-mongo-3\"\n\t\t260 |     Project         = \"${var.stackname}\"\n\t\t261 |     ManagedBy       = \"terraform\"\n\t\t262 |     aws_stackname   = \"${var.stackname}\"\n\t\t263 |     aws_environment = \"${var.aws_environment}\"\n\t\t264 |     aws_migration   = \"mongo\"\n\t\t265 |     aws_hostname    = \"mongo-3\"\n\t\t266 |     Device          = \"xvdf\"\n\t\t267 |   }\n\t\t268 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.monitoring\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-monitoring/main.tf:169-185\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t169 | resource \"aws_ebs_volume\" \"monitoring\" {\n\t\t170 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.monitoring_subnet)}\"\n\t\t171 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t172 |   type              = \"gp2\"\n\t\t173 |   size              = 20\n\t\t174 | \n\t\t175 |   tags {\n\t\t176 |     Name            = \"${var.stackname}-monitoring\"\n\t\t177 |     Project         = \"${var.stackname}\"\n\t\t178 |     ManagedBy       = \"terraform\"\n\t\t179 |     aws_stackname   = \"${var.stackname}\"\n\t\t180 |     aws_environment = \"${var.aws_environment}\"\n\t\t181 |     aws_migration   = \"monitoring\"\n\t\t182 |     aws_hostname    = \"monitoring-1\"\n\t\t183 |     Device          = \"xvdf\"\n\t\t184 |   }\n\t\t185 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.prometheus-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-prometheus/main.tf:64-78\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t64 | resource \"aws_ebs_volume\" \"prometheus-1\" {\n\t\t65 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.prometheus_1_subnet)}\"\n\t\t66 |   size              = 64\n\t\t67 |   type              = \"gp2\"\n\t\t68 | \n\t\t69 |   tags {\n\t\t70 |     Name            = \"${var.stackname}-prometheus-1\"\n\t\t71 |     Project         = \"${var.stackname}\"\n\t\t72 |     Device          = \"xvdf\"\n\t\t73 |     aws_stackname   = \"${var.stackname}\"\n\t\t74 |     aws_environment = \"${var.aws_environment}\"\n\t\t75 |     aws_migration   = \"prometheus\"\n\t\t76 |     aws_hostname    = \"prometheus-1\"\n\t\t77 |   }\n\t\t78 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.rummager-elasticsearch-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-rummager-elasticsearch/main.tf:154-169\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t154 | resource \"aws_ebs_volume\" \"rummager-elasticsearch-1\" {\n\t\t155 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.rummager_elasticsearch_1_subnet)}\"\n\t\t156 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t157 |   size              = 100\n\t\t158 |   type              = \"gp2\"\n\t\t159 | \n\t\t160 |   tags {\n\t\t161 |     Name            = \"${var.stackname}-rummager-elasticsearch-1\"\n\t\t162 |     Project         = \"${var.stackname}\"\n\t\t163 |     aws_stackname   = \"${var.stackname}\"\n\t\t164 |     aws_environment = \"${var.aws_environment}\"\n\t\t165 |     aws_migration   = \"rummager_elasticsearch\"\n\t\t166 |     aws_hostname    = \"rummager-elasticsearch-1\"\n\t\t167 |     Device          = \"xvdf\"\n\t\t168 |   }\n\t\t169 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.rummager-elasticsearch-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-rummager-elasticsearch/main.tf:188-203\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t188 | resource \"aws_ebs_volume\" \"rummager-elasticsearch-2\" {\n\t\t189 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.rummager_elasticsearch_2_subnet)}\"\n\t\t190 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t191 |   size              = 100\n\t\t192 |   type              = \"gp2\"\n\t\t193 | \n\t\t194 |   tags {\n\t\t195 |     Name            = \"${var.stackname}-rummager-elasticsearch-2\"\n\t\t196 |     Project         = \"${var.stackname}\"\n\t\t197 |     aws_stackname   = \"${var.stackname}\"\n\t\t198 |     aws_environment = \"${var.aws_environment}\"\n\t\t199 |     aws_migration   = \"rummager_elasticsearch\"\n\t\t200 |     aws_hostname    = \"rummager-elasticsearch-2\"\n\t\t201 |     Device          = \"xvdf\"\n\t\t202 |   }\n\t\t203 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.rummager-elasticsearch-3\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-rummager-elasticsearch/main.tf:222-237\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t222 | resource \"aws_ebs_volume\" \"rummager-elasticsearch-3\" {\n\t\t223 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.rummager_elasticsearch_3_subnet)}\"\n\t\t224 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t225 |   size              = 100\n\t\t226 |   type              = \"gp2\"\n\t\t227 | \n\t\t228 |   tags {\n\t\t229 |     Name            = \"${var.stackname}-rummager-elasticsearch-3\"\n\t\t230 |     Project         = \"${var.stackname}\"\n\t\t231 |     aws_stackname   = \"${var.stackname}\"\n\t\t232 |     aws_environment = \"${var.aws_environment}\"\n\t\t233 |     aws_migration   = \"rummager_elasticsearch\"\n\t\t234 |     aws_hostname    = \"rummager-elasticsearch-3\"\n\t\t235 |     Device          = \"xvdf\"\n\t\t236 |   }\n\t\t237 | }\n\n\n",
        "stderr": "2024-06-21 12:16:23,607 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/alphagov/csw-client-role.git:None (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 40.55200691799109
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 20, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.graphite-1\n\tFile: /terraform/projects/app-graphite/main.tf:217-233\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.apt\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-apt/main.tf:147-162\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t147 | resource \"aws_ebs_volume\" \"apt\" {\n\t\t148 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.apt_1_subnet)}\"\n\t\t149 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t150 |   size              = 40\n\t\t151 |   type              = \"gp2\"\n\t\t152 | \n\t\t153 |   tags {\n\t\t154 |     Name            = \"${var.stackname}-apt\"\n\t\t155 |     Project         = \"${var.stackname}\"\n\t\t156 |     Device          = \"xvdf\"\n\t\t157 |     aws_hostname    = \"apt-1\"\n\t\t158 |     aws_migration   = \"apt\"\n\t\t159 |     aws_stackname   = \"${var.stackname}\"\n\t\t160 |     aws_environment = \"${var.aws_environment}\"\n\t\t161 |   }\n\t\t162 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ckan\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ckan/main.tf:207-223\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t207 | resource \"aws_ebs_volume\" \"ckan\" {\n\t\t208 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ckan_subnet)}\"\n\t\t209 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t210 |   type              = \"gp2\"\n\t\t211 |   size              = 20\n\t\t212 | \n\t\t213 |   tags {\n\t\t214 |     Name            = \"${var.stackname}-ckan\"\n\t\t215 |     Project         = \"${var.stackname}\"\n\t\t216 |     ManagedBy       = \"terraform\"\n\t\t217 |     aws_stackname   = \"${var.stackname}\"\n\t\t218 |     aws_environment = \"${var.aws_environment}\"\n\t\t219 |     aws_migration   = \"ckan\"\n\t\t220 |     aws_hostname    = \"ckan-1\"\n\t\t221 |     Device          = \"xvdf\"\n\t\t222 |   }\n\t\t223 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.deploy\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-deploy/main.tf:203-218\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t203 | resource \"aws_ebs_volume\" \"deploy\" {\n\t\t204 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.deploy_subnet)}\"\n\t\t205 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t206 |   size              = 40\n\t\t207 |   type              = \"gp2\"\n\t\t208 | \n\t\t209 |   tags {\n\t\t210 |     Name            = \"${var.stackname}-deploy\"\n\t\t211 |     Project         = \"${var.stackname}\"\n\t\t212 |     Device          = \"xvdf\"\n\t\t213 |     aws_hostname    = \"jenkins-1\"\n\t\t214 |     aws_migration   = \"jenkins\"\n\t\t215 |     aws_stackname   = \"${var.stackname}\"\n\t\t216 |     aws_environment = \"${var.aws_environment}\"\n\t\t217 |   }\n\t\t218 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.elasticsearch5-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-elasticsearch5/main.tf:154-169\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t154 | resource \"aws_ebs_volume\" \"elasticsearch5-1\" {\n\t\t155 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.elasticsearch5_1_subnet)}\"\n\t\t156 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t157 |   size              = 100\n\t\t158 |   type              = \"gp2\"\n\t\t159 | \n\t\t160 |   tags {\n\t\t161 |     Name            = \"${var.stackname}-elasticsearch5-1\"\n\t\t162 |     Project         = \"${var.stackname}\"\n\t\t163 |     aws_stackname   = \"${var.stackname}\"\n\t\t164 |     aws_environment = \"${var.aws_environment}\"\n\t\t165 |     aws_migration   = \"elasticsearch5\"\n\t\t166 |     aws_hostname    = \"elasticsearch5-1\"\n\t\t167 |     Device          = \"xvdf\"\n\t\t168 |   }\n\t\t169 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.elasticsearch5-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-elasticsearch5/main.tf:188-203\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t188 | resource \"aws_ebs_volume\" \"elasticsearch5-2\" {\n\t\t189 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.elasticsearch5_2_subnet)}\"\n\t\t190 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t191 |   size              = 100\n\t\t192 |   type              = \"gp2\"\n\t\t193 | \n\t\t194 |   tags {\n\t\t195 |     Name            = \"${var.stackname}-elasticsearch5-2\"\n\t\t196 |     Project         = \"${var.stackname}\"\n\t\t197 |     aws_stackname   = \"${var.stackname}\"\n\t\t198 |     aws_environment = \"${var.aws_environment}\"\n\t\t199 |     aws_migration   = \"elasticsearch5\"\n\t\t200 |     aws_hostname    = \"elasticsearch5-2\"\n\t\t201 |     Device          = \"xvdf\"\n\t\t202 |   }\n\t\t203 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.elasticsearch5-3\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-elasticsearch5/main.tf:222-237\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t222 | resource \"aws_ebs_volume\" \"elasticsearch5-3\" {\n\t\t223 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.elasticsearch5_3_subnet)}\"\n\t\t224 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t225 |   size              = 100\n\t\t226 |   type              = \"gp2\"\n\t\t227 | \n\t\t228 |   tags {\n\t\t229 |     Name            = \"${var.stackname}-elasticsearch5-3\"\n\t\t230 |     Project         = \"${var.stackname}\"\n\t\t231 |     aws_stackname   = \"${var.stackname}\"\n\t\t232 |     aws_environment = \"${var.aws_environment}\"\n\t\t233 |     aws_migration   = \"elasticsearch5\"\n\t\t234 |     aws_hostname    = \"elasticsearch5-3\"\n\t\t235 |     Device          = \"xvdf\"\n\t\t236 |   }\n\t\t237 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mapit-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mapit/main.tf:137-152\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t137 | resource \"aws_ebs_volume\" \"mapit-1\" {\n\t\t138 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mapit_1_subnet)}\"\n\t\t139 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t140 |   size              = 20\n\t\t141 |   type              = \"gp2\"\n\t\t142 | \n\t\t143 |   tags {\n\t\t144 |     Name            = \"${var.stackname}-mapit\"\n\t\t145 |     Project         = \"${var.stackname}\"\n\t\t146 |     Device          = \"xvdf\"\n\t\t147 |     aws_hostname    = \"mapit-1\"\n\t\t148 |     aws_migration   = \"mapit\"\n\t\t149 |     aws_stackname   = \"${var.stackname}\"\n\t\t150 |     aws_environment = \"${var.aws_environment}\"\n\t\t151 |   }\n\t\t152 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mapit-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mapit/main.tf:170-185\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t170 | resource \"aws_ebs_volume\" \"mapit-2\" {\n\t\t171 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mapit_2_subnet)}\"\n\t\t172 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t173 |   size              = 20\n\t\t174 |   type              = \"gp2\"\n\t\t175 | \n\t\t176 |   tags {\n\t\t177 |     Name            = \"${var.stackname}-mapit\"\n\t\t178 |     Project         = \"${var.stackname}\"\n\t\t179 |     Device          = \"xvdf\"\n\t\t180 |     aws_hostname    = \"mapit-2\"\n\t\t181 |     aws_migration   = \"mapit\"\n\t\t182 |     aws_stackname   = \"${var.stackname}\"\n\t\t183 |     aws_environment = \"${var.aws_environment}\"\n\t\t184 |   }\n\t\t185 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mirrorer\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mirrorer/main.tf:75-90\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t75 | resource \"aws_ebs_volume\" \"mirrorer\" {\n\t\t76 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mirrorer_subnet)}\"\n\t\t77 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t78 |   size              = 100\n\t\t79 |   type              = \"gp2\"\n\t\t80 | \n\t\t81 |   tags {\n\t\t82 |     Name            = \"${var.stackname}-mirrorer\"\n\t\t83 |     Project         = \"${var.stackname}\"\n\t\t84 |     Device          = \"xvdf\"\n\t\t85 |     aws_hostname    = \"mirrorer-1\"\n\t\t86 |     aws_migration   = \"mirrorer\"\n\t\t87 |     aws_stackname   = \"${var.stackname}\"\n\t\t88 |     aws_environment = \"${var.aws_environment}\"\n\t\t89 |   }\n\t\t90 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mongo-api-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mongo-api/main.tf:136-152\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t136 | resource \"aws_ebs_volume\" \"mongo-api-1\" {\n\t\t137 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mongo_1_subnet)}\"\n\t\t138 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t139 |   type              = \"gp2\"\n\t\t140 |   size              = 300\n\t\t141 | \n\t\t142 |   tags {\n\t\t143 |     Name            = \"${var.stackname}-mongo-api-1\"\n\t\t144 |     Project         = \"${var.stackname}\"\n\t\t145 |     ManagedBy       = \"terraform\"\n\t\t146 |     aws_stackname   = \"${var.stackname}\"\n\t\t147 |     aws_environment = \"${var.aws_environment}\"\n\t\t148 |     aws_migration   = \"mongo_api\"\n\t\t149 |     aws_hostname    = \"mongo-api-1\"\n\t\t150 |     Device          = \"xvdf\"\n\t\t151 |   }\n\t\t152 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mongo-api-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mongo-api/main.tf:194-210\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t194 | resource \"aws_ebs_volume\" \"mongo-api-2\" {\n\t\t195 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mongo_2_subnet)}\"\n\t\t196 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t197 |   type              = \"gp2\"\n\t\t198 |   size              = 300\n\t\t199 | \n\t\t200 |   tags {\n\t\t201 |     Name            = \"${var.stackname}-mongo-api-2\"\n\t\t202 |     Project         = \"${var.stackname}\"\n\t\t203 |     ManagedBy       = \"terraform\"\n\t\t204 |     aws_stackname   = \"${var.stackname}\"\n\t\t205 |     aws_environment = \"${var.aws_environment}\"\n\t\t206 |     aws_migration   = \"mongo_api\"\n\t\t207 |     aws_hostname    = \"mongo-api-2\"\n\t\t208 |     Device          = \"xvdf\"\n\t\t209 |   }\n\t\t210 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mongo-api-3\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mongo-api/main.tf:252-268\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t252 | resource \"aws_ebs_volume\" \"mongo-api-3\" {\n\t\t253 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mongo_3_subnet)}\"\n\t\t254 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t255 |   type              = \"gp2\"\n\t\t256 |   size              = 300\n\t\t257 | \n\t\t258 |   tags {\n\t\t259 |     Name            = \"${var.stackname}-mongo-api-3\"\n\t\t260 |     Project         = \"${var.stackname}\"\n\t\t261 |     ManagedBy       = \"terraform\"\n\t\t262 |     aws_stackname   = \"${var.stackname}\"\n\t\t263 |     aws_environment = \"${var.aws_environment}\"\n\t\t264 |     aws_migration   = \"mongo_api\"\n\t\t265 |     aws_hostname    = \"mongo-api-3\"\n\t\t266 |     Device          = \"xvdf\"\n\t\t267 |   }\n\t\t268 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mongo-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mongo/main.tf:136-152\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t136 | resource \"aws_ebs_volume\" \"mongo-1\" {\n\t\t137 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mongo_1_subnet)}\"\n\t\t138 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t139 |   type              = \"gp2\"\n\t\t140 |   size              = 300\n\t\t141 | \n\t\t142 |   tags {\n\t\t143 |     Name            = \"${var.stackname}-mongo-1\"\n\t\t144 |     Project         = \"${var.stackname}\"\n\t\t145 |     ManagedBy       = \"terraform\"\n\t\t146 |     aws_stackname   = \"${var.stackname}\"\n\t\t147 |     aws_environment = \"${var.aws_environment}\"\n\t\t148 |     aws_migration   = \"mongo\"\n\t\t149 |     aws_hostname    = \"mongo-1\"\n\t\t150 |     Device          = \"xvdf\"\n\t\t151 |   }\n\t\t152 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mongo-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mongo/main.tf:194-210\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t194 | resource \"aws_ebs_volume\" \"mongo-2\" {\n\t\t195 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mongo_2_subnet)}\"\n\t\t196 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t197 |   type              = \"gp2\"\n\t\t198 |   size              = 300\n\t\t199 | \n\t\t200 |   tags {\n\t\t201 |     Name            = \"${var.stackname}-mongo-2\"\n\t\t202 |     Project         = \"${var.stackname}\"\n\t\t203 |     ManagedBy       = \"terraform\"\n\t\t204 |     aws_stackname   = \"${var.stackname}\"\n\t\t205 |     aws_environment = \"${var.aws_environment}\"\n\t\t206 |     aws_migration   = \"mongo\"\n\t\t207 |     aws_hostname    = \"mongo-2\"\n\t\t208 |     Device          = \"xvdf\"\n\t\t209 |   }\n\t\t210 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mongo-3\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mongo/main.tf:252-268\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t252 | resource \"aws_ebs_volume\" \"mongo-3\" {\n\t\t253 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mongo_3_subnet)}\"\n\t\t254 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t255 |   type              = \"gp2\"\n\t\t256 |   size              = 300\n\t\t257 | \n\t\t258 |   tags {\n\t\t259 |     Name            = \"${var.stackname}-mongo-3\"\n\t\t260 |     Project         = \"${var.stackname}\"\n\t\t261 |     ManagedBy       = \"terraform\"\n\t\t262 |     aws_stackname   = \"${var.stackname}\"\n\t\t263 |     aws_environment = \"${var.aws_environment}\"\n\t\t264 |     aws_migration   = \"mongo\"\n\t\t265 |     aws_hostname    = \"mongo-3\"\n\t\t266 |     Device          = \"xvdf\"\n\t\t267 |   }\n\t\t268 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.monitoring\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-monitoring/main.tf:169-185\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t169 | resource \"aws_ebs_volume\" \"monitoring\" {\n\t\t170 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.monitoring_subnet)}\"\n\t\t171 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t172 |   type              = \"gp2\"\n\t\t173 |   size              = 20\n\t\t174 | \n\t\t175 |   tags {\n\t\t176 |     Name            = \"${var.stackname}-monitoring\"\n\t\t177 |     Project         = \"${var.stackname}\"\n\t\t178 |     ManagedBy       = \"terraform\"\n\t\t179 |     aws_stackname   = \"${var.stackname}\"\n\t\t180 |     aws_environment = \"${var.aws_environment}\"\n\t\t181 |     aws_migration   = \"monitoring\"\n\t\t182 |     aws_hostname    = \"monitoring-1\"\n\t\t183 |     Device          = \"xvdf\"\n\t\t184 |   }\n\t\t185 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.prometheus-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-prometheus/main.tf:64-78\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t64 | resource \"aws_ebs_volume\" \"prometheus-1\" {\n\t\t65 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.prometheus_1_subnet)}\"\n\t\t66 |   size              = 64\n\t\t67 |   type              = \"gp2\"\n\t\t68 | \n\t\t69 |   tags {\n\t\t70 |     Name            = \"${var.stackname}-prometheus-1\"\n\t\t71 |     Project         = \"${var.stackname}\"\n\t\t72 |     Device          = \"xvdf\"\n\t\t73 |     aws_stackname   = \"${var.stackname}\"\n\t\t74 |     aws_environment = \"${var.aws_environment}\"\n\t\t75 |     aws_migration   = \"prometheus\"\n\t\t76 |     aws_hostname    = \"prometheus-1\"\n\t\t77 |   }\n\t\t78 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.rummager-elasticsearch-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-rummager-elasticsearch/main.tf:154-169\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t154 | resource \"aws_ebs_volume\" \"rummager-elasticsearch-1\" {\n\t\t155 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.rummager_elasticsearch_1_subnet)}\"\n\t\t156 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t157 |   size              = 100\n\t\t158 |   type              = \"gp2\"\n\t\t159 | \n\t\t160 |   tags {\n\t\t161 |     Name            = \"${var.stackname}-rummager-elasticsearch-1\"\n\t\t162 |     Project         = \"${var.stackname}\"\n\t\t163 |     aws_stackname   = \"${var.stackname}\"\n\t\t164 |     aws_environment = \"${var.aws_environment}\"\n\t\t165 |     aws_migration   = \"rummager_elasticsearch\"\n\t\t166 |     aws_hostname    = \"rummager-elasticsearch-1\"\n\t\t167 |     Device          = \"xvdf\"\n\t\t168 |   }\n\t\t169 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.rummager-elasticsearch-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-rummager-elasticsearch/main.tf:188-203\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t188 | resource \"aws_ebs_volume\" \"rummager-elasticsearch-2\" {\n\t\t189 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.rummager_elasticsearch_2_subnet)}\"\n\t\t190 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t191 |   size              = 100\n\t\t192 |   type              = \"gp2\"\n\t\t193 | \n\t\t194 |   tags {\n\t\t195 |     Name            = \"${var.stackname}-rummager-elasticsearch-2\"\n\t\t196 |     Project         = \"${var.stackname}\"\n\t\t197 |     aws_stackname   = \"${var.stackname}\"\n\t\t198 |     aws_environment = \"${var.aws_environment}\"\n\t\t199 |     aws_migration   = \"rummager_elasticsearch\"\n\t\t200 |     aws_hostname    = \"rummager-elasticsearch-2\"\n\t\t201 |     Device          = \"xvdf\"\n\t\t202 |   }\n\t\t203 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.rummager-elasticsearch-3\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-rummager-elasticsearch/main.tf:222-237\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t222 | resource \"aws_ebs_volume\" \"rummager-elasticsearch-3\" {\n\t\t223 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.rummager_elasticsearch_3_subnet)}\"\n\t\t224 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t225 |   size              = 100\n\t\t226 |   type              = \"gp2\"\n\t\t227 | \n\t\t228 |   tags {\n\t\t229 |     Name            = \"${var.stackname}-rummager-elasticsearch-3\"\n\t\t230 |     Project         = \"${var.stackname}\"\n\t\t231 |     aws_stackname   = \"${var.stackname}\"\n\t\t232 |     aws_environment = \"${var.aws_environment}\"\n\t\t233 |     aws_migration   = \"rummager_elasticsearch\"\n\t\t234 |     aws_hostname    = \"rummager-elasticsearch-3\"\n\t\t235 |     Device          = \"xvdf\"\n\t\t236 |   }\n\t\t237 | }\n\n\n",
      "stderr": "2024-06-21 12:15:46,771 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/alphagov/csw-client-role.git:None (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 38.55468686600216
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/alphagov/govuk-aws/commit/806b1a2a47f2f4e580e524b2cf8cc5928749d972",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 4, Failed checks: 27, Skipped checks: 0, Parsing errors: 1\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.ci-master\n\tFile: /terraform/projects/app-ci-master/main.tf:262-277\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.graphite-1\n\tFile: /terraform/projects/app-graphite/main.tf:286-302\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.mapit-3\n\tFile: /terraform/projects/app-mapit/main.tf:282-297\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.mapit-4\n\tFile: /terraform/projects/app-mapit/main.tf:318-333\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.apt\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-apt/main.tf:207-222\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t207 | resource \"aws_ebs_volume\" \"apt\" {\n\t\t208 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.apt_1_subnet)}\"\n\t\t209 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t210 |   size              = \"${var.ebs_volume_size}\"\n\t\t211 |   type              = \"gp2\"\n\t\t212 | \n\t\t213 |   tags {\n\t\t214 |     Name            = \"${var.stackname}-apt\"\n\t\t215 |     Project         = \"${var.stackname}\"\n\t\t216 |     Device          = \"xvdf\"\n\t\t217 |     aws_hostname    = \"apt-1\"\n\t\t218 |     aws_migration   = \"apt\"\n\t\t219 |     aws_stackname   = \"${var.stackname}\"\n\t\t220 |     aws_environment = \"${var.aws_environment}\"\n\t\t221 |   }\n\t\t222 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-1-data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:211-226\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t211 | resource \"aws_ebs_volume\" \"ci-agent-1-data\" {\n\t\t212 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_1_subnet)}\"\n\t\t213 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t214 |   size              = \"130\"\n\t\t215 |   type              = \"gp2\"\n\t\t216 | \n\t\t217 |   tags {\n\t\t218 |     Name            = \"${var.stackname}-ci-agent-1-data\"\n\t\t219 |     Project         = \"${var.stackname}\"\n\t\t220 |     Device          = \"xvdf\"\n\t\t221 |     aws_hostname    = \"ci-agent-1\"\n\t\t222 |     aws_migration   = \"ci_agent\"\n\t\t223 |     aws_stackname   = \"${var.stackname}\"\n\t\t224 |     aws_environment = \"${var.aws_environment}\"\n\t\t225 |   }\n\t\t226 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-1-docker\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:228-243\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t228 | resource \"aws_ebs_volume\" \"ci-agent-1-docker\" {\n\t\t229 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_1_subnet)}\"\n\t\t230 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t231 |   size              = \"130\"\n\t\t232 |   type              = \"gp2\"\n\t\t233 | \n\t\t234 |   tags {\n\t\t235 |     Name            = \"${var.stackname}-ci-agent-1-docker\"\n\t\t236 |     Project         = \"${var.stackname}\"\n\t\t237 |     Device          = \"xvdg\"\n\t\t238 |     aws_hostname    = \"ci-agent-1\"\n\t\t239 |     aws_migration   = \"ci_agent\"\n\t\t240 |     aws_stackname   = \"${var.stackname}\"\n\t\t241 |     aws_environment = \"${var.aws_environment}\"\n\t\t242 |   }\n\t\t243 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-2-data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:331-346\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t331 | resource \"aws_ebs_volume\" \"ci-agent-2-data\" {\n\t\t332 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_2_subnet)}\"\n\t\t333 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t334 |   size              = \"130\"\n\t\t335 |   type              = \"gp2\"\n\t\t336 | \n\t\t337 |   tags {\n\t\t338 |     Name            = \"${var.stackname}-ci-agent-2-data\"\n\t\t339 |     Project         = \"${var.stackname}\"\n\t\t340 |     Device          = \"xvdf\"\n\t\t341 |     aws_hostname    = \"ci-agent-2\"\n\t\t342 |     aws_migration   = \"ci_agent\"\n\t\t343 |     aws_stackname   = \"${var.stackname}\"\n\t\t344 |     aws_environment = \"${var.aws_environment}\"\n\t\t345 |   }\n\t\t346 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-2-docker\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:348-363\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t348 | resource \"aws_ebs_volume\" \"ci-agent-2-docker\" {\n\t\t349 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_2_subnet)}\"\n\t\t350 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t351 |   size              = \"130\"\n\t\t352 |   type              = \"gp2\"\n\t\t353 | \n\t\t354 |   tags {\n\t\t355 |     Name            = \"${var.stackname}-ci-agent-2-docker\"\n\t\t356 |     Project         = \"${var.stackname}\"\n\t\t357 |     Device          = \"xvdg\"\n\t\t358 |     aws_hostname    = \"ci-agent-2\"\n\t\t359 |     aws_migration   = \"ci_agent\"\n\t\t360 |     aws_stackname   = \"${var.stackname}\"\n\t\t361 |     aws_environment = \"${var.aws_environment}\"\n\t\t362 |   }\n\t\t363 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-3-data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:457-472\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t457 | resource \"aws_ebs_volume\" \"ci-agent-3-data\" {\n\t\t458 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_3_subnet)}\"\n\t\t459 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t460 |   size              = \"130\"\n\t\t461 |   type              = \"gp2\"\n\t\t462 | \n\t\t463 |   tags {\n\t\t464 |     Name            = \"${var.stackname}-ci-agent-3-data\"\n\t\t465 |     Project         = \"${var.stackname}\"\n\t\t466 |     Device          = \"xvdf\"\n\t\t467 |     aws_hostname    = \"ci-agent-3\"\n\t\t468 |     aws_migration   = \"ci_agent\"\n\t\t469 |     aws_stackname   = \"${var.stackname}\"\n\t\t470 |     aws_environment = \"${var.aws_environment}\"\n\t\t471 |   }\n\t\t472 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-3-docker\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:474-489\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t474 | resource \"aws_ebs_volume\" \"ci-agent-3-docker\" {\n\t\t475 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_3_subnet)}\"\n\t\t476 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t477 |   size              = \"130\"\n\t\t478 |   type              = \"gp2\"\n\t\t479 | \n\t\t480 |   tags {\n\t\t481 |     Name            = \"${var.stackname}-ci-agent-3-docker\"\n\t\t482 |     Project         = \"${var.stackname}\"\n\t\t483 |     Device          = \"xvdg\"\n\t\t484 |     aws_hostname    = \"ci-agent-3\"\n\t\t485 |     aws_migration   = \"ci_agent\"\n\t\t486 |     aws_stackname   = \"${var.stackname}\"\n\t\t487 |     aws_environment = \"${var.aws_environment}\"\n\t\t488 |   }\n\t\t489 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-4-data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:577-592\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t577 | resource \"aws_ebs_volume\" \"ci-agent-4-data\" {\n\t\t578 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_4_subnet)}\"\n\t\t579 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t580 |   size              = \"130\"\n\t\t581 |   type              = \"gp2\"\n\t\t582 | \n\t\t583 |   tags {\n\t\t584 |     Name            = \"${var.stackname}-ci-agent-4-data\"\n\t\t585 |     Project         = \"${var.stackname}\"\n\t\t586 |     Device          = \"xvdf\"\n\t\t587 |     aws_hostname    = \"ci-agent-4\"\n\t\t588 |     aws_migration   = \"ci_agent\"\n\t\t589 |     aws_stackname   = \"${var.stackname}\"\n\t\t590 |     aws_environment = \"${var.aws_environment}\"\n\t\t591 |   }\n\t\t592 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-4-docker\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:594-609\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t594 | resource \"aws_ebs_volume\" \"ci-agent-4-docker\" {\n\t\t595 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_4_subnet)}\"\n\t\t596 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t597 |   size              = \"130\"\n\t\t598 |   type              = \"gp2\"\n\t\t599 | \n\t\t600 |   tags {\n\t\t601 |     Name            = \"${var.stackname}-ci-agent-4-docker\"\n\t\t602 |     Project         = \"${var.stackname}\"\n\t\t603 |     Device          = \"xvdg\"\n\t\t604 |     aws_hostname    = \"ci-agent-4\"\n\t\t605 |     aws_migration   = \"ci_agent\"\n\t\t606 |     aws_stackname   = \"${var.stackname}\"\n\t\t607 |     aws_environment = \"${var.aws_environment}\"\n\t\t608 |   }\n\t\t609 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-5-data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:697-712\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t697 | resource \"aws_ebs_volume\" \"ci-agent-5-data\" {\n\t\t698 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_5_subnet)}\"\n\t\t699 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t700 |   size              = \"130\"\n\t\t701 |   type              = \"gp2\"\n\t\t702 | \n\t\t703 |   tags {\n\t\t704 |     Name            = \"${var.stackname}-ci-agent-5-data\"\n\t\t705 |     Project         = \"${var.stackname}\"\n\t\t706 |     Device          = \"xvdf\"\n\t\t707 |     aws_hostname    = \"ci-agent-5\"\n\t\t708 |     aws_migration   = \"ci_agent\"\n\t\t709 |     aws_stackname   = \"${var.stackname}\"\n\t\t710 |     aws_environment = \"${var.aws_environment}\"\n\t\t711 |   }\n\t\t712 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-5-docker\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:714-729\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t714 | resource \"aws_ebs_volume\" \"ci-agent-5-docker\" {\n\t\t715 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_5_subnet)}\"\n\t\t716 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t717 |   size              = \"130\"\n\t\t718 |   type              = \"gp2\"\n\t\t719 | \n\t\t720 |   tags {\n\t\t721 |     Name            = \"${var.stackname}-ci-agent-5-docker\"\n\t\t722 |     Project         = \"${var.stackname}\"\n\t\t723 |     Device          = \"xvdg\"\n\t\t724 |     aws_hostname    = \"ci-agent-5\"\n\t\t725 |     aws_migration   = \"ci_agent\"\n\t\t726 |     aws_stackname   = \"${var.stackname}\"\n\t\t727 |     aws_environment = \"${var.aws_environment}\"\n\t\t728 |   }\n\t\t729 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-6-data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:817-832\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t817 | resource \"aws_ebs_volume\" \"ci-agent-6-data\" {\n\t\t818 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_6_subnet)}\"\n\t\t819 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t820 |   size              = \"130\"\n\t\t821 |   type              = \"gp2\"\n\t\t822 | \n\t\t823 |   tags {\n\t\t824 |     Name            = \"${var.stackname}-ci-agent-6-data\"\n\t\t825 |     Project         = \"${var.stackname}\"\n\t\t826 |     Device          = \"xvdf\"\n\t\t827 |     aws_hostname    = \"ci-agent-6\"\n\t\t828 |     aws_migration   = \"ci_agent\"\n\t\t829 |     aws_stackname   = \"${var.stackname}\"\n\t\t830 |     aws_environment = \"${var.aws_environment}\"\n\t\t831 |   }\n\t\t832 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-6-docker\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:834-849\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t834 | resource \"aws_ebs_volume\" \"ci-agent-6-docker\" {\n\t\t835 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_6_subnet)}\"\n\t\t836 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t837 |   size              = \"130\"\n\t\t838 |   type              = \"gp2\"\n\t\t839 | \n\t\t840 |   tags {\n\t\t841 |     Name            = \"${var.stackname}-ci-agent-6-docker\"\n\t\t842 |     Project         = \"${var.stackname}\"\n\t\t843 |     Device          = \"xvdg\"\n\t\t844 |     aws_hostname    = \"ci-agent-6\"\n\t\t845 |     aws_migration   = \"ci_agent\"\n\t\t846 |     aws_stackname   = \"${var.stackname}\"\n\t\t847 |     aws_environment = \"${var.aws_environment}\"\n\t\t848 |   }\n\t\t849 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-7-data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:937-952\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t937 | resource \"aws_ebs_volume\" \"ci-agent-7-data\" {\n\t\t938 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_7_subnet)}\"\n\t\t939 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t940 |   size              = \"130\"\n\t\t941 |   type              = \"gp2\"\n\t\t942 | \n\t\t943 |   tags {\n\t\t944 |     Name            = \"${var.stackname}-ci-agent-7-data\"\n\t\t945 |     Project         = \"${var.stackname}\"\n\t\t946 |     Device          = \"xvdf\"\n\t\t947 |     aws_hostname    = \"ci-agent-7\"\n\t\t948 |     aws_migration   = \"ci_agent\"\n\t\t949 |     aws_stackname   = \"${var.stackname}\"\n\t\t950 |     aws_environment = \"${var.aws_environment}\"\n\t\t951 |   }\n\t\t952 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-7-docker\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:954-969\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t954 | resource \"aws_ebs_volume\" \"ci-agent-7-docker\" {\n\t\t955 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_7_subnet)}\"\n\t\t956 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t957 |   size              = \"130\"\n\t\t958 |   type              = \"gp2\"\n\t\t959 | \n\t\t960 |   tags {\n\t\t961 |     Name            = \"${var.stackname}-ci-agent-7-docker\"\n\t\t962 |     Project         = \"${var.stackname}\"\n\t\t963 |     Device          = \"xvdg\"\n\t\t964 |     aws_hostname    = \"ci-agent-7\"\n\t\t965 |     aws_migration   = \"ci_agent\"\n\t\t966 |     aws_stackname   = \"${var.stackname}\"\n\t\t967 |     aws_environment = \"${var.aws_environment}\"\n\t\t968 |   }\n\t\t969 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-8-data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:1057-1072\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t1057 | resource \"aws_ebs_volume\" \"ci-agent-8-data\" {\n\t\t1058 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_8_subnet)}\"\n\t\t1059 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t1060 |   size              = \"130\"\n\t\t1061 |   type              = \"gp2\"\n\t\t1062 | \n\t\t1063 |   tags {\n\t\t1064 |     Name            = \"${var.stackname}-ci-agent-8-data\"\n\t\t1065 |     Project         = \"${var.stackname}\"\n\t\t1066 |     Device          = \"xvdf\"\n\t\t1067 |     aws_hostname    = \"ci-agent-8\"\n\t\t1068 |     aws_migration   = \"ci_agent\"\n\t\t1069 |     aws_stackname   = \"${var.stackname}\"\n\t\t1070 |     aws_environment = \"${var.aws_environment}\"\n\t\t1071 |   }\n\t\t1072 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-8-docker\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:1074-1089\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t1074 | resource \"aws_ebs_volume\" \"ci-agent-8-docker\" {\n\t\t1075 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_8_subnet)}\"\n\t\t1076 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t1077 |   size              = \"130\"\n\t\t1078 |   type              = \"gp2\"\n\t\t1079 | \n\t\t1080 |   tags {\n\t\t1081 |     Name            = \"${var.stackname}-ci-agent-8-docker\"\n\t\t1082 |     Project         = \"${var.stackname}\"\n\t\t1083 |     Device          = \"xvdg\"\n\t\t1084 |     aws_hostname    = \"ci-agent-8\"\n\t\t1085 |     aws_migration   = \"ci_agent\"\n\t\t1086 |     aws_stackname   = \"${var.stackname}\"\n\t\t1087 |     aws_environment = \"${var.aws_environment}\"\n\t\t1088 |   }\n\t\t1089 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ckan\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ckan/main.tf:212-228\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t212 | resource \"aws_ebs_volume\" \"ckan\" {\n\t\t213 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ckan_subnet)}\"\n\t\t214 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t215 |   type              = \"gp2\"\n\t\t216 |   size              = 20\n\t\t217 | \n\t\t218 |   tags {\n\t\t219 |     Name            = \"${var.stackname}-ckan\"\n\t\t220 |     Project         = \"${var.stackname}\"\n\t\t221 |     ManagedBy       = \"terraform\"\n\t\t222 |     aws_stackname   = \"${var.stackname}\"\n\t\t223 |     aws_environment = \"${var.aws_environment}\"\n\t\t224 |     aws_migration   = \"ckan\"\n\t\t225 |     aws_hostname    = \"ckan-1\"\n\t\t226 |     Device          = \"xvdf\"\n\t\t227 |   }\n\t\t228 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.deploy\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-deploy/main.tf:252-267\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t252 | resource \"aws_ebs_volume\" \"deploy\" {\n\t\t253 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.deploy_subnet)}\"\n\t\t254 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t255 |   size              = 40\n\t\t256 |   type              = \"gp2\"\n\t\t257 | \n\t\t258 |   tags {\n\t\t259 |     Name            = \"${var.stackname}-deploy\"\n\t\t260 |     Project         = \"${var.stackname}\"\n\t\t261 |     Device          = \"xvdf\"\n\t\t262 |     aws_hostname    = \"jenkins-1\"\n\t\t263 |     aws_migration   = \"jenkins\"\n\t\t264 |     aws_stackname   = \"${var.stackname}\"\n\t\t265 |     aws_environment = \"${var.aws_environment}\"\n\t\t266 |   }\n\t\t267 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mapit-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mapit/main.tf:210-225\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t210 | resource \"aws_ebs_volume\" \"mapit-1\" {\n\t\t211 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mapit_subnet_a)}\"\n\t\t212 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t213 |   size              = 20\n\t\t214 |   type              = \"gp2\"\n\t\t215 | \n\t\t216 |   tags {\n\t\t217 |     Name            = \"${var.stackname}-mapit\"\n\t\t218 |     Project         = \"${var.stackname}\"\n\t\t219 |     Device          = \"xvdf\"\n\t\t220 |     aws_hostname    = \"mapit-1\"\n\t\t221 |     aws_migration   = \"mapit\"\n\t\t222 |     aws_stackname   = \"${var.stackname}\"\n\t\t223 |     aws_environment = \"${var.aws_environment}\"\n\t\t224 |   }\n\t\t225 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mapit-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mapit/main.tf:246-261\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t246 | resource \"aws_ebs_volume\" \"mapit-2\" {\n\t\t247 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mapit_subnet_b)}\"\n\t\t248 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t249 |   size              = 20\n\t\t250 |   type              = \"gp2\"\n\t\t251 | \n\t\t252 |   tags {\n\t\t253 |     Name            = \"${var.stackname}-mapit\"\n\t\t254 |     Project         = \"${var.stackname}\"\n\t\t255 |     Device          = \"xvdf\"\n\t\t256 |     aws_hostname    = \"mapit-2\"\n\t\t257 |     aws_migration   = \"mapit\"\n\t\t258 |     aws_stackname   = \"${var.stackname}\"\n\t\t259 |     aws_environment = \"${var.aws_environment}\"\n\t\t260 |   }\n\t\t261 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mirrorer\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mirrorer/main.tf:80-95\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t80 | resource \"aws_ebs_volume\" \"mirrorer\" {\n\t\t81 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mirrorer_subnet)}\"\n\t\t82 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t83 |   size              = \"${var.mirrorer_ebs_size}\"\n\t\t84 |   type              = \"gp2\"\n\t\t85 | \n\t\t86 |   tags {\n\t\t87 |     Name            = \"${var.stackname}-mirrorer\"\n\t\t88 |     Project         = \"${var.stackname}\"\n\t\t89 |     Device          = \"xvdf\"\n\t\t90 |     aws_hostname    = \"mirrorer-1\"\n\t\t91 |     aws_migration   = \"mirrorer\"\n\t\t92 |     aws_stackname   = \"${var.stackname}\"\n\t\t93 |     aws_environment = \"${var.aws_environment}\"\n\t\t94 |   }\n\t\t95 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mongo-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mongo/main.tf:156-172\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t156 | resource \"aws_ebs_volume\" \"mongo-1\" {\n\t\t157 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mongo_1_subnet)}\"\n\t\t158 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t159 |   type              = \"gp2\"\n\t\t160 |   size              = 300\n\t\t161 | \n\t\t162 |   tags {\n\t\t163 |     Name            = \"${var.stackname}-mongo-1\"\n\t\t164 |     Project         = \"${var.stackname}\"\n\t\t165 |     ManagedBy       = \"terraform\"\n\t\t166 |     aws_stackname   = \"${var.stackname}\"\n\t\t167 |     aws_environment = \"${var.aws_environment}\"\n\t\t168 |     aws_migration   = \"mongo\"\n\t\t169 |     aws_hostname    = \"mongo-1\"\n\t\t170 |     Device          = \"xvdf\"\n\t\t171 |   }\n\t\t172 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mongo-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mongo/main.tf:213-229\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t213 | resource \"aws_ebs_volume\" \"mongo-2\" {\n\t\t214 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mongo_2_subnet)}\"\n\t\t215 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t216 |   type              = \"gp2\"\n\t\t217 |   size              = 300\n\t\t218 | \n\t\t219 |   tags {\n\t\t220 |     Name            = \"${var.stackname}-mongo-2\"\n\t\t221 |     Project         = \"${var.stackname}\"\n\t\t222 |     ManagedBy       = \"terraform\"\n\t\t223 |     aws_stackname   = \"${var.stackname}\"\n\t\t224 |     aws_environment = \"${var.aws_environment}\"\n\t\t225 |     aws_migration   = \"mongo\"\n\t\t226 |     aws_hostname    = \"mongo-2\"\n\t\t227 |     Device          = \"xvdf\"\n\t\t228 |   }\n\t\t229 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mongo-3\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mongo/main.tf:270-286\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t270 | resource \"aws_ebs_volume\" \"mongo-3\" {\n\t\t271 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mongo_3_subnet)}\"\n\t\t272 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t273 |   type              = \"gp2\"\n\t\t274 |   size              = 300\n\t\t275 | \n\t\t276 |   tags {\n\t\t277 |     Name            = \"${var.stackname}-mongo-3\"\n\t\t278 |     Project         = \"${var.stackname}\"\n\t\t279 |     ManagedBy       = \"terraform\"\n\t\t280 |     aws_stackname   = \"${var.stackname}\"\n\t\t281 |     aws_environment = \"${var.aws_environment}\"\n\t\t282 |     aws_migration   = \"mongo\"\n\t\t283 |     aws_hostname    = \"mongo-3\"\n\t\t284 |     Device          = \"xvdf\"\n\t\t285 |   }\n\t\t286 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.monitoring\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-monitoring/main.tf:235-251\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t235 | resource \"aws_ebs_volume\" \"monitoring\" {\n\t\t236 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.monitoring_subnet)}\"\n\t\t237 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t238 |   type              = \"gp2\"\n\t\t239 |   size              = 40\n\t\t240 | \n\t\t241 |   tags {\n\t\t242 |     Name            = \"${var.stackname}-monitoring\"\n\t\t243 |     Project         = \"${var.stackname}\"\n\t\t244 |     ManagedBy       = \"terraform\"\n\t\t245 |     aws_stackname   = \"${var.stackname}\"\n\t\t246 |     aws_environment = \"${var.aws_environment}\"\n\t\t247 |     aws_migration   = \"monitoring\"\n\t\t248 |     aws_hostname    = \"monitoring-1\"\n\t\t249 |     Device          = \"xvdf\"\n\t\t250 |   }\n\t\t251 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.prometheus-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-prometheus/main.tf:84-98\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t84 | resource \"aws_ebs_volume\" \"prometheus-1\" {\n\t\t85 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.prometheus_1_subnet)}\"\n\t\t86 |   size              = 64\n\t\t87 |   type              = \"gp2\"\n\t\t88 | \n\t\t89 |   tags {\n\t\t90 |     Name            = \"${var.stackname}-prometheus-1\"\n\t\t91 |     Project         = \"${var.stackname}\"\n\t\t92 |     Device          = \"xvdf\"\n\t\t93 |     aws_stackname   = \"${var.stackname}\"\n\t\t94 |     aws_environment = \"${var.aws_environment}\"\n\t\t95 |     aws_migration   = \"prometheus\"\n\t\t96 |     aws_hostname    = \"prometheus-1\"\n\t\t97 |   }\n\t\t98 | }\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/alphagov-govuk-aws-806b1a2a47f2f4e580e524b2cf8cc5928749d972/before-a0a35450b2cdf255d235dc25a0c8c295433651c5/terraform/projects/infra-fastly-logs/main.tfֿ\n\n",
        "stderr": "2024-06-21 12:18:17,573 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/alphagov/csw-client-role.git:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:18:17,574 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/alphagov/tech-ops.git?ref=13f54e5//cyber-security/modules/gds_security_audit_role:None (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 72.49735549800971
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 5, Failed checks: 26, Skipped checks: 0, Parsing errors: 1\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.ci-master\n\tFile: /terraform/projects/app-ci-master/main.tf:262-277\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.graphite-1\n\tFile: /terraform/projects/app-graphite/main.tf:286-302\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.mapit-3\n\tFile: /terraform/projects/app-mapit/main.tf:282-297\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.mapit-4\n\tFile: /terraform/projects/app-mapit/main.tf:318-333\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.prometheus-1\n\tFile: /terraform/projects/app-prometheus/main.tf:90-104\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.apt\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-apt/main.tf:207-222\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t207 | resource \"aws_ebs_volume\" \"apt\" {\n\t\t208 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.apt_1_subnet)}\"\n\t\t209 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t210 |   size              = \"${var.ebs_volume_size}\"\n\t\t211 |   type              = \"gp2\"\n\t\t212 | \n\t\t213 |   tags {\n\t\t214 |     Name            = \"${var.stackname}-apt\"\n\t\t215 |     Project         = \"${var.stackname}\"\n\t\t216 |     Device          = \"xvdf\"\n\t\t217 |     aws_hostname    = \"apt-1\"\n\t\t218 |     aws_migration   = \"apt\"\n\t\t219 |     aws_stackname   = \"${var.stackname}\"\n\t\t220 |     aws_environment = \"${var.aws_environment}\"\n\t\t221 |   }\n\t\t222 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-1-data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:211-226\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t211 | resource \"aws_ebs_volume\" \"ci-agent-1-data\" {\n\t\t212 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_1_subnet)}\"\n\t\t213 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t214 |   size              = \"130\"\n\t\t215 |   type              = \"gp2\"\n\t\t216 | \n\t\t217 |   tags {\n\t\t218 |     Name            = \"${var.stackname}-ci-agent-1-data\"\n\t\t219 |     Project         = \"${var.stackname}\"\n\t\t220 |     Device          = \"xvdf\"\n\t\t221 |     aws_hostname    = \"ci-agent-1\"\n\t\t222 |     aws_migration   = \"ci_agent\"\n\t\t223 |     aws_stackname   = \"${var.stackname}\"\n\t\t224 |     aws_environment = \"${var.aws_environment}\"\n\t\t225 |   }\n\t\t226 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-1-docker\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:228-243\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t228 | resource \"aws_ebs_volume\" \"ci-agent-1-docker\" {\n\t\t229 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_1_subnet)}\"\n\t\t230 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t231 |   size              = \"130\"\n\t\t232 |   type              = \"gp2\"\n\t\t233 | \n\t\t234 |   tags {\n\t\t235 |     Name            = \"${var.stackname}-ci-agent-1-docker\"\n\t\t236 |     Project         = \"${var.stackname}\"\n\t\t237 |     Device          = \"xvdg\"\n\t\t238 |     aws_hostname    = \"ci-agent-1\"\n\t\t239 |     aws_migration   = \"ci_agent\"\n\t\t240 |     aws_stackname   = \"${var.stackname}\"\n\t\t241 |     aws_environment = \"${var.aws_environment}\"\n\t\t242 |   }\n\t\t243 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-2-data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:331-346\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t331 | resource \"aws_ebs_volume\" \"ci-agent-2-data\" {\n\t\t332 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_2_subnet)}\"\n\t\t333 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t334 |   size              = \"130\"\n\t\t335 |   type              = \"gp2\"\n\t\t336 | \n\t\t337 |   tags {\n\t\t338 |     Name            = \"${var.stackname}-ci-agent-2-data\"\n\t\t339 |     Project         = \"${var.stackname}\"\n\t\t340 |     Device          = \"xvdf\"\n\t\t341 |     aws_hostname    = \"ci-agent-2\"\n\t\t342 |     aws_migration   = \"ci_agent\"\n\t\t343 |     aws_stackname   = \"${var.stackname}\"\n\t\t344 |     aws_environment = \"${var.aws_environment}\"\n\t\t345 |   }\n\t\t346 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-2-docker\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:348-363\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t348 | resource \"aws_ebs_volume\" \"ci-agent-2-docker\" {\n\t\t349 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_2_subnet)}\"\n\t\t350 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t351 |   size              = \"130\"\n\t\t352 |   type              = \"gp2\"\n\t\t353 | \n\t\t354 |   tags {\n\t\t355 |     Name            = \"${var.stackname}-ci-agent-2-docker\"\n\t\t356 |     Project         = \"${var.stackname}\"\n\t\t357 |     Device          = \"xvdg\"\n\t\t358 |     aws_hostname    = \"ci-agent-2\"\n\t\t359 |     aws_migration   = \"ci_agent\"\n\t\t360 |     aws_stackname   = \"${var.stackname}\"\n\t\t361 |     aws_environment = \"${var.aws_environment}\"\n\t\t362 |   }\n\t\t363 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-3-data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:457-472\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t457 | resource \"aws_ebs_volume\" \"ci-agent-3-data\" {\n\t\t458 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_3_subnet)}\"\n\t\t459 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t460 |   size              = \"130\"\n\t\t461 |   type              = \"gp2\"\n\t\t462 | \n\t\t463 |   tags {\n\t\t464 |     Name            = \"${var.stackname}-ci-agent-3-data\"\n\t\t465 |     Project         = \"${var.stackname}\"\n\t\t466 |     Device          = \"xvdf\"\n\t\t467 |     aws_hostname    = \"ci-agent-3\"\n\t\t468 |     aws_migration   = \"ci_agent\"\n\t\t469 |     aws_stackname   = \"${var.stackname}\"\n\t\t470 |     aws_environment = \"${var.aws_environment}\"\n\t\t471 |   }\n\t\t472 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-3-docker\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:474-489\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t474 | resource \"aws_ebs_volume\" \"ci-agent-3-docker\" {\n\t\t475 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_3_subnet)}\"\n\t\t476 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t477 |   size              = \"130\"\n\t\t478 |   type              = \"gp2\"\n\t\t479 | \n\t\t480 |   tags {\n\t\t481 |     Name            = \"${var.stackname}-ci-agent-3-docker\"\n\t\t482 |     Project         = \"${var.stackname}\"\n\t\t483 |     Device          = \"xvdg\"\n\t\t484 |     aws_hostname    = \"ci-agent-3\"\n\t\t485 |     aws_migration   = \"ci_agent\"\n\t\t486 |     aws_stackname   = \"${var.stackname}\"\n\t\t487 |     aws_environment = \"${var.aws_environment}\"\n\t\t488 |   }\n\t\t489 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-4-data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:577-592\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t577 | resource \"aws_ebs_volume\" \"ci-agent-4-data\" {\n\t\t578 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_4_subnet)}\"\n\t\t579 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t580 |   size              = \"130\"\n\t\t581 |   type              = \"gp2\"\n\t\t582 | \n\t\t583 |   tags {\n\t\t584 |     Name            = \"${var.stackname}-ci-agent-4-data\"\n\t\t585 |     Project         = \"${var.stackname}\"\n\t\t586 |     Device          = \"xvdf\"\n\t\t587 |     aws_hostname    = \"ci-agent-4\"\n\t\t588 |     aws_migration   = \"ci_agent\"\n\t\t589 |     aws_stackname   = \"${var.stackname}\"\n\t\t590 |     aws_environment = \"${var.aws_environment}\"\n\t\t591 |   }\n\t\t592 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-4-docker\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:594-609\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t594 | resource \"aws_ebs_volume\" \"ci-agent-4-docker\" {\n\t\t595 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_4_subnet)}\"\n\t\t596 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t597 |   size              = \"130\"\n\t\t598 |   type              = \"gp2\"\n\t\t599 | \n\t\t600 |   tags {\n\t\t601 |     Name            = \"${var.stackname}-ci-agent-4-docker\"\n\t\t602 |     Project         = \"${var.stackname}\"\n\t\t603 |     Device          = \"xvdg\"\n\t\t604 |     aws_hostname    = \"ci-agent-4\"\n\t\t605 |     aws_migration   = \"ci_agent\"\n\t\t606 |     aws_stackname   = \"${var.stackname}\"\n\t\t607 |     aws_environment = \"${var.aws_environment}\"\n\t\t608 |   }\n\t\t609 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-5-data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:697-712\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t697 | resource \"aws_ebs_volume\" \"ci-agent-5-data\" {\n\t\t698 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_5_subnet)}\"\n\t\t699 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t700 |   size              = \"130\"\n\t\t701 |   type              = \"gp2\"\n\t\t702 | \n\t\t703 |   tags {\n\t\t704 |     Name            = \"${var.stackname}-ci-agent-5-data\"\n\t\t705 |     Project         = \"${var.stackname}\"\n\t\t706 |     Device          = \"xvdf\"\n\t\t707 |     aws_hostname    = \"ci-agent-5\"\n\t\t708 |     aws_migration   = \"ci_agent\"\n\t\t709 |     aws_stackname   = \"${var.stackname}\"\n\t\t710 |     aws_environment = \"${var.aws_environment}\"\n\t\t711 |   }\n\t\t712 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-5-docker\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:714-729\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t714 | resource \"aws_ebs_volume\" \"ci-agent-5-docker\" {\n\t\t715 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_5_subnet)}\"\n\t\t716 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t717 |   size              = \"130\"\n\t\t718 |   type              = \"gp2\"\n\t\t719 | \n\t\t720 |   tags {\n\t\t721 |     Name            = \"${var.stackname}-ci-agent-5-docker\"\n\t\t722 |     Project         = \"${var.stackname}\"\n\t\t723 |     Device          = \"xvdg\"\n\t\t724 |     aws_hostname    = \"ci-agent-5\"\n\t\t725 |     aws_migration   = \"ci_agent\"\n\t\t726 |     aws_stackname   = \"${var.stackname}\"\n\t\t727 |     aws_environment = \"${var.aws_environment}\"\n\t\t728 |   }\n\t\t729 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-6-data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:817-832\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t817 | resource \"aws_ebs_volume\" \"ci-agent-6-data\" {\n\t\t818 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_6_subnet)}\"\n\t\t819 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t820 |   size              = \"130\"\n\t\t821 |   type              = \"gp2\"\n\t\t822 | \n\t\t823 |   tags {\n\t\t824 |     Name            = \"${var.stackname}-ci-agent-6-data\"\n\t\t825 |     Project         = \"${var.stackname}\"\n\t\t826 |     Device          = \"xvdf\"\n\t\t827 |     aws_hostname    = \"ci-agent-6\"\n\t\t828 |     aws_migration   = \"ci_agent\"\n\t\t829 |     aws_stackname   = \"${var.stackname}\"\n\t\t830 |     aws_environment = \"${var.aws_environment}\"\n\t\t831 |   }\n\t\t832 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-6-docker\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:834-849\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t834 | resource \"aws_ebs_volume\" \"ci-agent-6-docker\" {\n\t\t835 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_6_subnet)}\"\n\t\t836 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t837 |   size              = \"130\"\n\t\t838 |   type              = \"gp2\"\n\t\t839 | \n\t\t840 |   tags {\n\t\t841 |     Name            = \"${var.stackname}-ci-agent-6-docker\"\n\t\t842 |     Project         = \"${var.stackname}\"\n\t\t843 |     Device          = \"xvdg\"\n\t\t844 |     aws_hostname    = \"ci-agent-6\"\n\t\t845 |     aws_migration   = \"ci_agent\"\n\t\t846 |     aws_stackname   = \"${var.stackname}\"\n\t\t847 |     aws_environment = \"${var.aws_environment}\"\n\t\t848 |   }\n\t\t849 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-7-data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:937-952\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t937 | resource \"aws_ebs_volume\" \"ci-agent-7-data\" {\n\t\t938 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_7_subnet)}\"\n\t\t939 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t940 |   size              = \"130\"\n\t\t941 |   type              = \"gp2\"\n\t\t942 | \n\t\t943 |   tags {\n\t\t944 |     Name            = \"${var.stackname}-ci-agent-7-data\"\n\t\t945 |     Project         = \"${var.stackname}\"\n\t\t946 |     Device          = \"xvdf\"\n\t\t947 |     aws_hostname    = \"ci-agent-7\"\n\t\t948 |     aws_migration   = \"ci_agent\"\n\t\t949 |     aws_stackname   = \"${var.stackname}\"\n\t\t950 |     aws_environment = \"${var.aws_environment}\"\n\t\t951 |   }\n\t\t952 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-7-docker\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:954-969\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t954 | resource \"aws_ebs_volume\" \"ci-agent-7-docker\" {\n\t\t955 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_7_subnet)}\"\n\t\t956 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t957 |   size              = \"130\"\n\t\t958 |   type              = \"gp2\"\n\t\t959 | \n\t\t960 |   tags {\n\t\t961 |     Name            = \"${var.stackname}-ci-agent-7-docker\"\n\t\t962 |     Project         = \"${var.stackname}\"\n\t\t963 |     Device          = \"xvdg\"\n\t\t964 |     aws_hostname    = \"ci-agent-7\"\n\t\t965 |     aws_migration   = \"ci_agent\"\n\t\t966 |     aws_stackname   = \"${var.stackname}\"\n\t\t967 |     aws_environment = \"${var.aws_environment}\"\n\t\t968 |   }\n\t\t969 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-8-data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:1057-1072\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t1057 | resource \"aws_ebs_volume\" \"ci-agent-8-data\" {\n\t\t1058 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_8_subnet)}\"\n\t\t1059 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t1060 |   size              = \"130\"\n\t\t1061 |   type              = \"gp2\"\n\t\t1062 | \n\t\t1063 |   tags {\n\t\t1064 |     Name            = \"${var.stackname}-ci-agent-8-data\"\n\t\t1065 |     Project         = \"${var.stackname}\"\n\t\t1066 |     Device          = \"xvdf\"\n\t\t1067 |     aws_hostname    = \"ci-agent-8\"\n\t\t1068 |     aws_migration   = \"ci_agent\"\n\t\t1069 |     aws_stackname   = \"${var.stackname}\"\n\t\t1070 |     aws_environment = \"${var.aws_environment}\"\n\t\t1071 |   }\n\t\t1072 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-8-docker\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:1074-1089\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t1074 | resource \"aws_ebs_volume\" \"ci-agent-8-docker\" {\n\t\t1075 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_8_subnet)}\"\n\t\t1076 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t1077 |   size              = \"130\"\n\t\t1078 |   type              = \"gp2\"\n\t\t1079 | \n\t\t1080 |   tags {\n\t\t1081 |     Name            = \"${var.stackname}-ci-agent-8-docker\"\n\t\t1082 |     Project         = \"${var.stackname}\"\n\t\t1083 |     Device          = \"xvdg\"\n\t\t1084 |     aws_hostname    = \"ci-agent-8\"\n\t\t1085 |     aws_migration   = \"ci_agent\"\n\t\t1086 |     aws_stackname   = \"${var.stackname}\"\n\t\t1087 |     aws_environment = \"${var.aws_environment}\"\n\t\t1088 |   }\n\t\t1089 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ckan\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ckan/main.tf:212-228\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t212 | resource \"aws_ebs_volume\" \"ckan\" {\n\t\t213 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ckan_subnet)}\"\n\t\t214 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t215 |   type              = \"gp2\"\n\t\t216 |   size              = 20\n\t\t217 | \n\t\t218 |   tags {\n\t\t219 |     Name            = \"${var.stackname}-ckan\"\n\t\t220 |     Project         = \"${var.stackname}\"\n\t\t221 |     ManagedBy       = \"terraform\"\n\t\t222 |     aws_stackname   = \"${var.stackname}\"\n\t\t223 |     aws_environment = \"${var.aws_environment}\"\n\t\t224 |     aws_migration   = \"ckan\"\n\t\t225 |     aws_hostname    = \"ckan-1\"\n\t\t226 |     Device          = \"xvdf\"\n\t\t227 |   }\n\t\t228 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.deploy\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-deploy/main.tf:252-267\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t252 | resource \"aws_ebs_volume\" \"deploy\" {\n\t\t253 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.deploy_subnet)}\"\n\t\t254 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t255 |   size              = 40\n\t\t256 |   type              = \"gp2\"\n\t\t257 | \n\t\t258 |   tags {\n\t\t259 |     Name            = \"${var.stackname}-deploy\"\n\t\t260 |     Project         = \"${var.stackname}\"\n\t\t261 |     Device          = \"xvdf\"\n\t\t262 |     aws_hostname    = \"jenkins-1\"\n\t\t263 |     aws_migration   = \"jenkins\"\n\t\t264 |     aws_stackname   = \"${var.stackname}\"\n\t\t265 |     aws_environment = \"${var.aws_environment}\"\n\t\t266 |   }\n\t\t267 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mapit-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mapit/main.tf:210-225\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t210 | resource \"aws_ebs_volume\" \"mapit-1\" {\n\t\t211 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mapit_subnet_a)}\"\n\t\t212 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t213 |   size              = 20\n\t\t214 |   type              = \"gp2\"\n\t\t215 | \n\t\t216 |   tags {\n\t\t217 |     Name            = \"${var.stackname}-mapit\"\n\t\t218 |     Project         = \"${var.stackname}\"\n\t\t219 |     Device          = \"xvdf\"\n\t\t220 |     aws_hostname    = \"mapit-1\"\n\t\t221 |     aws_migration   = \"mapit\"\n\t\t222 |     aws_stackname   = \"${var.stackname}\"\n\t\t223 |     aws_environment = \"${var.aws_environment}\"\n\t\t224 |   }\n\t\t225 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mapit-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mapit/main.tf:246-261\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t246 | resource \"aws_ebs_volume\" \"mapit-2\" {\n\t\t247 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mapit_subnet_b)}\"\n\t\t248 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t249 |   size              = 20\n\t\t250 |   type              = \"gp2\"\n\t\t251 | \n\t\t252 |   tags {\n\t\t253 |     Name            = \"${var.stackname}-mapit\"\n\t\t254 |     Project         = \"${var.stackname}\"\n\t\t255 |     Device          = \"xvdf\"\n\t\t256 |     aws_hostname    = \"mapit-2\"\n\t\t257 |     aws_migration   = \"mapit\"\n\t\t258 |     aws_stackname   = \"${var.stackname}\"\n\t\t259 |     aws_environment = \"${var.aws_environment}\"\n\t\t260 |   }\n\t\t261 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mirrorer\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mirrorer/main.tf:80-95\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t80 | resource \"aws_ebs_volume\" \"mirrorer\" {\n\t\t81 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mirrorer_subnet)}\"\n\t\t82 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t83 |   size              = \"${var.mirrorer_ebs_size}\"\n\t\t84 |   type              = \"gp2\"\n\t\t85 | \n\t\t86 |   tags {\n\t\t87 |     Name            = \"${var.stackname}-mirrorer\"\n\t\t88 |     Project         = \"${var.stackname}\"\n\t\t89 |     Device          = \"xvdf\"\n\t\t90 |     aws_hostname    = \"mirrorer-1\"\n\t\t91 |     aws_migration   = \"mirrorer\"\n\t\t92 |     aws_stackname   = \"${var.stackname}\"\n\t\t93 |     aws_environment = \"${var.aws_environment}\"\n\t\t94 |   }\n\t\t95 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mongo-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mongo/main.tf:156-172\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t156 | resource \"aws_ebs_volume\" \"mongo-1\" {\n\t\t157 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mongo_1_subnet)}\"\n\t\t158 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t159 |   type              = \"gp2\"\n\t\t160 |   size              = 300\n\t\t161 | \n\t\t162 |   tags {\n\t\t163 |     Name            = \"${var.stackname}-mongo-1\"\n\t\t164 |     Project         = \"${var.stackname}\"\n\t\t165 |     ManagedBy       = \"terraform\"\n\t\t166 |     aws_stackname   = \"${var.stackname}\"\n\t\t167 |     aws_environment = \"${var.aws_environment}\"\n\t\t168 |     aws_migration   = \"mongo\"\n\t\t169 |     aws_hostname    = \"mongo-1\"\n\t\t170 |     Device          = \"xvdf\"\n\t\t171 |   }\n\t\t172 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mongo-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mongo/main.tf:213-229\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t213 | resource \"aws_ebs_volume\" \"mongo-2\" {\n\t\t214 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mongo_2_subnet)}\"\n\t\t215 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t216 |   type              = \"gp2\"\n\t\t217 |   size              = 300\n\t\t218 | \n\t\t219 |   tags {\n\t\t220 |     Name            = \"${var.stackname}-mongo-2\"\n\t\t221 |     Project         = \"${var.stackname}\"\n\t\t222 |     ManagedBy       = \"terraform\"\n\t\t223 |     aws_stackname   = \"${var.stackname}\"\n\t\t224 |     aws_environment = \"${var.aws_environment}\"\n\t\t225 |     aws_migration   = \"mongo\"\n\t\t226 |     aws_hostname    = \"mongo-2\"\n\t\t227 |     Device          = \"xvdf\"\n\t\t228 |   }\n\t\t229 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mongo-3\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mongo/main.tf:270-286\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t270 | resource \"aws_ebs_volume\" \"mongo-3\" {\n\t\t271 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mongo_3_subnet)}\"\n\t\t272 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t273 |   type              = \"gp2\"\n\t\t274 |   size              = 300\n\t\t275 | \n\t\t276 |   tags {\n\t\t277 |     Name            = \"${var.stackname}-mongo-3\"\n\t\t278 |     Project         = \"${var.stackname}\"\n\t\t279 |     ManagedBy       = \"terraform\"\n\t\t280 |     aws_stackname   = \"${var.stackname}\"\n\t\t281 |     aws_environment = \"${var.aws_environment}\"\n\t\t282 |     aws_migration   = \"mongo\"\n\t\t283 |     aws_hostname    = \"mongo-3\"\n\t\t284 |     Device          = \"xvdf\"\n\t\t285 |   }\n\t\t286 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.monitoring\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-monitoring/main.tf:235-251\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t235 | resource \"aws_ebs_volume\" \"monitoring\" {\n\t\t236 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.monitoring_subnet)}\"\n\t\t237 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t238 |   type              = \"gp2\"\n\t\t239 |   size              = 40\n\t\t240 | \n\t\t241 |   tags {\n\t\t242 |     Name            = \"${var.stackname}-monitoring\"\n\t\t243 |     Project         = \"${var.stackname}\"\n\t\t244 |     ManagedBy       = \"terraform\"\n\t\t245 |     aws_stackname   = \"${var.stackname}\"\n\t\t246 |     aws_environment = \"${var.aws_environment}\"\n\t\t247 |     aws_migration   = \"monitoring\"\n\t\t248 |     aws_hostname    = \"monitoring-1\"\n\t\t249 |     Device          = \"xvdf\"\n\t\t250 |   }\n\t\t251 | }\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/alphagov-govuk-aws-806b1a2a47f2f4e580e524b2cf8cc5928749d972/after/terraform/projects/infra-fastly-logs/main.tfֿ\n\n",
      "stderr": "2024-06-21 12:17:05,835 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/alphagov/csw-client-role.git:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:17:05,836 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/alphagov/tech-ops.git?ref=13f54e5//cyber-security/modules/gds_security_audit_role:None (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 70.40824304999842
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/alphagov/govuk-aws/commit/8d7d2ebe0dbe9ebf8009572d1d710c4700cf245e",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 5, Failed checks: 26, Skipped checks: 0, Parsing errors: 1\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.ci-master\n\tFile: /terraform/projects/app-ci-master/main.tf:262-277\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.graphite-1\n\tFile: /terraform/projects/app-graphite/main.tf:286-302\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.mapit-3\n\tFile: /terraform/projects/app-mapit/main.tf:282-297\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.mapit-4\n\tFile: /terraform/projects/app-mapit/main.tf:318-333\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.prometheus-1\n\tFile: /terraform/projects/app-prometheus/main.tf:90-104\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.apt\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-apt/main.tf:207-222\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t207 | resource \"aws_ebs_volume\" \"apt\" {\n\t\t208 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.apt_1_subnet)}\"\n\t\t209 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t210 |   size              = \"${var.ebs_volume_size}\"\n\t\t211 |   type              = \"gp2\"\n\t\t212 | \n\t\t213 |   tags {\n\t\t214 |     Name            = \"${var.stackname}-apt\"\n\t\t215 |     Project         = \"${var.stackname}\"\n\t\t216 |     Device          = \"xvdf\"\n\t\t217 |     aws_hostname    = \"apt-1\"\n\t\t218 |     aws_migration   = \"apt\"\n\t\t219 |     aws_stackname   = \"${var.stackname}\"\n\t\t220 |     aws_environment = \"${var.aws_environment}\"\n\t\t221 |   }\n\t\t222 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-1-data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:211-226\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t211 | resource \"aws_ebs_volume\" \"ci-agent-1-data\" {\n\t\t212 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_1_subnet)}\"\n\t\t213 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t214 |   size              = \"130\"\n\t\t215 |   type              = \"gp2\"\n\t\t216 | \n\t\t217 |   tags {\n\t\t218 |     Name            = \"${var.stackname}-ci-agent-1-data\"\n\t\t219 |     Project         = \"${var.stackname}\"\n\t\t220 |     Device          = \"xvdf\"\n\t\t221 |     aws_hostname    = \"ci-agent-1\"\n\t\t222 |     aws_migration   = \"ci_agent\"\n\t\t223 |     aws_stackname   = \"${var.stackname}\"\n\t\t224 |     aws_environment = \"${var.aws_environment}\"\n\t\t225 |   }\n\t\t226 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-1-docker\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:228-243\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t228 | resource \"aws_ebs_volume\" \"ci-agent-1-docker\" {\n\t\t229 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_1_subnet)}\"\n\t\t230 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t231 |   size              = \"130\"\n\t\t232 |   type              = \"gp2\"\n\t\t233 | \n\t\t234 |   tags {\n\t\t235 |     Name            = \"${var.stackname}-ci-agent-1-docker\"\n\t\t236 |     Project         = \"${var.stackname}\"\n\t\t237 |     Device          = \"xvdg\"\n\t\t238 |     aws_hostname    = \"ci-agent-1\"\n\t\t239 |     aws_migration   = \"ci_agent\"\n\t\t240 |     aws_stackname   = \"${var.stackname}\"\n\t\t241 |     aws_environment = \"${var.aws_environment}\"\n\t\t242 |   }\n\t\t243 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-2-data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:331-346\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t331 | resource \"aws_ebs_volume\" \"ci-agent-2-data\" {\n\t\t332 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_2_subnet)}\"\n\t\t333 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t334 |   size              = \"130\"\n\t\t335 |   type              = \"gp2\"\n\t\t336 | \n\t\t337 |   tags {\n\t\t338 |     Name            = \"${var.stackname}-ci-agent-2-data\"\n\t\t339 |     Project         = \"${var.stackname}\"\n\t\t340 |     Device          = \"xvdf\"\n\t\t341 |     aws_hostname    = \"ci-agent-2\"\n\t\t342 |     aws_migration   = \"ci_agent\"\n\t\t343 |     aws_stackname   = \"${var.stackname}\"\n\t\t344 |     aws_environment = \"${var.aws_environment}\"\n\t\t345 |   }\n\t\t346 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-2-docker\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:348-363\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t348 | resource \"aws_ebs_volume\" \"ci-agent-2-docker\" {\n\t\t349 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_2_subnet)}\"\n\t\t350 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t351 |   size              = \"130\"\n\t\t352 |   type              = \"gp2\"\n\t\t353 | \n\t\t354 |   tags {\n\t\t355 |     Name            = \"${var.stackname}-ci-agent-2-docker\"\n\t\t356 |     Project         = \"${var.stackname}\"\n\t\t357 |     Device          = \"xvdg\"\n\t\t358 |     aws_hostname    = \"ci-agent-2\"\n\t\t359 |     aws_migration   = \"ci_agent\"\n\t\t360 |     aws_stackname   = \"${var.stackname}\"\n\t\t361 |     aws_environment = \"${var.aws_environment}\"\n\t\t362 |   }\n\t\t363 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-3-data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:457-472\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t457 | resource \"aws_ebs_volume\" \"ci-agent-3-data\" {\n\t\t458 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_3_subnet)}\"\n\t\t459 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t460 |   size              = \"130\"\n\t\t461 |   type              = \"gp2\"\n\t\t462 | \n\t\t463 |   tags {\n\t\t464 |     Name            = \"${var.stackname}-ci-agent-3-data\"\n\t\t465 |     Project         = \"${var.stackname}\"\n\t\t466 |     Device          = \"xvdf\"\n\t\t467 |     aws_hostname    = \"ci-agent-3\"\n\t\t468 |     aws_migration   = \"ci_agent\"\n\t\t469 |     aws_stackname   = \"${var.stackname}\"\n\t\t470 |     aws_environment = \"${var.aws_environment}\"\n\t\t471 |   }\n\t\t472 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-3-docker\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:474-489\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t474 | resource \"aws_ebs_volume\" \"ci-agent-3-docker\" {\n\t\t475 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_3_subnet)}\"\n\t\t476 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t477 |   size              = \"130\"\n\t\t478 |   type              = \"gp2\"\n\t\t479 | \n\t\t480 |   tags {\n\t\t481 |     Name            = \"${var.stackname}-ci-agent-3-docker\"\n\t\t482 |     Project         = \"${var.stackname}\"\n\t\t483 |     Device          = \"xvdg\"\n\t\t484 |     aws_hostname    = \"ci-agent-3\"\n\t\t485 |     aws_migration   = \"ci_agent\"\n\t\t486 |     aws_stackname   = \"${var.stackname}\"\n\t\t487 |     aws_environment = \"${var.aws_environment}\"\n\t\t488 |   }\n\t\t489 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-4-data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:577-592\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t577 | resource \"aws_ebs_volume\" \"ci-agent-4-data\" {\n\t\t578 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_4_subnet)}\"\n\t\t579 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t580 |   size              = \"130\"\n\t\t581 |   type              = \"gp2\"\n\t\t582 | \n\t\t583 |   tags {\n\t\t584 |     Name            = \"${var.stackname}-ci-agent-4-data\"\n\t\t585 |     Project         = \"${var.stackname}\"\n\t\t586 |     Device          = \"xvdf\"\n\t\t587 |     aws_hostname    = \"ci-agent-4\"\n\t\t588 |     aws_migration   = \"ci_agent\"\n\t\t589 |     aws_stackname   = \"${var.stackname}\"\n\t\t590 |     aws_environment = \"${var.aws_environment}\"\n\t\t591 |   }\n\t\t592 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-4-docker\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:594-609\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t594 | resource \"aws_ebs_volume\" \"ci-agent-4-docker\" {\n\t\t595 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_4_subnet)}\"\n\t\t596 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t597 |   size              = \"130\"\n\t\t598 |   type              = \"gp2\"\n\t\t599 | \n\t\t600 |   tags {\n\t\t601 |     Name            = \"${var.stackname}-ci-agent-4-docker\"\n\t\t602 |     Project         = \"${var.stackname}\"\n\t\t603 |     Device          = \"xvdg\"\n\t\t604 |     aws_hostname    = \"ci-agent-4\"\n\t\t605 |     aws_migration   = \"ci_agent\"\n\t\t606 |     aws_stackname   = \"${var.stackname}\"\n\t\t607 |     aws_environment = \"${var.aws_environment}\"\n\t\t608 |   }\n\t\t609 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-5-data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:697-712\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t697 | resource \"aws_ebs_volume\" \"ci-agent-5-data\" {\n\t\t698 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_5_subnet)}\"\n\t\t699 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t700 |   size              = \"130\"\n\t\t701 |   type              = \"gp2\"\n\t\t702 | \n\t\t703 |   tags {\n\t\t704 |     Name            = \"${var.stackname}-ci-agent-5-data\"\n\t\t705 |     Project         = \"${var.stackname}\"\n\t\t706 |     Device          = \"xvdf\"\n\t\t707 |     aws_hostname    = \"ci-agent-5\"\n\t\t708 |     aws_migration   = \"ci_agent\"\n\t\t709 |     aws_stackname   = \"${var.stackname}\"\n\t\t710 |     aws_environment = \"${var.aws_environment}\"\n\t\t711 |   }\n\t\t712 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-5-docker\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:714-729\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t714 | resource \"aws_ebs_volume\" \"ci-agent-5-docker\" {\n\t\t715 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_5_subnet)}\"\n\t\t716 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t717 |   size              = \"130\"\n\t\t718 |   type              = \"gp2\"\n\t\t719 | \n\t\t720 |   tags {\n\t\t721 |     Name            = \"${var.stackname}-ci-agent-5-docker\"\n\t\t722 |     Project         = \"${var.stackname}\"\n\t\t723 |     Device          = \"xvdg\"\n\t\t724 |     aws_hostname    = \"ci-agent-5\"\n\t\t725 |     aws_migration   = \"ci_agent\"\n\t\t726 |     aws_stackname   = \"${var.stackname}\"\n\t\t727 |     aws_environment = \"${var.aws_environment}\"\n\t\t728 |   }\n\t\t729 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-6-data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:817-832\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t817 | resource \"aws_ebs_volume\" \"ci-agent-6-data\" {\n\t\t818 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_6_subnet)}\"\n\t\t819 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t820 |   size              = \"130\"\n\t\t821 |   type              = \"gp2\"\n\t\t822 | \n\t\t823 |   tags {\n\t\t824 |     Name            = \"${var.stackname}-ci-agent-6-data\"\n\t\t825 |     Project         = \"${var.stackname}\"\n\t\t826 |     Device          = \"xvdf\"\n\t\t827 |     aws_hostname    = \"ci-agent-6\"\n\t\t828 |     aws_migration   = \"ci_agent\"\n\t\t829 |     aws_stackname   = \"${var.stackname}\"\n\t\t830 |     aws_environment = \"${var.aws_environment}\"\n\t\t831 |   }\n\t\t832 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-6-docker\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:834-849\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t834 | resource \"aws_ebs_volume\" \"ci-agent-6-docker\" {\n\t\t835 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_6_subnet)}\"\n\t\t836 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t837 |   size              = \"130\"\n\t\t838 |   type              = \"gp2\"\n\t\t839 | \n\t\t840 |   tags {\n\t\t841 |     Name            = \"${var.stackname}-ci-agent-6-docker\"\n\t\t842 |     Project         = \"${var.stackname}\"\n\t\t843 |     Device          = \"xvdg\"\n\t\t844 |     aws_hostname    = \"ci-agent-6\"\n\t\t845 |     aws_migration   = \"ci_agent\"\n\t\t846 |     aws_stackname   = \"${var.stackname}\"\n\t\t847 |     aws_environment = \"${var.aws_environment}\"\n\t\t848 |   }\n\t\t849 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-7-data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:937-952\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t937 | resource \"aws_ebs_volume\" \"ci-agent-7-data\" {\n\t\t938 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_7_subnet)}\"\n\t\t939 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t940 |   size              = \"130\"\n\t\t941 |   type              = \"gp2\"\n\t\t942 | \n\t\t943 |   tags {\n\t\t944 |     Name            = \"${var.stackname}-ci-agent-7-data\"\n\t\t945 |     Project         = \"${var.stackname}\"\n\t\t946 |     Device          = \"xvdf\"\n\t\t947 |     aws_hostname    = \"ci-agent-7\"\n\t\t948 |     aws_migration   = \"ci_agent\"\n\t\t949 |     aws_stackname   = \"${var.stackname}\"\n\t\t950 |     aws_environment = \"${var.aws_environment}\"\n\t\t951 |   }\n\t\t952 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-7-docker\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:954-969\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t954 | resource \"aws_ebs_volume\" \"ci-agent-7-docker\" {\n\t\t955 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_7_subnet)}\"\n\t\t956 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t957 |   size              = \"130\"\n\t\t958 |   type              = \"gp2\"\n\t\t959 | \n\t\t960 |   tags {\n\t\t961 |     Name            = \"${var.stackname}-ci-agent-7-docker\"\n\t\t962 |     Project         = \"${var.stackname}\"\n\t\t963 |     Device          = \"xvdg\"\n\t\t964 |     aws_hostname    = \"ci-agent-7\"\n\t\t965 |     aws_migration   = \"ci_agent\"\n\t\t966 |     aws_stackname   = \"${var.stackname}\"\n\t\t967 |     aws_environment = \"${var.aws_environment}\"\n\t\t968 |   }\n\t\t969 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-8-data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:1057-1072\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t1057 | resource \"aws_ebs_volume\" \"ci-agent-8-data\" {\n\t\t1058 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_8_subnet)}\"\n\t\t1059 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t1060 |   size              = \"130\"\n\t\t1061 |   type              = \"gp2\"\n\t\t1062 | \n\t\t1063 |   tags {\n\t\t1064 |     Name            = \"${var.stackname}-ci-agent-8-data\"\n\t\t1065 |     Project         = \"${var.stackname}\"\n\t\t1066 |     Device          = \"xvdf\"\n\t\t1067 |     aws_hostname    = \"ci-agent-8\"\n\t\t1068 |     aws_migration   = \"ci_agent\"\n\t\t1069 |     aws_stackname   = \"${var.stackname}\"\n\t\t1070 |     aws_environment = \"${var.aws_environment}\"\n\t\t1071 |   }\n\t\t1072 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ci-agent-8-docker\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ci-agents/main.tf:1074-1089\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t1074 | resource \"aws_ebs_volume\" \"ci-agent-8-docker\" {\n\t\t1075 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ci_agent_8_subnet)}\"\n\t\t1076 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t1077 |   size              = \"130\"\n\t\t1078 |   type              = \"gp2\"\n\t\t1079 | \n\t\t1080 |   tags {\n\t\t1081 |     Name            = \"${var.stackname}-ci-agent-8-docker\"\n\t\t1082 |     Project         = \"${var.stackname}\"\n\t\t1083 |     Device          = \"xvdg\"\n\t\t1084 |     aws_hostname    = \"ci-agent-8\"\n\t\t1085 |     aws_migration   = \"ci_agent\"\n\t\t1086 |     aws_stackname   = \"${var.stackname}\"\n\t\t1087 |     aws_environment = \"${var.aws_environment}\"\n\t\t1088 |   }\n\t\t1089 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ckan\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ckan/main.tf:212-228\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t212 | resource \"aws_ebs_volume\" \"ckan\" {\n\t\t213 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ckan_subnet)}\"\n\t\t214 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t215 |   type              = \"gp2\"\n\t\t216 |   size              = 20\n\t\t217 | \n\t\t218 |   tags {\n\t\t219 |     Name            = \"${var.stackname}-ckan\"\n\t\t220 |     Project         = \"${var.stackname}\"\n\t\t221 |     ManagedBy       = \"terraform\"\n\t\t222 |     aws_stackname   = \"${var.stackname}\"\n\t\t223 |     aws_environment = \"${var.aws_environment}\"\n\t\t224 |     aws_migration   = \"ckan\"\n\t\t225 |     aws_hostname    = \"ckan-1\"\n\t\t226 |     Device          = \"xvdf\"\n\t\t227 |   }\n\t\t228 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.deploy\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-deploy/main.tf:252-267\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t252 | resource \"aws_ebs_volume\" \"deploy\" {\n\t\t253 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.deploy_subnet)}\"\n\t\t254 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t255 |   size              = 40\n\t\t256 |   type              = \"gp2\"\n\t\t257 | \n\t\t258 |   tags {\n\t\t259 |     Name            = \"${var.stackname}-deploy\"\n\t\t260 |     Project         = \"${var.stackname}\"\n\t\t261 |     Device          = \"xvdf\"\n\t\t262 |     aws_hostname    = \"jenkins-1\"\n\t\t263 |     aws_migration   = \"jenkins\"\n\t\t264 |     aws_stackname   = \"${var.stackname}\"\n\t\t265 |     aws_environment = \"${var.aws_environment}\"\n\t\t266 |   }\n\t\t267 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mapit-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mapit/main.tf:210-225\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t210 | resource \"aws_ebs_volume\" \"mapit-1\" {\n\t\t211 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mapit_subnet_a)}\"\n\t\t212 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t213 |   size              = 20\n\t\t214 |   type              = \"gp2\"\n\t\t215 | \n\t\t216 |   tags {\n\t\t217 |     Name            = \"${var.stackname}-mapit\"\n\t\t218 |     Project         = \"${var.stackname}\"\n\t\t219 |     Device          = \"xvdf\"\n\t\t220 |     aws_hostname    = \"mapit-1\"\n\t\t221 |     aws_migration   = \"mapit\"\n\t\t222 |     aws_stackname   = \"${var.stackname}\"\n\t\t223 |     aws_environment = \"${var.aws_environment}\"\n\t\t224 |   }\n\t\t225 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mapit-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mapit/main.tf:246-261\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t246 | resource \"aws_ebs_volume\" \"mapit-2\" {\n\t\t247 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mapit_subnet_b)}\"\n\t\t248 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t249 |   size              = 20\n\t\t250 |   type              = \"gp2\"\n\t\t251 | \n\t\t252 |   tags {\n\t\t253 |     Name            = \"${var.stackname}-mapit\"\n\t\t254 |     Project         = \"${var.stackname}\"\n\t\t255 |     Device          = \"xvdf\"\n\t\t256 |     aws_hostname    = \"mapit-2\"\n\t\t257 |     aws_migration   = \"mapit\"\n\t\t258 |     aws_stackname   = \"${var.stackname}\"\n\t\t259 |     aws_environment = \"${var.aws_environment}\"\n\t\t260 |   }\n\t\t261 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mirrorer\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mirrorer/main.tf:80-95\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t80 | resource \"aws_ebs_volume\" \"mirrorer\" {\n\t\t81 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mirrorer_subnet)}\"\n\t\t82 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t83 |   size              = \"${var.mirrorer_ebs_size}\"\n\t\t84 |   type              = \"gp2\"\n\t\t85 | \n\t\t86 |   tags {\n\t\t87 |     Name            = \"${var.stackname}-mirrorer\"\n\t\t88 |     Project         = \"${var.stackname}\"\n\t\t89 |     Device          = \"xvdf\"\n\t\t90 |     aws_hostname    = \"mirrorer-1\"\n\t\t91 |     aws_migration   = \"mirrorer\"\n\t\t92 |     aws_stackname   = \"${var.stackname}\"\n\t\t93 |     aws_environment = \"${var.aws_environment}\"\n\t\t94 |   }\n\t\t95 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mongo-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mongo/main.tf:156-172\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t156 | resource \"aws_ebs_volume\" \"mongo-1\" {\n\t\t157 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mongo_1_subnet)}\"\n\t\t158 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t159 |   type              = \"gp2\"\n\t\t160 |   size              = 300\n\t\t161 | \n\t\t162 |   tags {\n\t\t163 |     Name            = \"${var.stackname}-mongo-1\"\n\t\t164 |     Project         = \"${var.stackname}\"\n\t\t165 |     ManagedBy       = \"terraform\"\n\t\t166 |     aws_stackname   = \"${var.stackname}\"\n\t\t167 |     aws_environment = \"${var.aws_environment}\"\n\t\t168 |     aws_migration   = \"mongo\"\n\t\t169 |     aws_hostname    = \"mongo-1\"\n\t\t170 |     Device          = \"xvdf\"\n\t\t171 |   }\n\t\t172 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mongo-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mongo/main.tf:213-229\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t213 | resource \"aws_ebs_volume\" \"mongo-2\" {\n\t\t214 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mongo_2_subnet)}\"\n\t\t215 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t216 |   type              = \"gp2\"\n\t\t217 |   size              = 300\n\t\t218 | \n\t\t219 |   tags {\n\t\t220 |     Name            = \"${var.stackname}-mongo-2\"\n\t\t221 |     Project         = \"${var.stackname}\"\n\t\t222 |     ManagedBy       = \"terraform\"\n\t\t223 |     aws_stackname   = \"${var.stackname}\"\n\t\t224 |     aws_environment = \"${var.aws_environment}\"\n\t\t225 |     aws_migration   = \"mongo\"\n\t\t226 |     aws_hostname    = \"mongo-2\"\n\t\t227 |     Device          = \"xvdf\"\n\t\t228 |   }\n\t\t229 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mongo-3\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mongo/main.tf:270-286\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t270 | resource \"aws_ebs_volume\" \"mongo-3\" {\n\t\t271 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mongo_3_subnet)}\"\n\t\t272 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t273 |   type              = \"gp2\"\n\t\t274 |   size              = 300\n\t\t275 | \n\t\t276 |   tags {\n\t\t277 |     Name            = \"${var.stackname}-mongo-3\"\n\t\t278 |     Project         = \"${var.stackname}\"\n\t\t279 |     ManagedBy       = \"terraform\"\n\t\t280 |     aws_stackname   = \"${var.stackname}\"\n\t\t281 |     aws_environment = \"${var.aws_environment}\"\n\t\t282 |     aws_migration   = \"mongo\"\n\t\t283 |     aws_hostname    = \"mongo-3\"\n\t\t284 |     Device          = \"xvdf\"\n\t\t285 |   }\n\t\t286 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.monitoring\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-monitoring/main.tf:235-251\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t235 | resource \"aws_ebs_volume\" \"monitoring\" {\n\t\t236 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.monitoring_subnet)}\"\n\t\t237 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t238 |   type              = \"gp2\"\n\t\t239 |   size              = 40\n\t\t240 | \n\t\t241 |   tags {\n\t\t242 |     Name            = \"${var.stackname}-monitoring\"\n\t\t243 |     Project         = \"${var.stackname}\"\n\t\t244 |     ManagedBy       = \"terraform\"\n\t\t245 |     aws_stackname   = \"${var.stackname}\"\n\t\t246 |     aws_environment = \"${var.aws_environment}\"\n\t\t247 |     aws_migration   = \"monitoring\"\n\t\t248 |     aws_hostname    = \"monitoring-1\"\n\t\t249 |     Device          = \"xvdf\"\n\t\t250 |   }\n\t\t251 | }\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/alphagov-govuk-aws-8d7d2ebe0dbe9ebf8009572d1d710c4700cf245e/before-9a9204e88f88cb2a98b671081d6b039e048d23cd/terraform/projects/infra-fastly-logs/main.tfֿ\n\n",
        "stderr": "2024-06-21 12:20:40,343 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/alphagov/csw-client-role.git:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:20:40,343 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/alphagov/tech-ops.git?ref=13f54e5//cyber-security/modules/gds_security_audit_role:None (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 63.87683633499546
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 21, Failed checks: 10, Skipped checks: 0, Parsing errors: 1\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.ci-agent-1-data\n\tFile: /terraform/projects/app-ci-agents/main.tf:229-244\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.ci-agent-1-docker\n\tFile: /terraform/projects/app-ci-agents/main.tf:246-261\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.ci-agent-2-data\n\tFile: /terraform/projects/app-ci-agents/main.tf:349-364\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.ci-agent-2-docker\n\tFile: /terraform/projects/app-ci-agents/main.tf:366-381\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.ci-agent-3-data\n\tFile: /terraform/projects/app-ci-agents/main.tf:475-490\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.ci-agent-3-docker\n\tFile: /terraform/projects/app-ci-agents/main.tf:492-507\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.ci-agent-4-data\n\tFile: /terraform/projects/app-ci-agents/main.tf:595-610\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.ci-agent-4-docker\n\tFile: /terraform/projects/app-ci-agents/main.tf:612-627\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.ci-agent-5-data\n\tFile: /terraform/projects/app-ci-agents/main.tf:715-730\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.ci-agent-5-docker\n\tFile: /terraform/projects/app-ci-agents/main.tf:732-747\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.ci-agent-6-data\n\tFile: /terraform/projects/app-ci-agents/main.tf:835-850\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.ci-agent-6-docker\n\tFile: /terraform/projects/app-ci-agents/main.tf:852-867\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.ci-agent-7-data\n\tFile: /terraform/projects/app-ci-agents/main.tf:955-970\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.ci-agent-7-docker\n\tFile: /terraform/projects/app-ci-agents/main.tf:972-987\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.ci-agent-8-data\n\tFile: /terraform/projects/app-ci-agents/main.tf:1075-1090\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.ci-agent-8-docker\n\tFile: /terraform/projects/app-ci-agents/main.tf:1092-1107\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.ci-master\n\tFile: /terraform/projects/app-ci-master/main.tf:262-277\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.graphite-1\n\tFile: /terraform/projects/app-graphite/main.tf:286-302\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.mapit-3\n\tFile: /terraform/projects/app-mapit/main.tf:282-297\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.mapit-4\n\tFile: /terraform/projects/app-mapit/main.tf:318-333\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.prometheus-1\n\tFile: /terraform/projects/app-prometheus/main.tf:90-104\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.apt\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-apt/main.tf:207-222\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t207 | resource \"aws_ebs_volume\" \"apt\" {\n\t\t208 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.apt_1_subnet)}\"\n\t\t209 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t210 |   size              = \"${var.ebs_volume_size}\"\n\t\t211 |   type              = \"gp2\"\n\t\t212 | \n\t\t213 |   tags {\n\t\t214 |     Name            = \"${var.stackname}-apt\"\n\t\t215 |     Project         = \"${var.stackname}\"\n\t\t216 |     Device          = \"xvdf\"\n\t\t217 |     aws_hostname    = \"apt-1\"\n\t\t218 |     aws_migration   = \"apt\"\n\t\t219 |     aws_stackname   = \"${var.stackname}\"\n\t\t220 |     aws_environment = \"${var.aws_environment}\"\n\t\t221 |   }\n\t\t222 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.ckan\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-ckan/main.tf:212-228\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t212 | resource \"aws_ebs_volume\" \"ckan\" {\n\t\t213 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.ckan_subnet)}\"\n\t\t214 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t215 |   type              = \"gp2\"\n\t\t216 |   size              = 20\n\t\t217 | \n\t\t218 |   tags {\n\t\t219 |     Name            = \"${var.stackname}-ckan\"\n\t\t220 |     Project         = \"${var.stackname}\"\n\t\t221 |     ManagedBy       = \"terraform\"\n\t\t222 |     aws_stackname   = \"${var.stackname}\"\n\t\t223 |     aws_environment = \"${var.aws_environment}\"\n\t\t224 |     aws_migration   = \"ckan\"\n\t\t225 |     aws_hostname    = \"ckan-1\"\n\t\t226 |     Device          = \"xvdf\"\n\t\t227 |   }\n\t\t228 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.deploy\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-deploy/main.tf:252-267\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t252 | resource \"aws_ebs_volume\" \"deploy\" {\n\t\t253 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.deploy_subnet)}\"\n\t\t254 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t255 |   size              = 40\n\t\t256 |   type              = \"gp2\"\n\t\t257 | \n\t\t258 |   tags {\n\t\t259 |     Name            = \"${var.stackname}-deploy\"\n\t\t260 |     Project         = \"${var.stackname}\"\n\t\t261 |     Device          = \"xvdf\"\n\t\t262 |     aws_hostname    = \"jenkins-1\"\n\t\t263 |     aws_migration   = \"jenkins\"\n\t\t264 |     aws_stackname   = \"${var.stackname}\"\n\t\t265 |     aws_environment = \"${var.aws_environment}\"\n\t\t266 |   }\n\t\t267 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mapit-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mapit/main.tf:210-225\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t210 | resource \"aws_ebs_volume\" \"mapit-1\" {\n\t\t211 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mapit_subnet_a)}\"\n\t\t212 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t213 |   size              = 20\n\t\t214 |   type              = \"gp2\"\n\t\t215 | \n\t\t216 |   tags {\n\t\t217 |     Name            = \"${var.stackname}-mapit\"\n\t\t218 |     Project         = \"${var.stackname}\"\n\t\t219 |     Device          = \"xvdf\"\n\t\t220 |     aws_hostname    = \"mapit-1\"\n\t\t221 |     aws_migration   = \"mapit\"\n\t\t222 |     aws_stackname   = \"${var.stackname}\"\n\t\t223 |     aws_environment = \"${var.aws_environment}\"\n\t\t224 |   }\n\t\t225 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mapit-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mapit/main.tf:246-261\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t246 | resource \"aws_ebs_volume\" \"mapit-2\" {\n\t\t247 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mapit_subnet_b)}\"\n\t\t248 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t249 |   size              = 20\n\t\t250 |   type              = \"gp2\"\n\t\t251 | \n\t\t252 |   tags {\n\t\t253 |     Name            = \"${var.stackname}-mapit\"\n\t\t254 |     Project         = \"${var.stackname}\"\n\t\t255 |     Device          = \"xvdf\"\n\t\t256 |     aws_hostname    = \"mapit-2\"\n\t\t257 |     aws_migration   = \"mapit\"\n\t\t258 |     aws_stackname   = \"${var.stackname}\"\n\t\t259 |     aws_environment = \"${var.aws_environment}\"\n\t\t260 |   }\n\t\t261 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mirrorer\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mirrorer/main.tf:80-95\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t80 | resource \"aws_ebs_volume\" \"mirrorer\" {\n\t\t81 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mirrorer_subnet)}\"\n\t\t82 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t83 |   size              = \"${var.mirrorer_ebs_size}\"\n\t\t84 |   type              = \"gp2\"\n\t\t85 | \n\t\t86 |   tags {\n\t\t87 |     Name            = \"${var.stackname}-mirrorer\"\n\t\t88 |     Project         = \"${var.stackname}\"\n\t\t89 |     Device          = \"xvdf\"\n\t\t90 |     aws_hostname    = \"mirrorer-1\"\n\t\t91 |     aws_migration   = \"mirrorer\"\n\t\t92 |     aws_stackname   = \"${var.stackname}\"\n\t\t93 |     aws_environment = \"${var.aws_environment}\"\n\t\t94 |   }\n\t\t95 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mongo-1\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mongo/main.tf:156-172\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t156 | resource \"aws_ebs_volume\" \"mongo-1\" {\n\t\t157 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mongo_1_subnet)}\"\n\t\t158 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t159 |   type              = \"gp2\"\n\t\t160 |   size              = 300\n\t\t161 | \n\t\t162 |   tags {\n\t\t163 |     Name            = \"${var.stackname}-mongo-1\"\n\t\t164 |     Project         = \"${var.stackname}\"\n\t\t165 |     ManagedBy       = \"terraform\"\n\t\t166 |     aws_stackname   = \"${var.stackname}\"\n\t\t167 |     aws_environment = \"${var.aws_environment}\"\n\t\t168 |     aws_migration   = \"mongo\"\n\t\t169 |     aws_hostname    = \"mongo-1\"\n\t\t170 |     Device          = \"xvdf\"\n\t\t171 |   }\n\t\t172 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mongo-2\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mongo/main.tf:213-229\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t213 | resource \"aws_ebs_volume\" \"mongo-2\" {\n\t\t214 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mongo_2_subnet)}\"\n\t\t215 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t216 |   type              = \"gp2\"\n\t\t217 |   size              = 300\n\t\t218 | \n\t\t219 |   tags {\n\t\t220 |     Name            = \"${var.stackname}-mongo-2\"\n\t\t221 |     Project         = \"${var.stackname}\"\n\t\t222 |     ManagedBy       = \"terraform\"\n\t\t223 |     aws_stackname   = \"${var.stackname}\"\n\t\t224 |     aws_environment = \"${var.aws_environment}\"\n\t\t225 |     aws_migration   = \"mongo\"\n\t\t226 |     aws_hostname    = \"mongo-2\"\n\t\t227 |     Device          = \"xvdf\"\n\t\t228 |   }\n\t\t229 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.mongo-3\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-mongo/main.tf:270-286\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t270 | resource \"aws_ebs_volume\" \"mongo-3\" {\n\t\t271 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.mongo_3_subnet)}\"\n\t\t272 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t273 |   type              = \"gp2\"\n\t\t274 |   size              = 300\n\t\t275 | \n\t\t276 |   tags {\n\t\t277 |     Name            = \"${var.stackname}-mongo-3\"\n\t\t278 |     Project         = \"${var.stackname}\"\n\t\t279 |     ManagedBy       = \"terraform\"\n\t\t280 |     aws_stackname   = \"${var.stackname}\"\n\t\t281 |     aws_environment = \"${var.aws_environment}\"\n\t\t282 |     aws_migration   = \"mongo\"\n\t\t283 |     aws_hostname    = \"mongo-3\"\n\t\t284 |     Device          = \"xvdf\"\n\t\t285 |   }\n\t\t286 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.monitoring\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/projects/app-monitoring/main.tf:235-251\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t235 | resource \"aws_ebs_volume\" \"monitoring\" {\n\t\t236 |   availability_zone = \"${lookup(data.terraform_remote_state.infra_networking.private_subnet_names_azs_map, var.monitoring_subnet)}\"\n\t\t237 |   encrypted         = \"${var.ebs_encrypted}\"\n\t\t238 |   type              = \"gp2\"\n\t\t239 |   size              = 40\n\t\t240 | \n\t\t241 |   tags {\n\t\t242 |     Name            = \"${var.stackname}-monitoring\"\n\t\t243 |     Project         = \"${var.stackname}\"\n\t\t244 |     ManagedBy       = \"terraform\"\n\t\t245 |     aws_stackname   = \"${var.stackname}\"\n\t\t246 |     aws_environment = \"${var.aws_environment}\"\n\t\t247 |     aws_migration   = \"monitoring\"\n\t\t248 |     aws_hostname    = \"monitoring-1\"\n\t\t249 |     Device          = \"xvdf\"\n\t\t250 |   }\n\t\t251 | }\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/alphagov-govuk-aws-8d7d2ebe0dbe9ebf8009572d1d710c4700cf245e/after/terraform/projects/infra-fastly-logs/main.tfֿ\n\n",
      "stderr": "2024-06-21 12:19:29,918 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/alphagov/csw-client-role.git:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:19:29,919 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/alphagov/tech-ops.git?ref=13f54e5//cyber-security/modules/gds_security_audit_role:None (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 70.29450851399451
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/greenbrian/musical-spork/commit/24c07bfd5c31438fff6374e9ba3d577e6402d777",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 6, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.admin-east.aws_instance.admin[0]\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /terraform/admin/main.tf:31-66\n\tCalling File: /terraform/main.tf:134-159\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t31 | resource \"aws_instance\" \"admin\" {\n\t\t32 |   ami               = \"${data.aws_ami.hashistack.id}\"\n\t\t33 |   instance_type     = \"t2.micro\"\n\t\t34 |   count             = 1\n\t\t35 |   subnet_id         = \"${var.subnet_ids[0]}\"\n\t\t36 |   key_name          = \"${var.ssh_key_name}\"\n\t\t37 |   source_dest_check = \"false\"\n\t\t38 | \n\t\t39 |   security_groups = [\n\t\t40 |     \"${aws_security_group.allow_all_admin.id}\",\n\t\t41 |   ]\n\t\t42 | \n\t\t43 |   associate_public_ip_address = true\n\t\t44 |   ebs_optimized               = false\n\t\t45 |   iam_instance_profile        = \"${var.instance_profile}\"\n\t\t46 | \n\t\t47 |   provisioner \"file\" {\n\t\t48 |     source      = \"${path.module}/nomad\"\n\t\t49 |     destination = \"/home/${var.ssh_user_name}\"\n\t\t50 | \n\t\t51 |     connection {\n\t\t52 |       type        = \"ssh\"\n\t\t53 |       user        = \"${var.ssh_user_name}\"\n\t\t54 |       private_key = \"${var.private_key_data}\"\n\t\t55 |     }\n\t\t56 |   }\n\t\t57 | \n\t\t58 |   tags {\n\t\t59 |     Environment-Name = \"${var.environment_name}\"\n\t\t60 |     role             = \"admin\"\n\t\t61 |     owner            = \"${var.owner}\"\n\t\t62 |     TTL              = \"${var.ttl}\"\n\t\t63 |   }\n\t\t64 | \n\t\t65 |   user_data = \"${data.template_file.admin.rendered}\"\n\t\t66 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.aviato.aws_instance.haproxy[0]\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /terraform/aviato/main.tf:31-55\n\tCalling File: /terraform/main.tf:200-219\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t31 | resource \"aws_instance\" \"haproxy\" {\n\t\t32 |   ami               = \"${data.aws_ami.hashistack.id}\"\n\t\t33 |   instance_type     = \"t2.small\"\n\t\t34 |   count             = 1\n\t\t35 |   subnet_id         = \"${var.subnet_ids[0]}\"\n\t\t36 |   key_name          = \"${var.ssh_key_name}\"\n\t\t37 |   source_dest_check = \"false\"\n\t\t38 | \n\t\t39 |   security_groups = [\n\t\t40 |     \"${aws_security_group.haproxy.id}\",\n\t\t41 |   ]\n\t\t42 | \n\t\t43 |   associate_public_ip_address = true\n\t\t44 |   ebs_optimized               = false\n\t\t45 |   iam_instance_profile        = \"${var.instance_profile}\"\n\t\t46 | \n\t\t47 |   tags {\n\t\t48 |     Environment-Name = \"${var.environment_name}\"\n\t\t49 |     role             = \"haproxy\"\n\t\t50 |     owner            = \"${var.owner}\"\n\t\t51 |     TTL              = \"${var.ttl}\"\n\t\t52 |   }\n\t\t53 | \n\t\t54 |   user_data = \"${data.template_file.haproxy.rendered}\"\n\t\t55 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.aviato.aws_instance.nginx[0]\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /terraform/aviato/main.tf:88-112\n\tCalling File: /terraform/main.tf:200-219\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t88  | resource \"aws_instance\" \"nginx\" {\n\t\t89  |   ami               = \"${data.aws_ami.hashistack.id}\"\n\t\t90  |   instance_type     = \"t2.small\"\n\t\t91  |   count             = \"${var.nginx_count}\"\n\t\t92  |   subnet_id         = \"${var.subnet_ids[0]}\"\n\t\t93  |   key_name          = \"${var.ssh_key_name}\"\n\t\t94  |   source_dest_check = \"false\"\n\t\t95  | \n\t\t96  |   security_groups = [\n\t\t97  |     \"${aws_security_group.nginx.id}\",\n\t\t98  |   ]\n\t\t99  | \n\t\t100 |   associate_public_ip_address = true\n\t\t101 |   ebs_optimized               = false\n\t\t102 |   iam_instance_profile        = \"${var.instance_profile}\"\n\t\t103 | \n\t\t104 |   tags {\n\t\t105 |     Environment-Name = \"${var.environment_name}\"\n\t\t106 |     role             = \"nginx\"\n\t\t107 |     owner            = \"${var.owner}\"\n\t\t108 |     TTL              = \"${var.ttl}\"\n\t\t109 |   }\n\t\t110 | \n\t\t111 |   user_data = \"${data.template_file.nginx.rendered}\"\n\t\t112 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.aviato.aws_instance.nginx[1]\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /terraform/aviato/main.tf:88-112\n\tCalling File: /terraform/main.tf:200-219\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t88  | resource \"aws_instance\" \"nginx\" {\n\t\t89  |   ami               = \"${data.aws_ami.hashistack.id}\"\n\t\t90  |   instance_type     = \"t2.small\"\n\t\t91  |   count             = \"${var.nginx_count}\"\n\t\t92  |   subnet_id         = \"${var.subnet_ids[0]}\"\n\t\t93  |   key_name          = \"${var.ssh_key_name}\"\n\t\t94  |   source_dest_check = \"false\"\n\t\t95  | \n\t\t96  |   security_groups = [\n\t\t97  |     \"${aws_security_group.nginx.id}\",\n\t\t98  |   ]\n\t\t99  | \n\t\t100 |   associate_public_ip_address = true\n\t\t101 |   ebs_optimized               = false\n\t\t102 |   iam_instance_profile        = \"${var.instance_profile}\"\n\t\t103 | \n\t\t104 |   tags {\n\t\t105 |     Environment-Name = \"${var.environment_name}\"\n\t\t106 |     role             = \"nginx\"\n\t\t107 |     owner            = \"${var.owner}\"\n\t\t108 |     TTL              = \"${var.ttl}\"\n\t\t109 |   }\n\t\t110 | \n\t\t111 |   user_data = \"${data.template_file.nginx.rendered}\"\n\t\t112 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.client-west.aws_instance.client[0]\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /terraform/client/main.tf:26-50\n\tCalling File: /terraform/main.tf:161-178\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t26 | resource \"aws_instance\" \"client\" {\n\t\t27 |   ami               = \"${data.aws_ami.hashistack.id}\"\n\t\t28 |   instance_type     = \"t2.micro\"\n\t\t29 |   count             = 1\n\t\t30 |   subnet_id         = \"${var.subnet_ids[0]}\"\n\t\t31 |   key_name          = \"${var.ssh_key_name}\"\n\t\t32 |   source_dest_check = \"false\"\n\t\t33 | \n\t\t34 |   security_groups = [\n\t\t35 |     \"${aws_security_group.allow_all_client.id}\",\n\t\t36 |   ]\n\t\t37 | \n\t\t38 |   associate_public_ip_address = true\n\t\t39 |   ebs_optimized               = false\n\t\t40 |   iam_instance_profile        = \"${var.instance_profile}\"\n\t\t41 | \n\t\t42 |   tags {\n\t\t43 |     Environment-Name = \"${var.environment_name}\"\n\t\t44 |     role             = \"client\"\n\t\t45 |     owner            = \"${var.owner}\"\n\t\t46 |     TTL              = \"${var.ttl}\"\n\t\t47 |   }\n\t\t48 | \n\t\t49 |   user_data = \"${data.template_file.client.rendered}\"\n\t\t50 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.mysql-database.aws_instance.db[0]\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /terraform/mysql-database/main.tf:31-55\n\tCalling File: /terraform/main.tf:180-198\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t31 | resource \"aws_instance\" \"db\" {\n\t\t32 |   ami               = \"${data.aws_ami.hashistack.id}\"\n\t\t33 |   instance_type     = \"t2.small\"\n\t\t34 |   count             = 1\n\t\t35 |   subnet_id         = \"${var.subnet_ids[0]}\"\n\t\t36 |   key_name          = \"${var.ssh_key_name}\"\n\t\t37 |   source_dest_check = \"false\"\n\t\t38 | \n\t\t39 |   security_groups = [\n\t\t40 |     \"${aws_security_group.allow_all_mysql.id}\",\n\t\t41 |   ]\n\t\t42 | \n\t\t43 |   associate_public_ip_address = true\n\t\t44 |   ebs_optimized               = false\n\t\t45 |   iam_instance_profile        = \"${var.instance_profile}\"\n\t\t46 | \n\t\t47 |   tags {\n\t\t48 |     Environment-Name = \"${var.environment_name}\"\n\t\t49 |     role             = \"database\"\n\t\t50 |     owner            = \"${var.owner}\"\n\t\t51 |     TTL              = \"${var.ttl}\"\n\t\t52 |   }\n\t\t53 | \n\t\t54 |   user_data = \"${data.template_file.db.rendered}\"\n\t\t55 | }\n\n\n",
        "stderr": "2024-06-21 12:21:51,441 [MainThread  ] [WARNI]  Failed to download module terraform-aws-modules/vpc/aws:None (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 8.671780927004875
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 4, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.aviato.aws_instance.haproxy[0]\n\tFile: /terraform/aviato/main.tf:31-56\n\tCalling File: /terraform/main.tf:201-220\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.aviato.aws_instance.nginx[0]\n\tFile: /terraform/aviato/main.tf:89-114\n\tCalling File: /terraform/main.tf:201-220\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.aviato.aws_instance.nginx[1]\n\tFile: /terraform/aviato/main.tf:89-114\n\tCalling File: /terraform/main.tf:201-220\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.mysql-database.aws_instance.db[0]\n\tFile: /terraform/mysql-database/main.tf:31-56\n\tCalling File: /terraform/main.tf:181-199\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.admin-east.aws_instance.admin[0]\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /terraform/admin/main.tf:31-67\n\tCalling File: /terraform/main.tf:134-159\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t31 | resource \"aws_instance\" \"admin\" {\n\t\t32 |   ami               = \"${data.aws_ami.hashistack.id}\"\n\t\t33 |   instance_type     = \"t2.micro\"\n\t\t34 |   count             = 1\n\t\t35 |   subnet_id         = \"${var.subnet_ids[0]}\"\n\t\t36 |   key_name          = \"${var.ssh_key_name}\"\n\t\t37 |   source_dest_check = \"false\"\n\t\t38 | \n\t\t39 |   security_groups = [\n\t\t40 |     \"${aws_security_group.allow_all_admin.id}\",\n\t\t41 |   ]\n\t\t42 | \n\t\t43 |   associate_public_ip_address = true\n\t\t44 |   ebs_optimized               = false\n\t\t45 |   iam_instance_profile        = \"${var.instance_profile}\"\n\t\t46 | \n\t\t47 |   provisioner \"file\" {\n\t\t48 |     source      = \"${path.module}/nomad\"\n\t\t49 |     destination = \"/home/${var.ssh_user_name}\"\n\t\t50 | \n\t\t51 |     connection {\n\t\t52 |       type        = \"ssh\"\n\t\t53 |       user        = \"${var.ssh_user_name}\"\n\t\t54 |       private_key = \"${var.private_key_data}\"\n\t\t55 |     }\n\t\t56 |   }\n\t\t57 | \n\t\t58 |   tags {\n\t\t59 |     Name             = \"${var.cluster_name} - admin\"\n\t\t60 |     Environment-Name = \"${var.environment_name}\"\n\t\t61 |     role             = \"admin\"\n\t\t62 |     owner            = \"${var.owner}\"\n\t\t63 |     TTL              = \"${var.ttl}\"\n\t\t64 |   }\n\t\t65 | \n\t\t66 |   user_data = \"${data.template_file.admin.rendered}\"\n\t\t67 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.client-west.aws_instance.client[0]\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /terraform/client/main.tf:26-51\n\tCalling File: /terraform/main.tf:161-179\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t26 | resource \"aws_instance\" \"client\" {\n\t\t27 |   ami               = \"${data.aws_ami.hashistack.id}\"\n\t\t28 |   instance_type     = \"t2.micro\"\n\t\t29 |   count             = 1\n\t\t30 |   subnet_id         = \"${var.subnet_ids[0]}\"\n\t\t31 |   key_name          = \"${var.ssh_key_name}\"\n\t\t32 |   source_dest_check = \"false\"\n\t\t33 | \n\t\t34 |   security_groups = [\n\t\t35 |     \"${aws_security_group.allow_all_client.id}\",\n\t\t36 |   ]\n\t\t37 | \n\t\t38 |   associate_public_ip_address = true\n\t\t39 |   ebs_optimized               = false\n\t\t40 |   iam_instance_profile        = \"${var.instance_profile}\"\n\t\t41 | \n\t\t42 |   tags {\n\t\t43 |     Name             = \"${var.cluster_name} - client\"\n\t\t44 |     Environment-Name = \"${var.environment_name}\"\n\t\t45 |     role             = \"client\"\n\t\t46 |     owner            = \"${var.owner}\"\n\t\t47 |     TTL              = \"${var.ttl}\"\n\t\t48 |   }\n\t\t49 | \n\t\t50 |   user_data = \"${data.template_file.client.rendered}\"\n\t\t51 | }\n\n\n",
      "stderr": "2024-06-21 12:21:42,590 [MainThread  ] [WARNI]  Failed to download module terraform-aws-modules/vpc/aws:None (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 8.977408822000143
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/dotancohen81/Rancher/commit/90944271b4e8bd46e3d42ac64bc4964a33a8fdc3",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 5, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_instance.rancherserver\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /aws/main.tf:128-138\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t128 | resource \"aws_instance\" \"rancherserver\" {\n\t\t129 |   ami             = \"${data.aws_ami.ubuntu.id}\"\n\t\t130 |   instance_type   = \"${var.type}\"\n\t\t131 |   key_name        = \"${var.ssh_key_name}\"\n\t\t132 |   security_groups = [\"${aws_security_group.rancher_sg_allowall.name}\"]\n\t\t133 |   user_data       = \"${data.template_cloudinit_config.rancherserver-cloudinit.rendered}\"\n\t\t134 | \n\t\t135 |   tags {\n\t\t136 |     Name = \"${var.prefix}-rancherserver\"\n\t\t137 |   }\n\t\t138 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_instance.rancheragent-all[0]\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /aws/main.tf:154-165\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t154 | resource \"aws_instance\" \"rancheragent-all\" {\n\t\t155 |   count           = \"${var.count_agent_all_nodes}\"\n\t\t156 |   ami             = \"${data.aws_ami.ubuntu.id}\"\n\t\t157 |   instance_type   = \"${var.type}\"\n\t\t158 |   key_name        = \"${var.ssh_key_name}\"\n\t\t159 |   security_groups = [\"${aws_security_group.rancher_sg_allowall.name}\"]\n\t\t160 |   user_data       = \"${data.template_cloudinit_config.rancheragent-all-cloudinit.*.rendered[count.index]}\"\n\t\t161 | \n\t\t162 |   tags {\n\t\t163 |     Name = \"${var.prefix}-rancheragent-${count.index}-all\"\n\t\t164 |   }\n\t\t165 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_instance.rancheragent-etcd\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /aws/main.tf:181-192\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t181 | resource \"aws_instance\" \"rancheragent-etcd\" {\n\t\t182 |   count           = \"${var.count_agent_etcd_nodes}\"\n\t\t183 |   ami             = \"${data.aws_ami.ubuntu.id}\"\n\t\t184 |   instance_type   = \"${var.type}\"\n\t\t185 |   key_name        = \"${var.ssh_key_name}\"\n\t\t186 |   security_groups = [\"${aws_security_group.rancher_sg_allowall.name}\"]\n\t\t187 |   user_data       = \"${data.template_cloudinit_config.rancheragent-etcd-cloudinit.*.rendered[count.index]}\"\n\t\t188 | \n\t\t189 |   tags {\n\t\t190 |     Name = \"${var.prefix}-rancheragent-${count.index}-etcd\"\n\t\t191 |   }\n\t\t192 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_instance.rancheragent-controlplane\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /aws/main.tf:208-219\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t208 | resource \"aws_instance\" \"rancheragent-controlplane\" {\n\t\t209 |   count           = \"${var.count_agent_controlplane_nodes}\"\n\t\t210 |   ami             = \"${data.aws_ami.ubuntu.id}\"\n\t\t211 |   instance_type   = \"${var.type}\"\n\t\t212 |   key_name        = \"${var.ssh_key_name}\"\n\t\t213 |   security_groups = [\"${aws_security_group.rancher_sg_allowall.name}\"]\n\t\t214 |   user_data     = \"${data.template_cloudinit_config.rancheragent-controlplane-cloudinit.*.rendered[count.index]}\"\n\t\t215 | \n\t\t216 |   tags {\n\t\t217 |     Name = \"${var.prefix}-rancheragent-${count.index}-controlplane\"\n\t\t218 |   }\n\t\t219 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_instance.rancheragent-worker\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /aws/main.tf:235-246\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t235 | resource \"aws_instance\" \"rancheragent-worker\" {\n\t\t236 |   count           = \"${var.count_agent_worker_nodes}\"\n\t\t237 |   ami             = \"${data.aws_ami.ubuntu.id}\"\n\t\t238 |   instance_type   = \"${var.type}\"\n\t\t239 |   key_name        = \"${var.ssh_key_name}\"\n\t\t240 |   security_groups = [\"${aws_security_group.rancher_sg_allowall.name}\"]\n\t\t241 |   user_data       = \"${data.template_cloudinit_config.rancheragent-worker-cloudinit.*.rendered[count.index]}\"\n\t\t242 | \n\t\t243 |   tags {\n\t\t244 |     Name = \"${var.prefix}-rancheragent-${count.index}-worker\"\n\t\t245 |   }\n\t\t246 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 7.027401438012021
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 5, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_instance.rancherserver\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /aws/main.tf:128-138\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t128 | resource \"aws_instance\" \"rancherserver\" {\n\t\t129 |   ami             = \"${data.aws_ami.ubuntu.id}\"\n\t\t130 |   instance_type   = \"${var.type}\"\n\t\t131 |   key_name        = \"${var.ssh_key_name}\"\n\t\t132 |   security_groups = [\"${aws_security_group.rancher_sg_allowall.name}\"]\n\t\t133 |   user_data       = \"${data.template_cloudinit_config.rancherserver-cloudinit.rendered}\"\n\t\t134 | \n\t\t135 |   tags {\n\t\t136 |     Name = \"${var.prefix}-rancherserver\"\n\t\t137 |   }\n\t\t138 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_instance.rancheragent-all[0]\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /aws/main.tf:154-165\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t154 | resource \"aws_instance\" \"rancheragent-all\" {\n\t\t155 |   count           = \"${var.count_agent_all_nodes}\"\n\t\t156 |   ami             = \"${data.aws_ami.ubuntu.id}\"\n\t\t157 |   instance_type   = \"${var.type}\"\n\t\t158 |   key_name        = \"${var.ssh_key_name}\"\n\t\t159 |   security_groups = [\"${aws_security_group.rancher_sg_allowall.name}\"]\n\t\t160 |   user_data       = \"${data.template_cloudinit_config.rancheragent-all-cloudinit.*.rendered[count.index]}\"\n\t\t161 | \n\t\t162 |   tags {\n\t\t163 |     Name = \"${var.prefix}-rancheragent-${count.index}-all\"\n\t\t164 |   }\n\t\t165 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_instance.rancheragent-etcd\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /aws/main.tf:181-192\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t181 | resource \"aws_instance\" \"rancheragent-etcd\" {\n\t\t182 |   count           = \"${var.count_agent_etcd_nodes}\"\n\t\t183 |   ami             = \"${data.aws_ami.ubuntu.id}\"\n\t\t184 |   instance_type   = \"${var.type}\"\n\t\t185 |   key_name        = \"${var.ssh_key_name}\"\n\t\t186 |   security_groups = [\"${aws_security_group.rancher_sg_allowall.name}\"]\n\t\t187 |   user_data       = \"${data.template_cloudinit_config.rancheragent-etcd-cloudinit.*.rendered[count.index]}\"\n\t\t188 | \n\t\t189 |   tags {\n\t\t190 |     Name = \"${var.prefix}-rancheragent-${count.index}-etcd\"\n\t\t191 |   }\n\t\t192 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_instance.rancheragent-controlplane\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /aws/main.tf:208-219\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t208 | resource \"aws_instance\" \"rancheragent-controlplane\" {\n\t\t209 |   count           = \"${var.count_agent_controlplane_nodes}\"\n\t\t210 |   ami             = \"${data.aws_ami.ubuntu.id}\"\n\t\t211 |   instance_type   = \"${var.type}\"\n\t\t212 |   key_name        = \"${var.ssh_key_name}\"\n\t\t213 |   security_groups = [\"${aws_security_group.rancher_sg_allowall.name}\"]\n\t\t214 |   user_data     = \"${data.template_cloudinit_config.rancheragent-controlplane-cloudinit.*.rendered[count.index]}\"\n\t\t215 | \n\t\t216 |   tags {\n\t\t217 |     Name = \"${var.prefix}-rancheragent-${count.index}-controlplane\"\n\t\t218 |   }\n\t\t219 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_instance.rancheragent-worker\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /aws/main.tf:235-246\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t235 | resource \"aws_instance\" \"rancheragent-worker\" {\n\t\t236 |   count           = \"${var.count_agent_worker_nodes}\"\n\t\t237 |   ami             = \"${data.aws_ami.ubuntu.id}\"\n\t\t238 |   instance_type   = \"${var.type}\"\n\t\t239 |   key_name        = \"${var.ssh_key_name}\"\n\t\t240 |   security_groups = [\"${aws_security_group.rancher_sg_allowall.name}\"]\n\t\t241 |   user_data       = \"${data.template_cloudinit_config.rancheragent-worker-cloudinit.*.rendered[count.index]}\"\n\t\t242 | \n\t\t243 |   tags {\n\t\t244 |     Name = \"${var.prefix}-rancheragent-${count.index}-worker\"\n\t\t245 |   }\n\t\t246 | }\n\n\n",
      "stderr": "",
      "duration_seconds": 6.656685612004367
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/cisagov/cyhy_amis/commit/7b8d9247a679295e0e1791b13d6c437c473e44b8",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 14, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.bod_bastion\n\tFile: /terraform/bod_bastion_ec2.tf:2-34\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.bod_docker\n\tFile: /terraform/bod_docker_ec2.tf:123-155\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.bod_report_data\n\tFile: /terraform/bod_docker_ec2.tf:193-203\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.cyhy_bastion\n\tFile: /terraform/cyhy_bastion_ec2.tf:2-34\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.cyhy_dashboard\n\tFile: /terraform/cyhy_dashboard_ec2.tf:25-56\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.cyhy_mongo[0]\n\tFile: /terraform/cyhy_mongo_ec2.tf:112-147\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.cyhy_mongo_data\n\tFile: /terraform/cyhy_mongo_ec2.tf:184-196\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.cyhy_mongo_journal\n\tFile: /terraform/cyhy_mongo_ec2.tf:198-210\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.cyhy_mongo_log\n\tFile: /terraform/cyhy_mongo_ec2.tf:212-224\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.cyhy_nessus\n\tFile: /terraform/cyhy_nessus_ec2.tf:23-62\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.cyhy_nmap\n\tFile: /terraform/cyhy_nmap_ec2.tf:23-62\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.cyhy_reporter\n\tFile: /terraform/cyhy_reporter_ec2.tf:74-107\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.cyhy_reporter_data\n\tFile: /terraform/cyhy_reporter_ec2.tf:140-150\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.nessus[0]\n\tFile: /terraform_nessus_only/nessus_ec2.tf:23-51\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.nessus_cyhy_runner_data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/cyhy_nessus_ec2.tf:124-137\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t124 | resource \"aws_ebs_volume\" \"nessus_cyhy_runner_data\" {\n\t\t125 |   count             = length(aws_instance.cyhy_nessus)\n\t\t126 |   availability_zone = \"${var.aws_region}${var.aws_availability_zone}\"\n\t\t127 | \n\t\t128 |   type      = \"gp2\"\n\t\t129 |   size      = local.production_workspace ? 2 : 1\n\t\t130 |   encrypted = true\n\t\t131 | \n\t\t132 |   tags = { \"Name\" = format(\"CyHy Nessus - vulnscan%d\", count.index + 1) }\n\t\t133 | \n\t\t134 |   lifecycle {\n\t\t135 |     prevent_destroy = true\n\t\t136 |   }\n\t\t137 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_ebs_volume.nmap_cyhy_runner_data\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /terraform/cyhy_nmap_ec2.tf:126-140\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t126 | resource \"aws_ebs_volume\" \"nmap_cyhy_runner_data\" {\n\t\t127 |   count             = length(aws_instance.cyhy_nmap)\n\t\t128 |   availability_zone = \"${var.aws_region}${var.aws_availability_zone}\"\n\t\t129 | \n\t\t130 |   # availability_zone = \"${element(data.aws_availability_zones.all.names, count.index)}\"\n\t\t131 |   type      = \"gp2\"\n\t\t132 |   size      = local.production_workspace ? 2 : 1\n\t\t133 |   encrypted = true\n\t\t134 | \n\t\t135 |   tags = { \"Name\" = format(\"CyHy Nmap - portscan%d\", count.index + 1) }\n\t\t136 | \n\t\t137 |   lifecycle {\n\t\t138 |     prevent_destroy = true\n\t\t139 |   }\n\t\t140 | }\n\n\n",
        "stderr": "2024-06-21 12:22:27,467 [MainThread  ] [WARNI]  Failed to download module github.com/cloudposse/terraform-null-ansible:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:22:27,468 [MainThread  ] [WARNI]  Failed to download module transcend-io/lambda-at-edge/aws:0.4.0 (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 14.300059859000612
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 16, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.bod_bastion\n\tFile: /terraform/bod_bastion_ec2.tf:2-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.bod_docker\n\tFile: /terraform/bod_docker_ec2.tf:123-154\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.bod_report_data\n\tFile: /terraform/bod_docker_ec2.tf:192-202\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.cyhy_bastion\n\tFile: /terraform/cyhy_bastion_ec2.tf:2-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.cyhy_dashboard\n\tFile: /terraform/cyhy_dashboard_ec2.tf:25-55\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.cyhy_mongo[0]\n\tFile: /terraform/cyhy_mongo_ec2.tf:112-146\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.cyhy_mongo_data\n\tFile: /terraform/cyhy_mongo_ec2.tf:183-195\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.cyhy_mongo_journal\n\tFile: /terraform/cyhy_mongo_ec2.tf:197-209\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.cyhy_mongo_log\n\tFile: /terraform/cyhy_mongo_ec2.tf:211-223\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.cyhy_nessus\n\tFile: /terraform/cyhy_nessus_ec2.tf:23-61\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.nessus_cyhy_runner_data\n\tFile: /terraform/cyhy_nessus_ec2.tf:123-136\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.cyhy_nmap\n\tFile: /terraform/cyhy_nmap_ec2.tf:23-61\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.nmap_cyhy_runner_data\n\tFile: /terraform/cyhy_nmap_ec2.tf:125-139\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.cyhy_reporter\n\tFile: /terraform/cyhy_reporter_ec2.tf:74-106\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.cyhy_reporter_data\n\tFile: /terraform/cyhy_reporter_ec2.tf:139-149\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.nessus[0]\n\tFile: /terraform_nessus_only/nessus_ec2.tf:23-50\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n",
      "stderr": "2024-06-21 12:22:13,880 [MainThread  ] [WARNI]  Failed to download module github.com/cloudposse/terraform-null-ansible:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:22:13,881 [MainThread  ] [WARNI]  Failed to download module transcend-io/lambda-at-edge/aws:0.4.0 (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 13.619021195991081
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/yardbirdsax/elasticsearch-the-hard-way/commit/521bae59a4002a616eac44c1681ca5066bbd00c8",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.masterNode.aws_instance.instance[0]\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /terraform/modules/node-module/main.tf:13-26\n\tCalling File: /terraform/main.tf:72-81\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t13 | resource aws_instance \"instance\" {\n\t\t14 |   \n\t\t15 |   ami = var.amiId\n\t\t16 |   instance_type = \"t2.small\"\n\t\t17 |   tags = {\n\t\t18 |     Name = \"${var.instanceName}-${count.index}\"\n\t\t19 |   }\n\t\t20 |   count = var.nodeCount\n\t\t21 |   subnet_id = var.subnetId\n\t\t22 |   vpc_security_group_ids = [var.securityGroupId]\n\t\t23 |   key_name = var.keyName\n\t\t24 |   user_data = data.template_cloudinit_config.userData[count.index].rendered\n\t\t25 |   #user_data = data.template_cloudinit_config.esInit[count.index].rendered\n\t\t26 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 5.798749492998468
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.masterNode.aws_instance.instance[0]\n\tFile: /terraform/modules/node-module/main.tf:13-26\n\tCalling File: /terraform/main.tf:72-82\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n",
      "stderr": "",
      "duration_seconds": 6.528356005001115
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/GBergeret/tf-vpc-module/commit/34d80ece7d0ef598414baffceb074c6580dd819b",
    "before": [
      {
        "return_code": 0,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 0, Skipped checks: 0, Parsing errors: 1\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/GBergeret-tf-vpc-module-34d80ece7d0ef598414baffceb074c6580dd819b/before-607693e973e4fcb65456a53a6fb610bdbc889c6f/test/fixtures/wrapper/test.tfֿ\n\n",
        "stderr": "",
        "duration_seconds": 5.694572424996295
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 0, Skipped checks: 0, Parsing errors: 1\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/GBergeret-tf-vpc-module-34d80ece7d0ef598414baffceb074c6580dd819b/after/test/fixtures/wrapper/test.tfֿ\n\n",
      "stderr": "",
      "duration_seconds": 6.396599100000458
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/cisagov/vulnerable-instances/commit/f70410061b8c6b9249895571e05dfb7a142efb18",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_instance.vuln_ubuntu1404\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /terraform/ubuntu1404_ec2.tf:25-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t25 | resource \"aws_instance\" \"vuln_ubuntu1404\" {\n\t\t26 |   ami               = data.aws_ami.metasploitable3_ubuntu1404.id\n\t\t27 |   instance_type     = \"t2.micro\"\n\t\t28 |   availability_zone = \"${var.aws_region}${var.aws_availability_zone}\"\n\t\t29 | \n\t\t30 |   subnet_id                   = aws_subnet.vuln_subnet.id\n\t\t31 |   associate_public_ip_address = true\n\t\t32 | \n\t\t33 |   root_block_device {\n\t\t34 |     volume_type           = \"gp2\"\n\t\t35 |     volume_size           = 100\n\t\t36 |     delete_on_termination = true\n\t\t37 |   }\n\t\t38 | \n\t\t39 |   vpc_security_group_ids = [\n\t\t40 |     aws_security_group.vuln_ubuntu1404_sg.id,\n\t\t41 |   ]\n\t\t42 | \n\t\t43 |   user_data_base64 = data.template_cloudinit_config.ssh_cloud_init_tasks.rendered\n\t\t44 | \n\t\t45 |   tags = merge(\n\t\t46 |     var.tags,\n\t\t47 |     {\n\t\t48 |       \"Name\" = \"Vulnerable Ubuntu 14.04\"\n\t\t49 |     },\n\t\t50 |   )\n\t\t51 |   volume_tags = merge(\n\t\t52 |     var.tags,\n\t\t53 |     {\n\t\t54 |       \"Name\" = \"Vulnerable Ubuntu 14.04\"\n\t\t55 |     },\n\t\t56 |   )\n\t\t57 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 6.556151942990255
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_instance.vuln_ubuntu1404\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /terraform/ubuntu1404_ec2.tf:25-56\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t25 | resource \"aws_instance\" \"vuln_ubuntu1404\" {\n\t\t26 |   ami               = data.aws_ami.metasploitable3_ubuntu1404.id\n\t\t27 |   instance_type     = \"t2.micro\"\n\t\t28 |   availability_zone = \"${var.aws_region}${var.aws_availability_zone}\"\n\t\t29 | \n\t\t30 |   subnet_id                   = aws_subnet.vuln_subnet.id\n\t\t31 |   associate_public_ip_address = true\n\t\t32 | \n\t\t33 |   root_block_device {\n\t\t34 |     volume_size = 100\n\t\t35 |     volume_type = \"gp3\"\n\t\t36 |   }\n\t\t37 | \n\t\t38 |   vpc_security_group_ids = [\n\t\t39 |     aws_security_group.vuln_ubuntu1404_sg.id,\n\t\t40 |   ]\n\t\t41 | \n\t\t42 |   user_data_base64 = data.template_cloudinit_config.ssh_cloud_init_tasks.rendered\n\t\t43 | \n\t\t44 |   tags = merge(\n\t\t45 |     var.tags,\n\t\t46 |     {\n\t\t47 |       \"Name\" = \"Vulnerable Ubuntu 14.04\"\n\t\t48 |     },\n\t\t49 |   )\n\t\t50 |   volume_tags = merge(\n\t\t51 |     var.tags,\n\t\t52 |     {\n\t\t53 |       \"Name\" = \"Vulnerable Ubuntu 14.04\"\n\t\t54 |     },\n\t\t55 |   )\n\t\t56 | }\n\n\n",
      "stderr": "",
      "duration_seconds": 5.961316726010409
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/dwp/dataworks-aws-data-egress/commit/14f065e5161fee14c286c34df7db9f5516ef9bb6",
    "before": [
      {
        "return_code": 0,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\n\n",
        "stderr": "",
        "duration_seconds": 6.599625725008082
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\n\n",
      "stderr": "",
      "duration_seconds": 6.6935286710067885
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/circleci/enterprise-setup/commit/26cc5295c2bb9d8756e450712e0f5f75af440c4a",
    "before": [
      {
        "return_code": 0,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.services\n\tFile: /circleci.tf:280-309\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n",
        "stderr": "",
        "duration_seconds": 7.499856540001929
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.services\n\tFile: /circleci.tf:280-309\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n",
      "stderr": "",
      "duration_seconds": 7.476024054994923
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/bh1m2rn/gitlab-environment-toolkit/commit/b9750f0bb88bc22256085b6bc8f060055e90a8c4",
    "before": [
      {
        "return_code": 0,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\n\n",
        "stderr": "",
        "duration_seconds": 17.480633122002473
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\n\n",
      "stderr": "",
      "duration_seconds": 17.328769375002594
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/travis-ci/terraform-config/commit/4f641b162fa877aef842481631906d5bfe874781",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 10, Failed checks: 6, Skipped checks: 0, Parsing errors: 2\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.aws_az_1b.module.workers_com.aws_instance.nat\n\tFile: /modules/aws_az/workers/main.tf:45-57\n\tCalling File: /modules/aws_az/main.tf:128-140\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.aws_az_1e.module.workers_com.aws_instance.nat\n\tFile: /modules/aws_az/workers/main.tf:45-57\n\tCalling File: /modules/aws_az/main.tf:128-140\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.aws_az_1a.module.workers_com.aws_instance.nat\n\tFile: /modules/aws_az/workers/main.tf:45-57\n\tCalling File: /modules/aws_az/main.tf:128-140\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.aws_az_1c.module.workers_com.aws_instance.nat\n\tFile: /modules/aws_az/workers/main.tf:45-57\n\tCalling File: /modules/aws_az/main.tf:128-140\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.aws_az_1b.module.workers_org.aws_instance.nat\n\tFile: /modules/aws_az/workers/main.tf:45-57\n\tCalling File: /modules/aws_az/main.tf:114-126\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.aws_az_1e.module.workers_org.aws_instance.nat\n\tFile: /modules/aws_az/workers/main.tf:45-57\n\tCalling File: /modules/aws_az/main.tf:114-126\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.aws_az_1a.module.workers_org.aws_instance.nat\n\tFile: /modules/aws_az/workers/main.tf:45-57\n\tCalling File: /modules/aws_az/main.tf:114-126\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.aws_az_1c.module.workers_org.aws_instance.nat\n\tFile: /modules/aws_az/workers/main.tf:45-57\n\tCalling File: /modules/aws_az/main.tf:114-126\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.registry_1b.aws_ebs_volume.data\n\tFile: /modules/aws_docker_registry/main.tf:59-65\n\tCalling File: /aws-shared-1/main.tf:217-233\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.registry_1e.aws_ebs_volume.data\n\tFile: /modules/aws_docker_registry/main.tf:59-65\n\tCalling File: /aws-shared-1/main.tf:235-251\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.aws_az_1b.aws_instance.bastion\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /modules/aws_az/main.tf:88-99\n\tCalling File: /aws-shared-2/main.tf:122-142\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t88 | resource \"aws_instance\" \"bastion\" {\n\t\t89 |   ami = \"${var.bastion_ami}\"\n\t\t90 |   instance_type = \"t2.micro\"\n\t\t91 |   subnet_id = \"${aws_subnet.public.id}\"\n\t\t92 |   vpc_security_group_ids = [\n\t\t93 |     \"${aws_security_group.bastion.id}\",\n\t\t94 |   ]\n\t\t95 |   tags = {\n\t\t96 |     Name = \"${var.env}-${var.index}-bastion-${var.az}\"\n\t\t97 |   }\n\t\t98 |   user_data = \"${data.template_file.bastion_cloud_config.rendered}\"\n\t\t99 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.aws_az_1e.aws_instance.bastion\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /modules/aws_az/main.tf:88-99\n\tCalling File: /aws-shared-2/main.tf:166-186\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t88 | resource \"aws_instance\" \"bastion\" {\n\t\t89 |   ami = \"${var.bastion_ami}\"\n\t\t90 |   instance_type = \"t2.micro\"\n\t\t91 |   subnet_id = \"${aws_subnet.public.id}\"\n\t\t92 |   vpc_security_group_ids = [\n\t\t93 |     \"${aws_security_group.bastion.id}\",\n\t\t94 |   ]\n\t\t95 |   tags = {\n\t\t96 |     Name = \"${var.env}-${var.index}-bastion-${var.az}\"\n\t\t97 |   }\n\t\t98 |   user_data = \"${data.template_file.bastion_cloud_config.rendered}\"\n\t\t99 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.aws_az_1a.aws_instance.bastion\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /modules/aws_az/main.tf:88-99\n\tCalling File: /aws-shared-2/main.tf:100-120\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t88 | resource \"aws_instance\" \"bastion\" {\n\t\t89 |   ami = \"${var.bastion_ami}\"\n\t\t90 |   instance_type = \"t2.micro\"\n\t\t91 |   subnet_id = \"${aws_subnet.public.id}\"\n\t\t92 |   vpc_security_group_ids = [\n\t\t93 |     \"${aws_security_group.bastion.id}\",\n\t\t94 |   ]\n\t\t95 |   tags = {\n\t\t96 |     Name = \"${var.env}-${var.index}-bastion-${var.az}\"\n\t\t97 |   }\n\t\t98 |   user_data = \"${data.template_file.bastion_cloud_config.rendered}\"\n\t\t99 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.aws_az_1c.aws_instance.bastion\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /modules/aws_az/main.tf:88-99\n\tCalling File: /aws-shared-2/main.tf:144-164\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t88 | resource \"aws_instance\" \"bastion\" {\n\t\t89 |   ami = \"${var.bastion_ami}\"\n\t\t90 |   instance_type = \"t2.micro\"\n\t\t91 |   subnet_id = \"${aws_subnet.public.id}\"\n\t\t92 |   vpc_security_group_ids = [\n\t\t93 |     \"${aws_security_group.bastion.id}\",\n\t\t94 |   ]\n\t\t95 |   tags = {\n\t\t96 |     Name = \"${var.env}-${var.index}-bastion-${var.az}\"\n\t\t97 |   }\n\t\t98 |   user_data = \"${data.template_file.bastion_cloud_config.rendered}\"\n\t\t99 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.registry_1b.aws_instance.registry\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /modules/aws_docker_registry/main.tf:67-77\n\tCalling File: /aws-shared-1/main.tf:217-233\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t67 | resource \"aws_instance\" \"registry\" {\n\t\t68 |   ami = \"${var.ami}\"\n\t\t69 |   instance_type = \"${var.instance_type}\"\n\t\t70 |   subnet_id = \"${var.public_subnet_id}\"\n\t\t71 |   vpc_security_group_ids = [\"${aws_security_group.registry.id}\"]\n\t\t72 |   associate_public_ip_address = false\n\t\t73 |   tags = {\n\t\t74 |     Name = \"${var.env}-${var.index}-registry-${var.az}\"\n\t\t75 |   }\n\t\t76 |   user_data = \"${data.template_file.cloud_config.rendered}\"\n\t\t77 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.registry_1e.aws_instance.registry\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /modules/aws_docker_registry/main.tf:67-77\n\tCalling File: /aws-shared-1/main.tf:235-251\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t67 | resource \"aws_instance\" \"registry\" {\n\t\t68 |   ami = \"${var.ami}\"\n\t\t69 |   instance_type = \"${var.instance_type}\"\n\t\t70 |   subnet_id = \"${var.public_subnet_id}\"\n\t\t71 |   vpc_security_group_ids = [\"${aws_security_group.registry.id}\"]\n\t\t72 |   associate_public_ip_address = false\n\t\t73 |   tags = {\n\t\t74 |     Name = \"${var.env}-${var.index}-registry-${var.az}\"\n\t\t75 |   }\n\t\t76 |   user_data = \"${data.template_file.cloud_config.rendered}\"\n\t\t77 | }\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/travis-ci-terraform-config-4f641b162fa877aef842481631906d5bfe874781/before-bef9d1b48f394c6b8660bb1270ba99c601e607f6/modules/gce_worker/workers-com.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/travis-ci-terraform-config-4f641b162fa877aef842481631906d5bfe874781/before-bef9d1b48f394c6b8660bb1270ba99c601e607f6/modules/gce_worker/workers-org.tfֿ\n\n",
        "stderr": "",
        "duration_seconds": 10.39371304299857
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 10, Failed checks: 6, Skipped checks: 0, Parsing errors: 2\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.aws_az_1b.module.workers_com.aws_instance.nat\n\tFile: /modules/aws_az/workers/main.tf:45-57\n\tCalling File: /modules/aws_az/main.tf:128-140\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.aws_az_1e.module.workers_com.aws_instance.nat\n\tFile: /modules/aws_az/workers/main.tf:45-57\n\tCalling File: /modules/aws_az/main.tf:128-140\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.aws_az_1a.module.workers_com.aws_instance.nat\n\tFile: /modules/aws_az/workers/main.tf:45-57\n\tCalling File: /modules/aws_az/main.tf:128-140\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.aws_az_1c.module.workers_com.aws_instance.nat\n\tFile: /modules/aws_az/workers/main.tf:45-57\n\tCalling File: /modules/aws_az/main.tf:128-140\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.aws_az_1b.module.workers_org.aws_instance.nat\n\tFile: /modules/aws_az/workers/main.tf:45-57\n\tCalling File: /modules/aws_az/main.tf:114-126\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.aws_az_1e.module.workers_org.aws_instance.nat\n\tFile: /modules/aws_az/workers/main.tf:45-57\n\tCalling File: /modules/aws_az/main.tf:114-126\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.aws_az_1a.module.workers_org.aws_instance.nat\n\tFile: /modules/aws_az/workers/main.tf:45-57\n\tCalling File: /modules/aws_az/main.tf:114-126\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.aws_az_1c.module.workers_org.aws_instance.nat\n\tFile: /modules/aws_az/workers/main.tf:45-57\n\tCalling File: /modules/aws_az/main.tf:114-126\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.registry_1b.aws_ebs_volume.data\n\tFile: /modules/aws_docker_registry/main.tf:59-65\n\tCalling File: /aws-shared-1/main.tf:217-233\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.registry_1e.aws_ebs_volume.data\n\tFile: /modules/aws_docker_registry/main.tf:59-65\n\tCalling File: /aws-shared-1/main.tf:235-251\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.aws_az_1b.aws_instance.bastion\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /modules/aws_az/main.tf:88-99\n\tCalling File: /aws-shared-2/main.tf:122-142\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t88 | resource \"aws_instance\" \"bastion\" {\n\t\t89 |   ami = \"${var.bastion_ami}\"\n\t\t90 |   instance_type = \"t2.micro\"\n\t\t91 |   subnet_id = \"${aws_subnet.public.id}\"\n\t\t92 |   vpc_security_group_ids = [\n\t\t93 |     \"${aws_security_group.bastion.id}\",\n\t\t94 |   ]\n\t\t95 |   tags = {\n\t\t96 |     Name = \"${var.env}-${var.index}-bastion-${var.az}\"\n\t\t97 |   }\n\t\t98 |   user_data = \"${data.template_file.bastion_cloud_config.rendered}\"\n\t\t99 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.aws_az_1e.aws_instance.bastion\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /modules/aws_az/main.tf:88-99\n\tCalling File: /aws-shared-2/main.tf:166-186\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t88 | resource \"aws_instance\" \"bastion\" {\n\t\t89 |   ami = \"${var.bastion_ami}\"\n\t\t90 |   instance_type = \"t2.micro\"\n\t\t91 |   subnet_id = \"${aws_subnet.public.id}\"\n\t\t92 |   vpc_security_group_ids = [\n\t\t93 |     \"${aws_security_group.bastion.id}\",\n\t\t94 |   ]\n\t\t95 |   tags = {\n\t\t96 |     Name = \"${var.env}-${var.index}-bastion-${var.az}\"\n\t\t97 |   }\n\t\t98 |   user_data = \"${data.template_file.bastion_cloud_config.rendered}\"\n\t\t99 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.aws_az_1a.aws_instance.bastion\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /modules/aws_az/main.tf:88-99\n\tCalling File: /aws-shared-2/main.tf:100-120\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t88 | resource \"aws_instance\" \"bastion\" {\n\t\t89 |   ami = \"${var.bastion_ami}\"\n\t\t90 |   instance_type = \"t2.micro\"\n\t\t91 |   subnet_id = \"${aws_subnet.public.id}\"\n\t\t92 |   vpc_security_group_ids = [\n\t\t93 |     \"${aws_security_group.bastion.id}\",\n\t\t94 |   ]\n\t\t95 |   tags = {\n\t\t96 |     Name = \"${var.env}-${var.index}-bastion-${var.az}\"\n\t\t97 |   }\n\t\t98 |   user_data = \"${data.template_file.bastion_cloud_config.rendered}\"\n\t\t99 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.aws_az_1c.aws_instance.bastion\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /modules/aws_az/main.tf:88-99\n\tCalling File: /aws-shared-2/main.tf:144-164\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t88 | resource \"aws_instance\" \"bastion\" {\n\t\t89 |   ami = \"${var.bastion_ami}\"\n\t\t90 |   instance_type = \"t2.micro\"\n\t\t91 |   subnet_id = \"${aws_subnet.public.id}\"\n\t\t92 |   vpc_security_group_ids = [\n\t\t93 |     \"${aws_security_group.bastion.id}\",\n\t\t94 |   ]\n\t\t95 |   tags = {\n\t\t96 |     Name = \"${var.env}-${var.index}-bastion-${var.az}\"\n\t\t97 |   }\n\t\t98 |   user_data = \"${data.template_file.bastion_cloud_config.rendered}\"\n\t\t99 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.registry_1b.aws_instance.registry\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /modules/aws_docker_registry/main.tf:67-77\n\tCalling File: /aws-shared-1/main.tf:217-233\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t67 | resource \"aws_instance\" \"registry\" {\n\t\t68 |   ami = \"${var.ami}\"\n\t\t69 |   instance_type = \"${var.instance_type}\"\n\t\t70 |   subnet_id = \"${var.public_subnet_id}\"\n\t\t71 |   vpc_security_group_ids = [\"${aws_security_group.registry.id}\"]\n\t\t72 |   associate_public_ip_address = false\n\t\t73 |   tags = {\n\t\t74 |     Name = \"${var.env}-${var.index}-registry-${var.az}\"\n\t\t75 |   }\n\t\t76 |   user_data = \"${data.template_file.cloud_config.rendered}\"\n\t\t77 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.registry_1e.aws_instance.registry\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /modules/aws_docker_registry/main.tf:67-77\n\tCalling File: /aws-shared-1/main.tf:235-251\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t67 | resource \"aws_instance\" \"registry\" {\n\t\t68 |   ami = \"${var.ami}\"\n\t\t69 |   instance_type = \"${var.instance_type}\"\n\t\t70 |   subnet_id = \"${var.public_subnet_id}\"\n\t\t71 |   vpc_security_group_ids = [\"${aws_security_group.registry.id}\"]\n\t\t72 |   associate_public_ip_address = false\n\t\t73 |   tags = {\n\t\t74 |     Name = \"${var.env}-${var.index}-registry-${var.az}\"\n\t\t75 |   }\n\t\t76 |   user_data = \"${data.template_file.cloud_config.rendered}\"\n\t\t77 | }\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/travis-ci-terraform-config-4f641b162fa877aef842481631906d5bfe874781/after/modules/gce_worker/workers-com.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/travis-ci-terraform-config-4f641b162fa877aef842481631906d5bfe874781/after/modules/gce_worker/workers-org.tfֿ\n\n",
      "stderr": "",
      "duration_seconds": 13.832591707992833
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/byu-oit/terraform-aws-rds/commit/86a0795540edb426c3226775d73fcd4ce807d36a",
    "before": [
      {
        "return_code": 0,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\n\n",
        "stderr": "2024-06-21 12:24:49,030 [MainThread  ] [WARNI]  Failed to download module github.com/byu-oit/terraform-aws-acs-info.git?ref=v3.0.0:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:24:49,031 [MainThread  ] [WARNI]  Failed to download module github.com/byu-oit/terraform-aws-acs-info.git?ref=v3.1.0:None (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 4.427119521002169
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\n\n",
      "stderr": "2024-06-21 12:24:44,613 [MainThread  ] [WARNI]  Failed to download module github.com/byu-oit/terraform-aws-acs-info.git?ref=v3.0.0:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:24:44,614 [MainThread  ] [WARNI]  Failed to download module github.com/byu-oit/terraform-aws-acs-info.git?ref=v3.1.0:None (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 4.364715550997062
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/poseidon/terraform-azure-kubernetes/commit/633eb938742a43be09612b944c29aaaf70dac119",
    "before": [
      {
        "return_code": 0,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\n\n",
        "stderr": "2024-06-21 12:24:58,789 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/poseidon/terraform-render-bootkube.git?ref=98cc19f80f2c4c3ddc63fc7aea6320e74bec561a:None (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 5.3579803639877355
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\n\n",
      "stderr": "2024-06-21 12:24:53,431 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/poseidon/terraform-render-bootkube.git?ref=98cc19f80f2c4c3ddc63fc7aea6320e74bec561a:None (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 4.604079202996218
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/poseidon/terraform-aws-kubernetes/commit/e09126b45746f1c967d1990fa04ce781a0478c6d",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_instance.controllers[0]\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /controllers.tf:17-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t17 | resource \"aws_instance\" \"controllers\" {\n\t\t18 |   count = \"${var.controller_count}\"\n\t\t19 | \n\t\t20 |   tags = {\n\t\t21 |     Name = \"${var.cluster_name}-controller-${count.index}\"\n\t\t22 |   }\n\t\t23 | \n\t\t24 |   instance_type = \"${var.controller_type}\"\n\t\t25 | \n\t\t26 |   ami       = \"${local.ami_id}\"\n\t\t27 |   user_data = \"${element(data.ct_config.controller-ignitions.*.rendered, count.index)}\"\n\t\t28 | \n\t\t29 |   # storage\n\t\t30 |   root_block_device {\n\t\t31 |     volume_type = \"${var.disk_type}\"\n\t\t32 |     volume_size = \"${var.disk_size}\"\n\t\t33 |     iops        = \"${var.disk_iops}\"\n\t\t34 |   }\n\t\t35 | \n\t\t36 |   # network\n\t\t37 |   associate_public_ip_address = true\n\t\t38 |   subnet_id                   = \"${element(aws_subnet.public.*.id, count.index)}\"\n\t\t39 |   vpc_security_group_ids      = [\"${aws_security_group.controller.id}\"]\n\t\t40 | \n\t\t41 |   lifecycle {\n\t\t42 |     ignore_changes = [\n\t\t43 |       \"ami\",\n\t\t44 |       \"user_data\",\n\t\t45 |     ]\n\t\t46 |   }\n\t\t47 | }\n\n\n",
        "stderr": "2024-06-21 12:25:08,831 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/poseidon/terraform-render-bootkube.git?ref=d14348a368298b7c8b0878accba4974cce5401f9:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:25:08,832 [MainThread  ] [WARNI]  Failed to download module workers:None (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 4.615521568004624
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.controllers[0]\n\tFile: /controllers.tf:17-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n",
      "stderr": "2024-06-21 12:25:04,173 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/poseidon/terraform-render-bootkube.git?ref=d14348a368298b7c8b0878accba4974cce5401f9:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:25:04,174 [MainThread  ] [WARNI]  Failed to download module workers:None (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 5.402629080999759
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/deadlysyn/terraform-keycloak-aws/commit/1c982ac4120ae3ed5a88c38f2a4d568ad9a83d22",
    "before": [
      {
        "return_code": 0,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform_plan scan results:\n\nPassed checks: 0, Failed checks: 0, Skipped checks: 0, Parsing errors: 2\n\nError parsing file snapshots/deadlysyn-terraform-keycloak-aws-1c982ac4120ae3ed5a88c38f2a4d568ad9a83d22/before-94e9a38988e4c5d13aa537e66a7f9f3b3bce2e7e/modules/keycloak/templates/container_definition.jsonֿ\nError parsing file snapshots/deadlysyn-terraform-keycloak-aws-1c982ac4120ae3ed5a88c38f2a4d568ad9a83d22/before-94e9a38988e4c5d13aa537e66a7f9f3b3bce2e7e/modules/keycloak/templates/container_definition_datadog.jsonֿ\n\n",
        "stderr": "2024-06-21 12:25:19,460 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/cloudposse/terraform-aws-tfstate-backend.git?ref=tags/0.37.0:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:25:19,460 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/cloudposse/terraform-null-label.git?ref=tags/0.25.0:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:25:19,461 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/cloudposse/terraform-aws-alb.git?ref=tags/0.35.3:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:25:19,461 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/cloudposse/terraform-aws-ecr.git?ref=tags/0.32.3:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:25:19,462 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/cloudposse/terraform-aws-ecs-alb-service-task.git?ref=tags/0.56.0:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:25:19,462 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/cloudposse/terraform-aws-rds-cluster.git?ref=tags/0.46.2:None (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 5.322526338000898
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform_plan scan results:\n\nPassed checks: 0, Failed checks: 0, Skipped checks: 0, Parsing errors: 2\n\nError parsing file snapshots/deadlysyn-terraform-keycloak-aws-1c982ac4120ae3ed5a88c38f2a4d568ad9a83d22/after/modules/keycloak/templates/container_definition.jsonֿ\nError parsing file snapshots/deadlysyn-terraform-keycloak-aws-1c982ac4120ae3ed5a88c38f2a4d568ad9a83d22/after/modules/keycloak/templates/container_definition_datadog.jsonֿ\n\n",
      "stderr": "2024-06-21 12:25:14,216 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/cloudposse/terraform-aws-tfstate-backend.git?ref=tags/0.37.0:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:25:14,216 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/cloudposse/terraform-null-label.git?ref=tags/0.25.0:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:25:14,216 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/cloudposse/terraform-aws-alb.git?ref=tags/0.35.3:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:25:14,216 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/cloudposse/terraform-aws-ecr.git?ref=tags/0.32.3:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:25:14,216 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/cloudposse/terraform-aws-ecs-alb-service-task.git?ref=tags/0.56.0:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:25:14,217 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/cloudposse/terraform-aws-rds-cluster.git?ref=tags/0.46.2:None (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 6.054428892995929
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/ONSdigital/eq-terraform/commit/79845fe095cd87287346f40d2adce9b28a32ef35",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 2, Skipped checks: 0, Parsing errors: 4\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.survey-runner-queue.aws_instance.rabbitmq[0]\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /survey-runner-queue/message_queue.tf:1-27\n\tCalling File: /survey-runner.tf:616-640\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t1  | resource \"aws_instance\" \"rabbitmq\" {\n\t\t2  |   ami                         = \"ami-47a23a30\"\n\t\t3  |   iam_instance_profile        = \"${aws_iam_instance_profile.rabbitmq-instance-profile.name}\"\n\t\t4  |   count                       = 2\n\t\t5  |   instance_type               = \"${var.rabbitmq_instance_type}\"\n\t\t6  |   key_name                    = \"${var.aws_key_pair}\"\n\t\t7  |   subnet_id                   = \"${aws_subnet.queue.id}\"\n\t\t8  |   private_ip                  = \"${var.rabbitmq_ips[count.index]}\"\n\t\t9  |   associate_public_ip_address = true\n\t\t10 |   monitoring                  = true\n\t\t11 | \n\t\t12 |   vpc_security_group_ids = [\"${aws_security_group.rabbit_required.id}\",\n\t\t13 |     \"${aws_security_group.provision-allow-ssh-REMOVE.id}\",\n\t\t14 |     \"${aws_security_group.survey_runner_vpn_services_logging_auditing.id}\",\n\t\t15 |     \"${aws_security_group.survey_runner_vpn_sdx_access.id}\",\n\t\t16 |   ]\n\t\t17 | \n\t\t18 |   root_block_device {\n\t\t19 |     volume_type           = \"gp2\"\n\t\t20 |     delete_on_termination = \"${var.delete_volume_on_termination}\"\n\t\t21 |   }\n\t\t22 | \n\t\t23 |   tags {\n\t\t24 |     Name    = \"${var.env}-rabbitmq-${count.index + 1}\"\n\t\t25 |     Service = \"${var.env}-RabbitMQ\"\n\t\t26 |   }\n\t\t27 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.survey-runner-queue.aws_instance.rabbitmq[1]\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /survey-runner-queue/message_queue.tf:1-27\n\tCalling File: /survey-runner.tf:616-640\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t1  | resource \"aws_instance\" \"rabbitmq\" {\n\t\t2  |   ami                         = \"ami-47a23a30\"\n\t\t3  |   iam_instance_profile        = \"${aws_iam_instance_profile.rabbitmq-instance-profile.name}\"\n\t\t4  |   count                       = 2\n\t\t5  |   instance_type               = \"${var.rabbitmq_instance_type}\"\n\t\t6  |   key_name                    = \"${var.aws_key_pair}\"\n\t\t7  |   subnet_id                   = \"${aws_subnet.queue.id}\"\n\t\t8  |   private_ip                  = \"${var.rabbitmq_ips[count.index]}\"\n\t\t9  |   associate_public_ip_address = true\n\t\t10 |   monitoring                  = true\n\t\t11 | \n\t\t12 |   vpc_security_group_ids = [\"${aws_security_group.rabbit_required.id}\",\n\t\t13 |     \"${aws_security_group.provision-allow-ssh-REMOVE.id}\",\n\t\t14 |     \"${aws_security_group.survey_runner_vpn_services_logging_auditing.id}\",\n\t\t15 |     \"${aws_security_group.survey_runner_vpn_sdx_access.id}\",\n\t\t16 |   ]\n\t\t17 | \n\t\t18 |   root_block_device {\n\t\t19 |     volume_type           = \"gp2\"\n\t\t20 |     delete_on_termination = \"${var.delete_volume_on_termination}\"\n\t\t21 |   }\n\t\t22 | \n\t\t23 |   tags {\n\t\t24 |     Name    = \"${var.env}-rabbitmq-${count.index + 1}\"\n\t\t25 |     Service = \"${var.env}-RabbitMQ\"\n\t\t26 |   }\n\t\t27 | }\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/ONSdigital-eq-terraform-79845fe095cd87287346f40d2adce9b28a32ef35/before-fbbdc0b0654665f4717592aad90eace7b5fbb711/survey-runner-alerting/iam.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/ONSdigital-eq-terraform-79845fe095cd87287346f40d2adce9b28a32ef35/before-fbbdc0b0654665f4717592aad90eace7b5fbb711/survey-runner-application/iam.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/ONSdigital-eq-terraform-79845fe095cd87287346f40d2adce9b28a32ef35/before-fbbdc0b0654665f4717592aad90eace7b5fbb711/survey-runner-database/cloudwatch.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/ONSdigital-eq-terraform-79845fe095cd87287346f40d2adce9b28a32ef35/before-fbbdc0b0654665f4717592aad90eace7b5fbb711/survey-runner-queue/cloudwatch.tfֿ\n\n",
        "stderr": "2024-06-21 12:25:31,703 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/eq-terraform-ecs?ref=v4.0:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:25:31,703 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/eq-ecs-deploy?ref=v2.0:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:25:31,704 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/eq-terraform-elasticsearch:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:25:31,704 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/eq-terraform-dynamodb?ref=v2.0:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:25:31,704 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/ebs_bckup:None (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 5.883495486996253
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 2, Skipped checks: 0, Parsing errors: 4\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.survey-runner-queue.aws_instance.rabbitmq[0]\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /survey-runner-queue/message_queue.tf:1-27\n\tCalling File: /survey-runner.tf:616-640\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t1  | resource \"aws_instance\" \"rabbitmq\" {\n\t\t2  |   ami                         = \"ami-47a23a30\"\n\t\t3  |   iam_instance_profile        = \"${aws_iam_instance_profile.rabbitmq-instance-profile.name}\"\n\t\t4  |   count                       = 2\n\t\t5  |   instance_type               = \"${var.rabbitmq_instance_type}\"\n\t\t6  |   key_name                    = \"${var.aws_key_pair}\"\n\t\t7  |   subnet_id                   = \"${aws_subnet.queue.id}\"\n\t\t8  |   private_ip                  = \"${var.rabbitmq_ips[count.index]}\"\n\t\t9  |   associate_public_ip_address = true\n\t\t10 |   monitoring                  = true\n\t\t11 | \n\t\t12 |   vpc_security_group_ids = [\"${aws_security_group.rabbit_required.id}\",\n\t\t13 |     \"${aws_security_group.provision-allow-ssh-REMOVE.id}\",\n\t\t14 |     \"${aws_security_group.survey_runner_vpn_services_logging_auditing.id}\",\n\t\t15 |     \"${aws_security_group.survey_runner_vpn_sdx_access.id}\",\n\t\t16 |   ]\n\t\t17 | \n\t\t18 |   root_block_device {\n\t\t19 |     volume_type           = \"gp2\"\n\t\t20 |     delete_on_termination = \"${var.delete_volume_on_termination}\"\n\t\t21 |   }\n\t\t22 | \n\t\t23 |   tags {\n\t\t24 |     Name    = \"${var.env}-rabbitmq-${count.index + 1}\"\n\t\t25 |     Service = \"${var.env}-RabbitMQ\"\n\t\t26 |   }\n\t\t27 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.survey-runner-queue.aws_instance.rabbitmq[1]\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /survey-runner-queue/message_queue.tf:1-27\n\tCalling File: /survey-runner.tf:616-640\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t1  | resource \"aws_instance\" \"rabbitmq\" {\n\t\t2  |   ami                         = \"ami-47a23a30\"\n\t\t3  |   iam_instance_profile        = \"${aws_iam_instance_profile.rabbitmq-instance-profile.name}\"\n\t\t4  |   count                       = 2\n\t\t5  |   instance_type               = \"${var.rabbitmq_instance_type}\"\n\t\t6  |   key_name                    = \"${var.aws_key_pair}\"\n\t\t7  |   subnet_id                   = \"${aws_subnet.queue.id}\"\n\t\t8  |   private_ip                  = \"${var.rabbitmq_ips[count.index]}\"\n\t\t9  |   associate_public_ip_address = true\n\t\t10 |   monitoring                  = true\n\t\t11 | \n\t\t12 |   vpc_security_group_ids = [\"${aws_security_group.rabbit_required.id}\",\n\t\t13 |     \"${aws_security_group.provision-allow-ssh-REMOVE.id}\",\n\t\t14 |     \"${aws_security_group.survey_runner_vpn_services_logging_auditing.id}\",\n\t\t15 |     \"${aws_security_group.survey_runner_vpn_sdx_access.id}\",\n\t\t16 |   ]\n\t\t17 | \n\t\t18 |   root_block_device {\n\t\t19 |     volume_type           = \"gp2\"\n\t\t20 |     delete_on_termination = \"${var.delete_volume_on_termination}\"\n\t\t21 |   }\n\t\t22 | \n\t\t23 |   tags {\n\t\t24 |     Name    = \"${var.env}-rabbitmq-${count.index + 1}\"\n\t\t25 |     Service = \"${var.env}-RabbitMQ\"\n\t\t26 |   }\n\t\t27 | }\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/ONSdigital-eq-terraform-79845fe095cd87287346f40d2adce9b28a32ef35/after/survey-runner-alerting/iam.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/ONSdigital-eq-terraform-79845fe095cd87287346f40d2adce9b28a32ef35/after/survey-runner-application/iam.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/ONSdigital-eq-terraform-79845fe095cd87287346f40d2adce9b28a32ef35/after/survey-runner-database/cloudwatch.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/ONSdigital-eq-terraform-79845fe095cd87287346f40d2adce9b28a32ef35/after/survey-runner-queue/cloudwatch.tfֿ\n\n",
      "stderr": "2024-06-21 12:25:25,805 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/eq-terraform-ecs?ref=v4.0:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:25:25,805 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/eq-ecs-deploy?ref=v2.0:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:25:25,806 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/eq-terraform-elasticsearch:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:25:25,806 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/eq-terraform-dynamodb?ref=v2.0:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:25:25,806 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/ebs_bckup:None (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 6.859870091997436
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/kinvolk-archives/lokomotive-kubernetes/commit/f2f4deb8bb44988eeb0b64b919e51fb556aef4fb",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_instance.controllers[0]\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /aws/container-linux/kubernetes/controllers.tf:17-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t17 | resource \"aws_instance\" \"controllers\" {\n\t\t18 |   count = \"${var.controller_count}\"\n\t\t19 | \n\t\t20 |   tags = {\n\t\t21 |     Name = \"${var.cluster_name}-controller-${count.index}\"\n\t\t22 |   }\n\t\t23 | \n\t\t24 |   instance_type = \"${var.controller_type}\"\n\t\t25 | \n\t\t26 |   ami       = \"${local.ami_id}\"\n\t\t27 |   user_data = \"${element(data.ct_config.controller-ignitions.*.rendered, count.index)}\"\n\t\t28 | \n\t\t29 |   # storage\n\t\t30 |   root_block_device {\n\t\t31 |     volume_type = \"${var.disk_type}\"\n\t\t32 |     volume_size = \"${var.disk_size}\"\n\t\t33 |     iops        = \"${var.disk_iops}\"\n\t\t34 |   }\n\t\t35 | \n\t\t36 |   # network\n\t\t37 |   associate_public_ip_address = true\n\t\t38 |   subnet_id                   = \"${element(aws_subnet.public.*.id, count.index)}\"\n\t\t39 |   vpc_security_group_ids      = [\"${aws_security_group.controller.id}\"]\n\t\t40 | \n\t\t41 |   lifecycle {\n\t\t42 |     ignore_changes = [\n\t\t43 |       \"ami\",\n\t\t44 |       \"user_data\",\n\t\t45 |     ]\n\t\t46 |   }\n\t\t47 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_instance.controllers[0]\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /aws/fedora-atomic/kubernetes/controllers.tf:17-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t17 | resource \"aws_instance\" \"controllers\" {\n\t\t18 |   count = \"${var.controller_count}\"\n\t\t19 | \n\t\t20 |   tags = {\n\t\t21 |     Name = \"${var.cluster_name}-controller-${count.index}\"\n\t\t22 |   }\n\t\t23 | \n\t\t24 |   instance_type = \"${var.controller_type}\"\n\t\t25 | \n\t\t26 |   ami       = \"${data.aws_ami.fedora.image_id}\"\n\t\t27 |   user_data = \"${element(data.template_file.controller-cloudinit.*.rendered, count.index)}\"\n\t\t28 | \n\t\t29 |   # storage\n\t\t30 |   root_block_device {\n\t\t31 |     volume_type = \"${var.disk_type}\"\n\t\t32 |     volume_size = \"${var.disk_size}\"\n\t\t33 |     iops        = \"${var.disk_iops}\"\n\t\t34 |   }\n\t\t35 | \n\t\t36 |   # network\n\t\t37 |   associate_public_ip_address = true\n\t\t38 |   subnet_id                   = \"${element(aws_subnet.public.*.id, count.index)}\"\n\t\t39 |   vpc_security_group_ids      = [\"${aws_security_group.controller.id}\"]\n\t\t40 | \n\t\t41 |   lifecycle {\n\t\t42 |     ignore_changes = [\n\t\t43 |       \"ami\",\n\t\t44 |       \"user_data\",\n\t\t45 |     ]\n\t\t46 |   }\n\t\t47 | }\n\n\n",
        "stderr": "2024-06-21 12:25:48,225 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/poseidon/terraform-render-bootkube.git?ref=d14348a368298b7c8b0878accba4974cce5401f9:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:25:48,225 [MainThread  ] [WARNI]  Failed to download module workers:None (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 11.531034209998325
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.controllers[0]\n\tFile: /aws/container-linux/kubernetes/controllers.tf:17-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.controllers[0]\n\tFile: /aws/fedora-atomic/kubernetes/controllers.tf:17-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n",
      "stderr": "2024-06-21 12:25:37,544 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/poseidon/terraform-render-bootkube.git?ref=d14348a368298b7c8b0878accba4974cce5401f9:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:25:37,544 [MainThread  ] [WARNI]  Failed to download module workers:None (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 10.716477374007809
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/smarman85/a_new_hope/commit/de97a6b8033c866c3b711468207aa4890049daaa",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_instance.docker1\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /docker/ec2.tf:6-36\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t6  | resource \"aws_instance\" \"docker1\" {\n\t\t7  |   ami           = \"${var.AMI}\"\n\t\t8  |   instance_type = \"t2.micro\"\n\t\t9  | \n\t\t10 |   #VPC info\n\t\t11 |   subnet_id = \"${var.SUBNET_ID}\"\n\t\t12 | \n\t\t13 |   # Security Group\n\t\t14 |   vpc_security_group_ids = [\"${var.VPC_SECURITY_GROUP}\"]\n\t\t15 | \n\t\t16 |   # the public ssh key\n\t\t17 |   key_name = \"${aws_key_pair.key-pair.id}\"\n\t\t18 | \n\t\t19 |   # docker installation\n\t\t20 |   provisioner \"file\" {\n\t\t21 |     source      = \"docker.sh\"\n\t\t22 |     destination = \"/tmp/docker.sh\"\n\t\t23 |   }\n\t\t24 | \n\t\t25 |   provisioner \"remote-exec\" {\n\t\t26 |     inline = [\n\t\t27 |       \"chmod +x /tmp/docker.sh\",\n\t\t28 |       \"sudo /tmp/docker.sh\",\n\t\t29 |     ]\n\t\t30 |   }\n\t\t31 | \n\t\t32 |   connection {\n\t\t33 |     user        = \"${var.EC2_USER}\"\n\t\t34 |     private_key = \"${file(\"${path.module}/../infrastructure/${var.PRIVATE_KEY_PATH}\")}\"\n\t\t35 |   }\n\t\t36 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.ec2.aws_instance.ec2\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /modules/ec2/main.tf:1-28\n\tCalling File: /qa/main.tf:29-40\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t1  | resource \"aws_instance\" \"ec2\" {\n\t\t2  |   ami = var.AMI_ID\n\t\t3  |   instance_type = var.INSTANCE_TYPE\n\t\t4  | \n\t\t5  |   subnet_id = var.SUBNET_ID\n\t\t6  |   vpc_security_group_ids = var.VPC_SECURITY_GROUP\n\t\t7  |   \n\t\t8  |   # ssh public key\n\t\t9  |   key_name = aws_key_pair.key_pair.id\n\t\t10 | \n\t\t11 |   provisioner \"file\" {\n\t\t12 |     source = var.PROVISIONER_FILE\n\t\t13 |     destination = \"/tmp/provisioner.sh\"\n\t\t14 |   }\n\t\t15 |   \n\t\t16 |   provisioner \"remote-exec\" {\n\t\t17 |     inline = [\n\t\t18 |       \"chmod +x /tmp/provisioner.sh\",\n\t\t19 |       \"sudo /tmp/provisioner.sh\",\n\t\t20 |     ]\n\t\t21 |   }\n\t\t22 | \n\t\t23 |   connection {\n\t\t24 |     user = var.EC2_USER\n\t\t25 |     host = self.public_ip\n\t\t26 |     private_key = var.PRIVATE_KEY\n\t\t27 |   }\n\t\t28 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 4.718666711996775
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.ec2.aws_instance.ec2\n\tFile: /modules/ec2/main.tf:1-28\n\tCalling File: /qa/main.tf:29-40\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_instance.docker1\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /docker/ec2.tf:6-36\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t6  | resource \"aws_instance\" \"docker1\" {\n\t\t7  |   ami           = \"${var.AMI}\"\n\t\t8  |   instance_type = \"t2.micro\"\n\t\t9  | \n\t\t10 |   #VPC info\n\t\t11 |   subnet_id = \"${var.SUBNET_ID}\"\n\t\t12 | \n\t\t13 |   # Security Group\n\t\t14 |   vpc_security_group_ids = [\"${var.VPC_SECURITY_GROUP}\"]\n\t\t15 | \n\t\t16 |   # the public ssh key\n\t\t17 |   key_name = \"${aws_key_pair.key-pair.id}\"\n\t\t18 | \n\t\t19 |   # docker installation\n\t\t20 |   provisioner \"file\" {\n\t\t21 |     source      = \"docker.sh\"\n\t\t22 |     destination = \"/tmp/docker.sh\"\n\t\t23 |   }\n\t\t24 | \n\t\t25 |   provisioner \"remote-exec\" {\n\t\t26 |     inline = [\n\t\t27 |       \"chmod +x /tmp/docker.sh\",\n\t\t28 |       \"sudo /tmp/docker.sh\",\n\t\t29 |     ]\n\t\t30 |   }\n\t\t31 | \n\t\t32 |   connection {\n\t\t33 |     user        = \"${var.EC2_USER}\"\n\t\t34 |     private_key = \"${file(\"${path.module}/../infrastructure/${var.PRIVATE_KEY_PATH}\")}\"\n\t\t35 |   }\n\t\t36 | }\n\n\n",
      "stderr": "",
      "duration_seconds": 5.706176164996577
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/kmishra9/PL2-AWS-Setup/commit/0d7b5b0f6f92ff6cfde1f17ad96d1b1459a0957a",
    "before": [
      {
        "return_code": 0,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.EC2.aws_instance.EC2_analysis_instance\n\tFile: /EC2/main.tf:36-59\n\tCalling File: /main.tf:52-68\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.EC2.aws_ebs_volume.data_storage\n\tFile: /EC2/main.tf:62-69\n\tCalling File: /main.tf:52-68\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n",
        "stderr": "2024-06-21 12:26:15,934 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/cloudposse/terraform-aws-cloudtrail.git?ref=master:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:26:15,934 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/cloudposse/terraform-aws-cloudtrail-s3-bucket.git?ref=master:None (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 5.010643044995959
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.EC2.aws_instance.EC2_analysis_instance\n\tFile: /EC2/main.tf:36-59\n\tCalling File: /main.tf:52-68\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.EC2.aws_ebs_volume.data_storage\n\tFile: /EC2/main.tf:62-69\n\tCalling File: /main.tf:52-68\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n",
      "stderr": "2024-06-21 12:26:11,047 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/cloudposse/terraform-aws-cloudtrail.git?ref=master:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:26:11,047 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/cloudposse/terraform-aws-cloudtrail-s3-bucket.git?ref=master:None (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 5.695810516001075
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/cisagov/cool-sharedservices-nessus/commit/5403a8978053a1299b0afe8d7fc59e914fc5e354",
    "before": [
      {
        "return_code": 0,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\n\n",
        "stderr": "",
        "duration_seconds": 5.326368832000298
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\n\n",
      "stderr": "",
      "duration_seconds": 5.585669394000433
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/guillaumekh/wg-terraform-template/commit/effee9cbc473af5d07cfc3aacece50aa6e59753a",
    "before": [
      {
        "return_code": 0,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.aws-instance\n\tFile: /vpn.tf:84-117\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n",
        "stderr": "",
        "duration_seconds": 4.984441528009484
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.aws-instance\n\tFile: /vpn.tf:84-117\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n",
      "stderr": "",
      "duration_seconds": 5.1874186789937085
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/ninthnails/terraform-aws-camellia/commit/0019704e14723aaf326840ab36c594c3f514a2d4",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 4, Failed checks: 9, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.kafka.aws_instance.broker[0]\n\tFile: /cluster/kafka/kafka.tf:276-301\n\tCalling File: /cluster/cluster.tf:80-94\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.kafka.aws_instance.broker[1]\n\tFile: /cluster/kafka/kafka.tf:276-301\n\tCalling File: /cluster/cluster.tf:80-94\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.kafka.aws_instance.broker[2]\n\tFile: /cluster/kafka/kafka.tf:276-301\n\tCalling File: /cluster/cluster.tf:80-94\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.manager.aws_instance.server\n\tFile: /cluster/manager/manager.tf:203-215\n\tCalling File: /cluster/cluster.tf:96-113\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.kafka.aws_ebs_volume.storage1[0]\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /cluster/kafka/kafka.tf:191-208\n\tCalling File: /cluster/cluster.tf:80-94\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t191 | resource \"aws_ebs_volume\" \"storage1\" {\n\t\t192 |   count = var.cluster_size * local.storage_ebs_flag\n\t\t193 |   availability_zone = element(data.aws_subnet.private.*.availability_zone, count.index % length(data.aws_subnet.private.*.availability_zone))\n\t\t194 |   encrypted = true\n\t\t195 |   kms_key_id = data.aws_kms_key.provided.arn\n\t\t196 |   size = var.storage_volume_size\n\t\t197 |   type = var.storage_volume_type\n\t\t198 |   tags = merge(var.tags, map(\"Name\", \"${var.prefix}-kafka-broker-${local.broker_ids[count.index]}-d1\"))\n\t\t199 |   lifecycle {\n\t\t200 |     ignore_changes = [\n\t\t201 |       \"encrypted\",\n\t\t202 |       \"iops\",\n\t\t203 |       \"kms_key_id\",\n\t\t204 |       \"snapshot_id\",\n\t\t205 |       \"type\"\n\t\t206 |     ]\n\t\t207 |   }\n\t\t208 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.kafka.aws_ebs_volume.storage2[0]\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /cluster/kafka/kafka.tf:210-227\n\tCalling File: /cluster/cluster.tf:80-94\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t210 | resource \"aws_ebs_volume\" \"storage2\" {\n\t\t211 |   count = var.cluster_size * local.storage_ebs_flag\n\t\t212 |   availability_zone = element(data.aws_subnet.private.*.availability_zone, count.index % length(data.aws_subnet.private.*.availability_zone))\n\t\t213 |   encrypted = true\n\t\t214 |   kms_key_id = data.aws_kms_key.provided.arn\n\t\t215 |   size = var.storage_volume_size\n\t\t216 |   type = var.storage_volume_type\n\t\t217 |   tags = merge(var.tags, map(\"Name\", \"${var.prefix}-kafka-broker-${local.broker_ids[count.index]}-d2\"))\n\t\t218 |   lifecycle {\n\t\t219 |     ignore_changes = [\n\t\t220 |       \"encrypted\",\n\t\t221 |       \"iops\",\n\t\t222 |       \"kms_key_id\",\n\t\t223 |       \"snapshot_id\",\n\t\t224 |       \"type\"\n\t\t225 |     ]\n\t\t226 |   }\n\t\t227 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.kafka.aws_ebs_volume.storage3[0]\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /cluster/kafka/kafka.tf:229-246\n\tCalling File: /cluster/cluster.tf:80-94\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t229 | resource \"aws_ebs_volume\" \"storage3\" {\n\t\t230 |   count = var.cluster_size * local.storage_ebs_flag\n\t\t231 |   availability_zone = element(data.aws_subnet.private.*.availability_zone, count.index % length(data.aws_subnet.private.*.availability_zone))\n\t\t232 |   encrypted = true\n\t\t233 |   kms_key_id = data.aws_kms_key.provided.arn\n\t\t234 |   size = var.storage_volume_size\n\t\t235 |   type = var.storage_volume_type\n\t\t236 |   tags = merge(var.tags, map(\"Name\", \"${var.prefix}-kafka-broker-${local.broker_ids[count.index]}-d3\"))\n\t\t237 |   lifecycle {\n\t\t238 |     ignore_changes = [\n\t\t239 |       \"encrypted\",\n\t\t240 |       \"iops\",\n\t\t241 |       \"kms_key_id\",\n\t\t242 |       \"snapshot_id\",\n\t\t243 |       \"type\"\n\t\t244 |     ]\n\t\t245 |   }\n\t\t246 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.kafka.aws_ebs_volume.storage1[1]\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /cluster/kafka/kafka.tf:191-208\n\tCalling File: /cluster/cluster.tf:80-94\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t191 | resource \"aws_ebs_volume\" \"storage1\" {\n\t\t192 |   count = var.cluster_size * local.storage_ebs_flag\n\t\t193 |   availability_zone = element(data.aws_subnet.private.*.availability_zone, count.index % length(data.aws_subnet.private.*.availability_zone))\n\t\t194 |   encrypted = true\n\t\t195 |   kms_key_id = data.aws_kms_key.provided.arn\n\t\t196 |   size = var.storage_volume_size\n\t\t197 |   type = var.storage_volume_type\n\t\t198 |   tags = merge(var.tags, map(\"Name\", \"${var.prefix}-kafka-broker-${local.broker_ids[count.index]}-d1\"))\n\t\t199 |   lifecycle {\n\t\t200 |     ignore_changes = [\n\t\t201 |       \"encrypted\",\n\t\t202 |       \"iops\",\n\t\t203 |       \"kms_key_id\",\n\t\t204 |       \"snapshot_id\",\n\t\t205 |       \"type\"\n\t\t206 |     ]\n\t\t207 |   }\n\t\t208 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.kafka.aws_ebs_volume.storage1[2]\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /cluster/kafka/kafka.tf:191-208\n\tCalling File: /cluster/cluster.tf:80-94\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t191 | resource \"aws_ebs_volume\" \"storage1\" {\n\t\t192 |   count = var.cluster_size * local.storage_ebs_flag\n\t\t193 |   availability_zone = element(data.aws_subnet.private.*.availability_zone, count.index % length(data.aws_subnet.private.*.availability_zone))\n\t\t194 |   encrypted = true\n\t\t195 |   kms_key_id = data.aws_kms_key.provided.arn\n\t\t196 |   size = var.storage_volume_size\n\t\t197 |   type = var.storage_volume_type\n\t\t198 |   tags = merge(var.tags, map(\"Name\", \"${var.prefix}-kafka-broker-${local.broker_ids[count.index]}-d1\"))\n\t\t199 |   lifecycle {\n\t\t200 |     ignore_changes = [\n\t\t201 |       \"encrypted\",\n\t\t202 |       \"iops\",\n\t\t203 |       \"kms_key_id\",\n\t\t204 |       \"snapshot_id\",\n\t\t205 |       \"type\"\n\t\t206 |     ]\n\t\t207 |   }\n\t\t208 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.kafka.aws_ebs_volume.storage2[1]\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /cluster/kafka/kafka.tf:210-227\n\tCalling File: /cluster/cluster.tf:80-94\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t210 | resource \"aws_ebs_volume\" \"storage2\" {\n\t\t211 |   count = var.cluster_size * local.storage_ebs_flag\n\t\t212 |   availability_zone = element(data.aws_subnet.private.*.availability_zone, count.index % length(data.aws_subnet.private.*.availability_zone))\n\t\t213 |   encrypted = true\n\t\t214 |   kms_key_id = data.aws_kms_key.provided.arn\n\t\t215 |   size = var.storage_volume_size\n\t\t216 |   type = var.storage_volume_type\n\t\t217 |   tags = merge(var.tags, map(\"Name\", \"${var.prefix}-kafka-broker-${local.broker_ids[count.index]}-d2\"))\n\t\t218 |   lifecycle {\n\t\t219 |     ignore_changes = [\n\t\t220 |       \"encrypted\",\n\t\t221 |       \"iops\",\n\t\t222 |       \"kms_key_id\",\n\t\t223 |       \"snapshot_id\",\n\t\t224 |       \"type\"\n\t\t225 |     ]\n\t\t226 |   }\n\t\t227 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.kafka.aws_ebs_volume.storage2[2]\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /cluster/kafka/kafka.tf:210-227\n\tCalling File: /cluster/cluster.tf:80-94\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t210 | resource \"aws_ebs_volume\" \"storage2\" {\n\t\t211 |   count = var.cluster_size * local.storage_ebs_flag\n\t\t212 |   availability_zone = element(data.aws_subnet.private.*.availability_zone, count.index % length(data.aws_subnet.private.*.availability_zone))\n\t\t213 |   encrypted = true\n\t\t214 |   kms_key_id = data.aws_kms_key.provided.arn\n\t\t215 |   size = var.storage_volume_size\n\t\t216 |   type = var.storage_volume_type\n\t\t217 |   tags = merge(var.tags, map(\"Name\", \"${var.prefix}-kafka-broker-${local.broker_ids[count.index]}-d2\"))\n\t\t218 |   lifecycle {\n\t\t219 |     ignore_changes = [\n\t\t220 |       \"encrypted\",\n\t\t221 |       \"iops\",\n\t\t222 |       \"kms_key_id\",\n\t\t223 |       \"snapshot_id\",\n\t\t224 |       \"type\"\n\t\t225 |     ]\n\t\t226 |   }\n\t\t227 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.kafka.aws_ebs_volume.storage3[1]\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /cluster/kafka/kafka.tf:229-246\n\tCalling File: /cluster/cluster.tf:80-94\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t229 | resource \"aws_ebs_volume\" \"storage3\" {\n\t\t230 |   count = var.cluster_size * local.storage_ebs_flag\n\t\t231 |   availability_zone = element(data.aws_subnet.private.*.availability_zone, count.index % length(data.aws_subnet.private.*.availability_zone))\n\t\t232 |   encrypted = true\n\t\t233 |   kms_key_id = data.aws_kms_key.provided.arn\n\t\t234 |   size = var.storage_volume_size\n\t\t235 |   type = var.storage_volume_type\n\t\t236 |   tags = merge(var.tags, map(\"Name\", \"${var.prefix}-kafka-broker-${local.broker_ids[count.index]}-d3\"))\n\t\t237 |   lifecycle {\n\t\t238 |     ignore_changes = [\n\t\t239 |       \"encrypted\",\n\t\t240 |       \"iops\",\n\t\t241 |       \"kms_key_id\",\n\t\t242 |       \"snapshot_id\",\n\t\t243 |       \"type\"\n\t\t244 |     ]\n\t\t245 |   }\n\t\t246 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.kafka.aws_ebs_volume.storage3[2]\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /cluster/kafka/kafka.tf:229-246\n\tCalling File: /cluster/cluster.tf:80-94\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t229 | resource \"aws_ebs_volume\" \"storage3\" {\n\t\t230 |   count = var.cluster_size * local.storage_ebs_flag\n\t\t231 |   availability_zone = element(data.aws_subnet.private.*.availability_zone, count.index % length(data.aws_subnet.private.*.availability_zone))\n\t\t232 |   encrypted = true\n\t\t233 |   kms_key_id = data.aws_kms_key.provided.arn\n\t\t234 |   size = var.storage_volume_size\n\t\t235 |   type = var.storage_volume_type\n\t\t236 |   tags = merge(var.tags, map(\"Name\", \"${var.prefix}-kafka-broker-${local.broker_ids[count.index]}-d3\"))\n\t\t237 |   lifecycle {\n\t\t238 |     ignore_changes = [\n\t\t239 |       \"encrypted\",\n\t\t240 |       \"iops\",\n\t\t241 |       \"kms_key_id\",\n\t\t242 |       \"snapshot_id\",\n\t\t243 |       \"type\"\n\t\t244 |     ]\n\t\t245 |   }\n\t\t246 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 6.7263659780001035
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 3, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.kafka.aws_instance.broker[0]\n\tFile: /cluster/kafka/kafka.tf:276-301\n\tCalling File: /cluster/cluster.tf:96-111\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.manager.aws_instance.server\n\tFile: /cluster/manager/manager.tf:243-259\n\tCalling File: /cluster/cluster.tf:113-130\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.kafka.aws_ebs_volume.storage1[0]\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /cluster/kafka/kafka.tf:191-208\n\tCalling File: /cluster/cluster.tf:96-111\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t191 | resource \"aws_ebs_volume\" \"storage1\" {\n\t\t192 |   count = var.cluster_size * local.storage_ebs_flag\n\t\t193 |   availability_zone = element(data.aws_subnet.private.*.availability_zone, count.index % length(data.aws_subnet.private.*.availability_zone))\n\t\t194 |   encrypted = true\n\t\t195 |   kms_key_id = data.aws_kms_key.provided.arn\n\t\t196 |   size = var.storage_volume_size\n\t\t197 |   type = var.storage_volume_type\n\t\t198 |   tags = merge(var.tags, map(\"Name\", \"${var.prefix}-kafka-broker-${local.broker_ids[count.index]}-d1\"))\n\t\t199 |   lifecycle {\n\t\t200 |     ignore_changes = [\n\t\t201 |       \"encrypted\",\n\t\t202 |       \"iops\",\n\t\t203 |       \"kms_key_id\",\n\t\t204 |       \"snapshot_id\",\n\t\t205 |       \"type\"\n\t\t206 |     ]\n\t\t207 |   }\n\t\t208 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.kafka.aws_ebs_volume.storage2[0]\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /cluster/kafka/kafka.tf:210-227\n\tCalling File: /cluster/cluster.tf:96-111\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t210 | resource \"aws_ebs_volume\" \"storage2\" {\n\t\t211 |   count = var.cluster_size * local.storage_ebs_flag\n\t\t212 |   availability_zone = element(data.aws_subnet.private.*.availability_zone, count.index % length(data.aws_subnet.private.*.availability_zone))\n\t\t213 |   encrypted = true\n\t\t214 |   kms_key_id = data.aws_kms_key.provided.arn\n\t\t215 |   size = var.storage_volume_size\n\t\t216 |   type = var.storage_volume_type\n\t\t217 |   tags = merge(var.tags, map(\"Name\", \"${var.prefix}-kafka-broker-${local.broker_ids[count.index]}-d2\"))\n\t\t218 |   lifecycle {\n\t\t219 |     ignore_changes = [\n\t\t220 |       \"encrypted\",\n\t\t221 |       \"iops\",\n\t\t222 |       \"kms_key_id\",\n\t\t223 |       \"snapshot_id\",\n\t\t224 |       \"type\"\n\t\t225 |     ]\n\t\t226 |   }\n\t\t227 | }\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: module.kafka.aws_ebs_volume.storage3[0]\n\tDetails: Older generation volumes might have worse performance and cost more than newer generations\n\tFile: /cluster/kafka/kafka.tf:229-246\n\tCalling File: /cluster/cluster.tf:96-111\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t229 | resource \"aws_ebs_volume\" \"storage3\" {\n\t\t230 |   count = var.cluster_size * local.storage_ebs_flag\n\t\t231 |   availability_zone = element(data.aws_subnet.private.*.availability_zone, count.index % length(data.aws_subnet.private.*.availability_zone))\n\t\t232 |   encrypted = true\n\t\t233 |   kms_key_id = data.aws_kms_key.provided.arn\n\t\t234 |   size = var.storage_volume_size\n\t\t235 |   type = var.storage_volume_type\n\t\t236 |   tags = merge(var.tags, map(\"Name\", \"${var.prefix}-kafka-broker-${local.broker_ids[count.index]}-d3\"))\n\t\t237 |   lifecycle {\n\t\t238 |     ignore_changes = [\n\t\t239 |       \"encrypted\",\n\t\t240 |       \"iops\",\n\t\t241 |       \"kms_key_id\",\n\t\t242 |       \"snapshot_id\",\n\t\t243 |       \"type\"\n\t\t244 |     ]\n\t\t245 |   }\n\t\t246 | }\n\n\n",
      "stderr": "",
      "duration_seconds": 6.439318393997382
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/openaustralia/infrastructure/commit/63ee190c0ae1832bb72681e1e4b1b14a9367b4bb",
    "before": [],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 11, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.electionleaflets\n\tFile: /terraform/electionleaflets.tf:10-22\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.electionleaflets_data\n\tFile: /terraform/electionleaflets.tf:35-46\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.oaf\n\tFile: /terraform/oaf.tf:1-12\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.openaustralia\n\tFile: /terraform/openaustralia.tf:1-16\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.openaustralia_data\n\tFile: /terraform/openaustralia.tf:29-40\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.opengovernment\n\tFile: /terraform/opengovernment.tf:1-13\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.planningalerts\n\tFile: /terraform/planningalerts.tf:1-26\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.au_proxy\n\tFile: /terraform/proxy.tf:1-15\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.righttoknow\n\tFile: /terraform/righttoknow.tf:1-22\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_ebs_volume.righttoknow_data\n\tFile: /terraform/righttoknow.tf:31-39\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.theyvoteforyou\n\tFile: /terraform/theyvoteforyou.tf:4-18\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n",
      "stderr": "",
      "duration_seconds": 10.851499160999083
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/robertdebock/terraform-aws-vault/commit/e3b6520960a88aacbf03339dc1368f680a8bee9a",
    "before": [
      {
        "return_code": 0,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.vault.aws_instance.bastion[0]\n\tFile: /main.tf:434-444\n\tCalling File: /examples/myvpc/main.tf:25-35\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.vault_one.aws_instance.bastion[0]\n\tFile: /main.tf:434-444\n\tCalling File: /examples/replication/main.tf:43-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.vault_two.aws_instance.bastion[0]\n\tFile: /main.tf:434-444\n\tCalling File: /examples/replication/main.tf:60-72\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n",
        "stderr": "",
        "duration_seconds": 8.326144089995068
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.vault.aws_instance.bastion[0]\n\tFile: /main.tf:434-444\n\tCalling File: /examples/myvpc/main.tf:25-35\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.vault_one.aws_instance.bastion[0]\n\tFile: /main.tf:434-444\n\tCalling File: /examples/replication/main.tf:43-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: module.vault_two.aws_instance.bastion[0]\n\tFile: /main.tf:434-444\n\tCalling File: /examples/replication/main.tf:60-72\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n",
      "stderr": "",
      "duration_seconds": 8.528881413993076
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/cisagov/cool-assessment-terraform/commit/3138943ab4d15cc256d322e1128862ef11383c73",
    "before": [
      {
        "return_code": 0,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.teamserver\n\tFile: /examples/use-terraformer-instance/teamserver_ec2.tf:25-64\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.guacamole\n\tFile: /guacamole_ec2.tf:27-78\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.kali[0]\n\tFile: /kali_ec2.tf:27-72\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n",
        "stderr": "2024-06-21 12:27:29,227 [MainThread  ] [WARNI]  Failed to download module github.com/cisagov/terraform-state-read-role-tf-module:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:27:29,227 [MainThread  ] [WARNI]  Failed to download module github.com/cisagov/cert-read-role-tf-module:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:27:29,227 [MainThread  ] [WARNI]  Failed to download module gazoakley/session-manager-settings/aws:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:27:29,228 [MainThread  ] [WARNI]  Failed to download module trussworks/vpc-flow-logs/aws:~>2.0 (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 6.580057375991601
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.teamserver\n\tFile: /examples/use-terraformer-instance/teamserver_ec2.tf:25-64\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.guacamole\n\tFile: /guacamole_ec2.tf:27-78\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.kali[0]\n\tFile: /kali_ec2.tf:27-72\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n",
      "stderr": "2024-06-21 12:27:22,879 [MainThread  ] [WARNI]  Failed to download module github.com/cisagov/terraform-state-read-role-tf-module:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:27:22,880 [MainThread  ] [WARNI]  Failed to download module github.com/cisagov/cert-read-role-tf-module:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:27:22,881 [MainThread  ] [WARNI]  Failed to download module gazoakley/session-manager-settings/aws:None (for external modules, the --download-external-modules flag is required)\n2024-06-21 12:27:22,881 [MainThread  ] [WARNI]  Failed to download module trussworks/vpc-flow-logs/aws:~>2.0 (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 6.310627276005107
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/pelias/terraform-elasticsearch/commit/21c1827f4507eae217d43d99ad8cb1bbb1337e21",
    "before": [
      {
        "return_code": 0,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\n\n",
        "stderr": "",
        "duration_seconds": 5.258022294001421
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\n\n",
      "stderr": "",
      "duration_seconds": 4.286690184002509
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/lowflying/OVPN---TF/commit/be1245d8634025277ba79a4155ee88d7eaffcdfb",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_instance.ovpn\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /AWS/ec2.tf:17-72\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\n\n",
        "stderr": "",
        "duration_seconds": 5.492810094991
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.ovpn\n\tFile: /AWS/ec2.tf:12-67\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n",
      "stderr": "",
      "duration_seconds": 4.652810615996714
    }
  },
  {
    "pattern": "Old generation",
    "url": "https://github.com/figurate/bedrock/commit/bffc023eeff075ef281b1fd261897f4c7216b354",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 1, Skipped checks: 0, Parsing errors: 1\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tFAILED for resource: aws_instance.bastion\n\tDetails: Older generation instances might have worse performance and cost more than newer generations\n\tFile: /terraform/blueprints/bastion/aws/main.tf:36-41\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\n\n\t\t36 | resource \"aws_instance\" \"bastion\" {\n\t\t37 |   count = \"${replace(replace(var.enabled, \"/false/\", 0), \"/true/\", 1)}\"\n\t\t38 |   ami = \"${data.aws_ami.bastion_image.id}\"\n\t\t39 |   instance_type = \"${var.instance_type}\"\n\t\t40 |   security_groups = [\"${aws_security_group.bastion_sg.id}\"]\n\t\t41 | }\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/figurate-bedrock-bffc023eeff075ef281b1fd261897f4c7216b354/before-ae66d73d58665a4c8f181d1963e625694ea16da2/terraform/ami_codepipeline/main.tfֿ\ncloudformation scan results:\n\nPassed checks: 0, Failed checks: 0, Skipped checks: 0, Parsing errors: 2\n\nError parsing file snapshots/figurate-bedrock-bffc023eeff075ef281b1fd261897f4c7216b354/before-ae66d73d58665a4c8f181d1963e625694ea16da2/terraform/blueprints/ecs_cluster/aws/cloudformation/ecs_cluster.ymlֿ\nError parsing file snapshots/figurate-bedrock-bffc023eeff075ef281b1fd261897f4c7216b354/before-ae66d73d58665a4c8f181d1963e625694ea16da2/terraform/blueprints/reverseproxy/aws/cloudformation/reverseproxy.ymlֿ\n\n",
        "stderr": "",
        "duration_seconds": 8.46993207000196
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 0, Skipped checks: 0, Parsing errors: 1\n\nCheck: CKV_AWS_804: \"Ensure instances and volumes do not use older generation versions to save cost\"\n\tPASSED for resource: aws_instance.bastion\n\tFile: /terraform/blueprints/bastion/aws/main.tf:36-41\n\tGuide: https://search-rug.github.io/iac-cost-patterns/old-generation/\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/figurate-bedrock-bffc023eeff075ef281b1fd261897f4c7216b354/after/terraform/ami_codepipeline/main.tfֿ\ncloudformation scan results:\n\nPassed checks: 0, Failed checks: 0, Skipped checks: 0, Parsing errors: 2\n\nError parsing file snapshots/figurate-bedrock-bffc023eeff075ef281b1fd261897f4c7216b354/after/terraform/blueprints/ecs_cluster/aws/cloudformation/ecs_cluster.ymlֿ\nError parsing file snapshots/figurate-bedrock-bffc023eeff075ef281b1fd261897f4c7216b354/after/terraform/blueprints/reverseproxy/aws/cloudformation/reverseproxy.ymlֿ\n\n",
      "stderr": "",
      "duration_seconds": 8.416916800008039
    }
  }
]
