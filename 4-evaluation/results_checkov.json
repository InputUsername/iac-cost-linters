[
  {
    "pattern": "Object storage lifecycle rules",
    "url": "https://github.com/alphagov/govuk-aws/commit/f844cd8e254b161bebef04101f8ce177bcd0840c",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 17, Failed checks: 18, Skipped checks: 0, Parsing errors: 1\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.govuk-mongodb-backup-s3.aws_s3_bucket.s3_bucket\n\tFile: /terraform/modules/aws/s3_bucket_lifecycle/main.tf:58-100\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.govuk-mongodb-backup-s3-daily.aws_s3_bucket.s3_bucket\n\tFile: /terraform/modules/aws/s3_bucket_lifecycle/main.tf:58-100\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.bucket\n\tFile: /terraform/projects/app-govuk-attachments/main.tf:66-89\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.bucket\n\tFile: /terraform/projects/app-mysql-xtrabackups/main.tf:69-101\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.sitemaps_bucket\n\tFile: /terraform/projects/app-search/main.tf:190-213\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.search_relevancy_bucket\n\tFile: /terraform/projects/app-search/main.tf:280-313\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.bucket[0]\n\tFile: /terraform/projects/app-wal-e-backups-postgresql/main.tf:68-95\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.bucket_with_transition\n\tFile: /terraform/projects/app-wal-e-backups-postgresql/main.tf:97-131\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.artefact_replication_destination\n\tFile: /terraform/projects/infra-artefact-bucket/main.tf:140-161\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.content_data_csvs\n\tFile: /terraform/projects/infra-content-data-admin/main.tf:35-57\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.activestorage_replica\n\tFile: /terraform/projects/infra-content-publisher/main.tf:92-119\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.database_backups\n\tFile: /terraform/projects/infra-database-backups-bucket/main.tf:100-276\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.govuk-mirror\n\tFile: /terraform/projects/infra-mirror-bucket/main.tf:149-209\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.govuk-mirror-replica\n\tFile: /terraform/projects/infra-mirror-bucket/main.tf:211-251\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.aws-logging\n\tFile: /terraform/projects/infra-monitoring/main.tf:107-150\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.aws-secondary-logging\n\tFile: /terraform/projects/infra-monitoring/secondary.tf:32-52\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.aws_waf_logs\n\tFile: /terraform/projects/infra-public-services/waf.tf:27-41\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.custom_formats_mapit\n\tFile: /terraform/projects/app-custom-formats-mapit-storage/main.tf:57-83\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t57 | resource \"aws_s3_bucket\" \"custom_formats_mapit\" {\n\t\t58 |   bucket = \"${var.bucket_name}-${var.aws_environment}\"\n\t\t59 | \n\t\t60 |   tags {\n\t\t61 |     Environment = \"${var.aws_environment}\"\n\t\t62 |     Team        = \"custom_formats\"\n\t\t63 |   }\n\t\t64 | \n\t\t65 |   versioning {\n\t\t66 |     enabled = true\n\t\t67 |   }\n\t\t68 | \n\t\t69 |   replication_configuration {\n\t\t70 |     role = \"${aws_iam_role.govuk_custom_formats_mapit_storage_replication_role.arn}\"\n\t\t71 | \n\t\t72 |     rules {\n\t\t73 |       id     = \"govuk-custom-formats-mapit-storage-replication-whole-bucket-rule\"\n\t\t74 |       prefix = \"\"\n\t\t75 |       status = \"Enabled\"\n\t\t76 | \n\t\t77 |       destination {\n\t\t78 |         bucket        = \"${aws_s3_bucket.custom_formats_mapit_replica.arn}\"\n\t\t79 |         storage_class = \"STANDARD\"\n\t\t80 |       }\n\t\t81 |     }\n\t\t82 |   }\n\t\t83 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.custom_formats_mapit_replica\n\tFile: /terraform/projects/app-custom-formats-mapit-storage/main.tf:85-98\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t85 | resource \"aws_s3_bucket\" \"custom_formats_mapit_replica\" {\n\t\t86 |   bucket   = \"${var.bucket_name}-replica-${var.aws_environment}\"\n\t\t87 |   region   = \"${var.aws_replica_region}\"\n\t\t88 |   provider = \"aws.aws_replica\"\n\t\t89 | \n\t\t90 |   tags {\n\t\t91 |     Name            = \"custom_formats_mapit_replica\"\n\t\t92 |     aws_environment = \"${var.aws_environment}\"\n\t\t93 |   }\n\t\t94 | \n\t\t95 |   versioning {\n\t\t96 |     enabled = true\n\t\t97 |   }\n\t\t98 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.manual_snapshots\n\tFile: /terraform/projects/app-elasticsearch6/main.tf:304-317\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t304 | resource \"aws_s3_bucket\" \"manual_snapshots\" {\n\t\t305 |   bucket = \"govuk-${var.aws_environment}-elasticsearch6-manual-snapshots\"\n\t\t306 |   region = \"${var.aws_region}\"\n\t\t307 | \n\t\t308 |   tags {\n\t\t309 |     Name            = \"govuk-${var.aws_environment}-elasticsearch6-manual-snapshots\"\n\t\t310 |     aws_environment = \"${var.aws_environment}\"\n\t\t311 |   }\n\t\t312 | \n\t\t313 |   logging {\n\t\t314 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t315 |     target_prefix = \"s3/govuk-${var.aws_environment}-elasticsearch6-manual-snapshots/\"\n\t\t316 |   }\n\t\t317 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.results\n\tFile: /terraform/projects/app-gatling/main.tf:151-157\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t151 | resource \"aws_s3_bucket\" \"results\" {\n\t\t152 |   bucket = \"gatling-results-${var.aws_environment}\"\n\t\t153 | \n\t\t154 |   website {\n\t\t155 |     index_document = \"index.html\"\n\t\t156 |   }\n\t\t157 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.bucket_without_lifecycle[0]\n\tFile: /terraform/projects/app-govuk-attachments/main.tf:91-105\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t91  | resource \"aws_s3_bucket\" \"bucket_without_lifecycle\" {\n\t\t92  |   count = \"${1 - var.lifecycle}\"\n\t\t93  | \n\t\t94  |   bucket = \"${var.bucket_name}-${var.aws_environment}\"\n\t\t95  |   acl    = \"private\"\n\t\t96  | \n\t\t97  |   tags {\n\t\t98  |     Environment = \"${var.aws_environment}\"\n\t\t99  |     Team        = \"${var.team}\"\n\t\t100 |   }\n\t\t101 | \n\t\t102 |   versioning {\n\t\t103 |     enabled = \"${var.versioning}\"\n\t\t104 |   }\n\t\t105 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.data_infrastructure_bucket\n\tFile: /terraform/projects/app-knowledge-graph/main.tf:56-67\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t56 | resource \"aws_s3_bucket\" \"data_infrastructure_bucket\" {\n\t\t57 |   bucket = \"${local.data_infrastructure_bucket_name}\"\n\t\t58 | \n\t\t59 |   versioning {\n\t\t60 |     enabled = true\n\t\t61 |   }\n\t\t62 | \n\t\t63 |   tags {\n\t\t64 |     aws_environment = \"${var.aws_environment}\"\n\t\t65 |     Name            = \"${local.data_infrastructure_bucket_name}\"\n\t\t66 |   }\n\t\t67 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.s3_bucket\n\tFile: /terraform/projects/app-related-links/main.tf:47-58\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t47 | resource \"aws_s3_bucket\" \"s3_bucket\" {\n\t\t48 |   bucket = \"${local.related_links_bucket_name}\"\n\t\t49 | \n\t\t50 |   versioning {\n\t\t51 |     enabled = true\n\t\t52 |   }\n\t\t53 | \n\t\t54 |   tags {\n\t\t55 |     aws_environment = \"${var.aws_environment}\"\n\t\t56 |     Name            = \"${local.related_links_bucket_name}\"\n\t\t57 |   }\n\t\t58 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.whitehall_csvs\n\tFile: /terraform/projects/app-whitehall-backend/main.tf:139-151\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t139 | resource \"aws_s3_bucket\" \"whitehall_csvs\" {\n\t\t140 |   bucket = \"govuk-${var.aws_environment}-whitehall-csvs\"\n\t\t141 | \n\t\t142 |   tags {\n\t\t143 |     name            = \"govuk-${var.aws_environment}-whitehall-csvs\"\n\t\t144 |     aws_environment = \"${var.aws_environment}\"\n\t\t145 |   }\n\t\t146 | \n\t\t147 |   logging {\n\t\t148 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t149 |     target_prefix = \"s3/govuk-${var.aws_environment}-whitehall-csvs/\"\n\t\t150 |   }\n\t\t151 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.artefact\n\tFile: /terraform/projects/infra-artefact-bucket/main.tf:164-195\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t164 | resource \"aws_s3_bucket\" \"artefact\" {\n\t\t165 |   bucket = \"govuk-${var.aws_environment}-artefact\"\n\t\t166 |   acl    = \"private\"\n\t\t167 | \n\t\t168 |   tags {\n\t\t169 |     Name            = \"govuk-${var.aws_environment}-artefact\"\n\t\t170 |     aws_environment = \"${var.aws_environment}\"\n\t\t171 |   }\n\t\t172 | \n\t\t173 |   versioning {\n\t\t174 |     enabled = true\n\t\t175 |   }\n\t\t176 | \n\t\t177 |   logging {\n\t\t178 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t179 |     target_prefix = \"s3/govuk-${var.aws_environment}-artefact/\"\n\t\t180 |   }\n\t\t181 | \n\t\t182 |   replication_configuration {\n\t\t183 |     role = \"${aws_iam_role.artefact_replication.arn}\"\n\t\t184 | \n\t\t185 |     rules {\n\t\t186 |       id     = \"govuk-artefact-replication-whole-bucket-rule\"\n\t\t187 |       status = \"${var.replication_setting}\"\n\t\t188 |       prefix = \"\"\n\t\t189 | \n\t\t190 |       destination {\n\t\t191 |         bucket = \"${aws_s3_bucket.artefact_replication_destination.arn}\"\n\t\t192 |       }\n\t\t193 |     }\n\t\t194 |   }\n\t\t195 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.assets_backup\n\tFile: /terraform/projects/infra-assets/backup.tf:6-14\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t6  | resource \"aws_s3_bucket\" \"assets_backup\" {\n\t\t7  |   provider = \"aws.backup_provider\"\n\t\t8  |   bucket   = \"govuk-assets-backup-${var.aws_environment}\"\n\t\t9  |   region   = \"${var.aws_backup_region}\"\n\t\t10 | \n\t\t11 |   versioning {\n\t\t12 |     enabled = true\n\t\t13 |   }\n\t\t14 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.assets\n\tFile: /terraform/projects/infra-assets/main.tf:41-72\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t41 | resource \"aws_s3_bucket\" \"assets\" {\n\t\t42 |   bucket = \"govuk-assets-${var.aws_environment}\"\n\t\t43 | \n\t\t44 |   tags {\n\t\t45 |     Name            = \"govuk-assets-${var.aws_environment}\"\n\t\t46 |     aws_environment = \"${var.aws_environment}\"\n\t\t47 |   }\n\t\t48 | \n\t\t49 |   logging {\n\t\t50 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t51 |     target_prefix = \"s3/govuk-assets-${var.aws_environment}/\"\n\t\t52 |   }\n\t\t53 | \n\t\t54 |   versioning {\n\t\t55 |     enabled = true\n\t\t56 |   }\n\t\t57 | \n\t\t58 |   replication_configuration {\n\t\t59 |     role = \"${aws_iam_role.backup.arn}\"\n\t\t60 | \n\t\t61 |     rules {\n\t\t62 |       id     = \"govuk-${var.aws_environment}-assets-replication-rule\"\n\t\t63 |       prefix = \"\"\n\t\t64 |       status = \"Enabled\"\n\t\t65 | \n\t\t66 |       destination {\n\t\t67 |         bucket        = \"${aws_s3_bucket.assets_backup.arn}\"\n\t\t68 |         storage_class = \"STANDARD\"\n\t\t69 |       }\n\t\t70 |     }\n\t\t71 |   }\n\t\t72 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.activestorage\n\tFile: /terraform/projects/infra-content-publisher/main.tf:59-90\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t59 | resource \"aws_s3_bucket\" \"activestorage\" {\n\t\t60 |   bucket = \"govuk-${var.aws_environment}-content-publisher-activestorage\"\n\t\t61 | \n\t\t62 |   tags {\n\t\t63 |     Name            = \"govuk-${var.aws_environment}-content-publisher-activestorage\"\n\t\t64 |     aws_environment = \"${var.aws_environment}\"\n\t\t65 |   }\n\t\t66 | \n\t\t67 |   logging {\n\t\t68 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t69 |     target_prefix = \"s3/govuk-${var.aws_environment}-content-publisher-activestorage/\"\n\t\t70 |   }\n\t\t71 | \n\t\t72 |   versioning {\n\t\t73 |     enabled = true\n\t\t74 |   }\n\t\t75 | \n\t\t76 |   replication_configuration {\n\t\t77 |     role = \"${aws_iam_role.govuk_content_publisher_activestorage_replication_role.arn}\"\n\t\t78 | \n\t\t79 |     rules {\n\t\t80 |       id     = \"govuk-content-publisher-activestorage-replication-whole-bucket-rule\"\n\t\t81 |       prefix = \"\"\n\t\t82 |       status = \"${var.replication_setting}\"\n\t\t83 | \n\t\t84 |       destination {\n\t\t85 |         bucket        = \"${aws_s3_bucket.activestorage_replica.arn}\"\n\t\t86 |         storage_class = \"STANDARD\"\n\t\t87 |       }\n\t\t88 |     }\n\t\t89 |   }\n\t\t90 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.database_backups_replica\n\tFile: /terraform/projects/infra-database-backups-bucket/main.tf:279-287\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t279 | resource \"aws_s3_bucket\" \"database_backups_replica\" {\n\t\t280 |   bucket   = \"govuk-${var.aws_environment}-database-backups-replica\"\n\t\t281 |   region   = \"${var.aws_backup_region}\"\n\t\t282 |   provider = \"aws.eu-london\"\n\t\t283 | \n\t\t284 |   versioning {\n\t\t285 |     enabled = true\n\t\t286 |   }\n\t\t287 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.datagovuk-organogram\n\tFile: /terraform/projects/infra-datagovuk-organogram-bucket/main.tf:63-84\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t63 | resource \"aws_s3_bucket\" \"datagovuk-organogram\" {\n\t\t64 |   bucket = \"datagovuk-${var.aws_environment}-ckan-organogram\"\n\t\t65 | \n\t\t66 |   cors_rule {\n\t\t67 |     allowed_methods = [\"GET\"]\n\t\t68 |     allowed_origins = \"${compact(list(var.domain, var.aws_environment == \"production\" ? \"https://staging.data.gov.uk\" : \"\"))}\"\n\t\t69 |   }\n\t\t70 | \n\t\t71 |   tags {\n\t\t72 |     Name            = \"datagovuk-${var.aws_environment}-ckan-organogram\"\n\t\t73 |     aws_environment = \"${var.aws_environment}\"\n\t\t74 |   }\n\t\t75 | \n\t\t76 |   logging {\n\t\t77 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t78 |     target_prefix = \"s3/datagovuk-${var.aws_environment}-ckan-organogram/\"\n\t\t79 |   }\n\t\t80 | \n\t\t81 |   versioning {\n\t\t82 |     enabled = true\n\t\t83 |   }\n\t\t84 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.datagovuk-static\n\tFile: /terraform/projects/infra-datagovuk-static-bucket/main.tf:63-79\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t63 | resource \"aws_s3_bucket\" \"datagovuk-static\" {\n\t\t64 |   bucket = \"datagovuk-${var.aws_environment}-ckan-static-data\"\n\t\t65 | \n\t\t66 |   tags {\n\t\t67 |     Name            = \"datagovuk-${var.aws_environment}-ckan-static-data\"\n\t\t68 |     aws_environment = \"${var.aws_environment}\"\n\t\t69 |   }\n\t\t70 | \n\t\t71 |   logging {\n\t\t72 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t73 |     target_prefix = \"s3/datagovuk-${var.aws_environment}-ckan-static-data/\"\n\t\t74 |   }\n\t\t75 | \n\t\t76 |   versioning {\n\t\t77 |     enabled = true\n\t\t78 |   }\n\t\t79 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.cdn_logs_monitor\n\tFile: /terraform/projects/infra-govuk-cdn-logs-monitor-bucket/main.tf:39-51\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t39 | resource \"aws_s3_bucket\" \"cdn_logs_monitor\" {\n\t\t40 |   bucket = \"govuk-${var.aws_environment}-cdn-logs-monitor-archive\"\n\t\t41 | \n\t\t42 |   tags {\n\t\t43 |     Name            = \"govuk-${var.aws_environment}-cdn-logs-monitor-archive\"\n\t\t44 |     aws_environment = \"${var.aws_environment}\"\n\t\t45 |   }\n\t\t46 | \n\t\t47 |   logging {\n\t\t48 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t49 |     target_prefix = \"s3/govuk-${var.aws_environment}-cdn-logs-monitor-archive/\"\n\t\t50 |   }\n\t\t51 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.specialist_publisher_csvs\n\tFile: /terraform/projects/infra-specialist-publisher/main.tf:35-47\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t35 | resource \"aws_s3_bucket\" \"specialist_publisher_csvs\" {\n\t\t36 |   bucket = \"govuk-${var.aws_environment}-specialist-publisher-csvs\"\n\t\t37 | \n\t\t38 |   tags {\n\t\t39 |     name            = \"govuk-${var.aws_environment}-specialist-publisher-csvs\"\n\t\t40 |     aws_environment = \"${var.aws_environment}\"\n\t\t41 |   }\n\t\t42 | \n\t\t43 |   logging {\n\t\t44 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t45 |     target_prefix = \"s3/govuk-${var.aws_environment}-specialist-publisher-csvs/\"\n\t\t46 |   }\n\t\t47 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.support_api_csvs\n\tFile: /terraform/projects/infra-support-api/main.tf:35-47\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t35 | resource \"aws_s3_bucket\" \"support_api_csvs\" {\n\t\t36 |   bucket = \"govuk-${var.aws_environment}-support-api-csvs\"\n\t\t37 | \n\t\t38 |   tags {\n\t\t39 |     name            = \"govuk-${var.aws_environment}-support-api-csvs\"\n\t\t40 |     aws_environment = \"${var.aws_environment}\"\n\t\t41 |   }\n\t\t42 | \n\t\t43 |   logging {\n\t\t44 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t45 |     target_prefix = \"s3/govuk-${var.aws_environment}-support-api-csvs/\"\n\t\t46 |   }\n\t\t47 | }\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/alphagov-govuk-aws-f844cd8e254b161bebef04101f8ce177bcd0840c/before-f9fc11443ab8926b0761fb890974cd7169f9235f/terraform/projects/infra-fastly-logs/main.tfֿ\n\n",
        "stderr": "2024-06-20 20:02:32,061 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/alphagov/csw-client-role.git:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:02:32,061 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/alphagov/tech-ops.git?ref=13f54e5//cyber-security/modules/gds_security_audit_role:None (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 45.07814200800021
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 18, Failed checks: 17, Skipped checks: 0, Parsing errors: 1\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.govuk-mongodb-backup-s3.aws_s3_bucket.s3_bucket\n\tFile: /terraform/modules/aws/s3_bucket_lifecycle/main.tf:58-100\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.govuk-mongodb-backup-s3-daily.aws_s3_bucket.s3_bucket\n\tFile: /terraform/modules/aws/s3_bucket_lifecycle/main.tf:58-100\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.bucket\n\tFile: /terraform/projects/app-govuk-attachments/main.tf:66-89\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.data_infrastructure_bucket\n\tFile: /terraform/projects/app-knowledge-graph/main.tf:56-100\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.bucket\n\tFile: /terraform/projects/app-mysql-xtrabackups/main.tf:69-101\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.sitemaps_bucket\n\tFile: /terraform/projects/app-search/main.tf:190-213\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.search_relevancy_bucket\n\tFile: /terraform/projects/app-search/main.tf:280-313\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.bucket[0]\n\tFile: /terraform/projects/app-wal-e-backups-postgresql/main.tf:68-95\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.bucket_with_transition\n\tFile: /terraform/projects/app-wal-e-backups-postgresql/main.tf:97-131\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.artefact_replication_destination\n\tFile: /terraform/projects/infra-artefact-bucket/main.tf:140-161\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.content_data_csvs\n\tFile: /terraform/projects/infra-content-data-admin/main.tf:35-57\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.activestorage_replica\n\tFile: /terraform/projects/infra-content-publisher/main.tf:92-119\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.database_backups\n\tFile: /terraform/projects/infra-database-backups-bucket/main.tf:100-276\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.govuk-mirror\n\tFile: /terraform/projects/infra-mirror-bucket/main.tf:149-209\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.govuk-mirror-replica\n\tFile: /terraform/projects/infra-mirror-bucket/main.tf:211-251\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.aws-logging\n\tFile: /terraform/projects/infra-monitoring/main.tf:107-150\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.aws-secondary-logging\n\tFile: /terraform/projects/infra-monitoring/secondary.tf:32-52\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.aws_waf_logs\n\tFile: /terraform/projects/infra-public-services/waf.tf:27-41\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.custom_formats_mapit\n\tFile: /terraform/projects/app-custom-formats-mapit-storage/main.tf:57-83\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t57 | resource \"aws_s3_bucket\" \"custom_formats_mapit\" {\n\t\t58 |   bucket = \"${var.bucket_name}-${var.aws_environment}\"\n\t\t59 | \n\t\t60 |   tags {\n\t\t61 |     Environment = \"${var.aws_environment}\"\n\t\t62 |     Team        = \"custom_formats\"\n\t\t63 |   }\n\t\t64 | \n\t\t65 |   versioning {\n\t\t66 |     enabled = true\n\t\t67 |   }\n\t\t68 | \n\t\t69 |   replication_configuration {\n\t\t70 |     role = \"${aws_iam_role.govuk_custom_formats_mapit_storage_replication_role.arn}\"\n\t\t71 | \n\t\t72 |     rules {\n\t\t73 |       id     = \"govuk-custom-formats-mapit-storage-replication-whole-bucket-rule\"\n\t\t74 |       prefix = \"\"\n\t\t75 |       status = \"Enabled\"\n\t\t76 | \n\t\t77 |       destination {\n\t\t78 |         bucket        = \"${aws_s3_bucket.custom_formats_mapit_replica.arn}\"\n\t\t79 |         storage_class = \"STANDARD\"\n\t\t80 |       }\n\t\t81 |     }\n\t\t82 |   }\n\t\t83 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.custom_formats_mapit_replica\n\tFile: /terraform/projects/app-custom-formats-mapit-storage/main.tf:85-98\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t85 | resource \"aws_s3_bucket\" \"custom_formats_mapit_replica\" {\n\t\t86 |   bucket   = \"${var.bucket_name}-replica-${var.aws_environment}\"\n\t\t87 |   region   = \"${var.aws_replica_region}\"\n\t\t88 |   provider = \"aws.aws_replica\"\n\t\t89 | \n\t\t90 |   tags {\n\t\t91 |     Name            = \"custom_formats_mapit_replica\"\n\t\t92 |     aws_environment = \"${var.aws_environment}\"\n\t\t93 |   }\n\t\t94 | \n\t\t95 |   versioning {\n\t\t96 |     enabled = true\n\t\t97 |   }\n\t\t98 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.manual_snapshots\n\tFile: /terraform/projects/app-elasticsearch6/main.tf:304-317\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t304 | resource \"aws_s3_bucket\" \"manual_snapshots\" {\n\t\t305 |   bucket = \"govuk-${var.aws_environment}-elasticsearch6-manual-snapshots\"\n\t\t306 |   region = \"${var.aws_region}\"\n\t\t307 | \n\t\t308 |   tags {\n\t\t309 |     Name            = \"govuk-${var.aws_environment}-elasticsearch6-manual-snapshots\"\n\t\t310 |     aws_environment = \"${var.aws_environment}\"\n\t\t311 |   }\n\t\t312 | \n\t\t313 |   logging {\n\t\t314 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t315 |     target_prefix = \"s3/govuk-${var.aws_environment}-elasticsearch6-manual-snapshots/\"\n\t\t316 |   }\n\t\t317 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.results\n\tFile: /terraform/projects/app-gatling/main.tf:151-157\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t151 | resource \"aws_s3_bucket\" \"results\" {\n\t\t152 |   bucket = \"gatling-results-${var.aws_environment}\"\n\t\t153 | \n\t\t154 |   website {\n\t\t155 |     index_document = \"index.html\"\n\t\t156 |   }\n\t\t157 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.bucket_without_lifecycle[0]\n\tFile: /terraform/projects/app-govuk-attachments/main.tf:91-105\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t91  | resource \"aws_s3_bucket\" \"bucket_without_lifecycle\" {\n\t\t92  |   count = \"${1 - var.lifecycle}\"\n\t\t93  | \n\t\t94  |   bucket = \"${var.bucket_name}-${var.aws_environment}\"\n\t\t95  |   acl    = \"private\"\n\t\t96  | \n\t\t97  |   tags {\n\t\t98  |     Environment = \"${var.aws_environment}\"\n\t\t99  |     Team        = \"${var.team}\"\n\t\t100 |   }\n\t\t101 | \n\t\t102 |   versioning {\n\t\t103 |     enabled = \"${var.versioning}\"\n\t\t104 |   }\n\t\t105 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.s3_bucket\n\tFile: /terraform/projects/app-related-links/main.tf:47-58\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t47 | resource \"aws_s3_bucket\" \"s3_bucket\" {\n\t\t48 |   bucket = \"${local.related_links_bucket_name}\"\n\t\t49 | \n\t\t50 |   versioning {\n\t\t51 |     enabled = true\n\t\t52 |   }\n\t\t53 | \n\t\t54 |   tags {\n\t\t55 |     aws_environment = \"${var.aws_environment}\"\n\t\t56 |     Name            = \"${local.related_links_bucket_name}\"\n\t\t57 |   }\n\t\t58 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.whitehall_csvs\n\tFile: /terraform/projects/app-whitehall-backend/main.tf:139-151\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t139 | resource \"aws_s3_bucket\" \"whitehall_csvs\" {\n\t\t140 |   bucket = \"govuk-${var.aws_environment}-whitehall-csvs\"\n\t\t141 | \n\t\t142 |   tags {\n\t\t143 |     name            = \"govuk-${var.aws_environment}-whitehall-csvs\"\n\t\t144 |     aws_environment = \"${var.aws_environment}\"\n\t\t145 |   }\n\t\t146 | \n\t\t147 |   logging {\n\t\t148 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t149 |     target_prefix = \"s3/govuk-${var.aws_environment}-whitehall-csvs/\"\n\t\t150 |   }\n\t\t151 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.artefact\n\tFile: /terraform/projects/infra-artefact-bucket/main.tf:164-195\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t164 | resource \"aws_s3_bucket\" \"artefact\" {\n\t\t165 |   bucket = \"govuk-${var.aws_environment}-artefact\"\n\t\t166 |   acl    = \"private\"\n\t\t167 | \n\t\t168 |   tags {\n\t\t169 |     Name            = \"govuk-${var.aws_environment}-artefact\"\n\t\t170 |     aws_environment = \"${var.aws_environment}\"\n\t\t171 |   }\n\t\t172 | \n\t\t173 |   versioning {\n\t\t174 |     enabled = true\n\t\t175 |   }\n\t\t176 | \n\t\t177 |   logging {\n\t\t178 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t179 |     target_prefix = \"s3/govuk-${var.aws_environment}-artefact/\"\n\t\t180 |   }\n\t\t181 | \n\t\t182 |   replication_configuration {\n\t\t183 |     role = \"${aws_iam_role.artefact_replication.arn}\"\n\t\t184 | \n\t\t185 |     rules {\n\t\t186 |       id     = \"govuk-artefact-replication-whole-bucket-rule\"\n\t\t187 |       status = \"${var.replication_setting}\"\n\t\t188 |       prefix = \"\"\n\t\t189 | \n\t\t190 |       destination {\n\t\t191 |         bucket = \"${aws_s3_bucket.artefact_replication_destination.arn}\"\n\t\t192 |       }\n\t\t193 |     }\n\t\t194 |   }\n\t\t195 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.assets_backup\n\tFile: /terraform/projects/infra-assets/backup.tf:6-14\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t6  | resource \"aws_s3_bucket\" \"assets_backup\" {\n\t\t7  |   provider = \"aws.backup_provider\"\n\t\t8  |   bucket   = \"govuk-assets-backup-${var.aws_environment}\"\n\t\t9  |   region   = \"${var.aws_backup_region}\"\n\t\t10 | \n\t\t11 |   versioning {\n\t\t12 |     enabled = true\n\t\t13 |   }\n\t\t14 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.assets\n\tFile: /terraform/projects/infra-assets/main.tf:41-72\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t41 | resource \"aws_s3_bucket\" \"assets\" {\n\t\t42 |   bucket = \"govuk-assets-${var.aws_environment}\"\n\t\t43 | \n\t\t44 |   tags {\n\t\t45 |     Name            = \"govuk-assets-${var.aws_environment}\"\n\t\t46 |     aws_environment = \"${var.aws_environment}\"\n\t\t47 |   }\n\t\t48 | \n\t\t49 |   logging {\n\t\t50 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t51 |     target_prefix = \"s3/govuk-assets-${var.aws_environment}/\"\n\t\t52 |   }\n\t\t53 | \n\t\t54 |   versioning {\n\t\t55 |     enabled = true\n\t\t56 |   }\n\t\t57 | \n\t\t58 |   replication_configuration {\n\t\t59 |     role = \"${aws_iam_role.backup.arn}\"\n\t\t60 | \n\t\t61 |     rules {\n\t\t62 |       id     = \"govuk-${var.aws_environment}-assets-replication-rule\"\n\t\t63 |       prefix = \"\"\n\t\t64 |       status = \"Enabled\"\n\t\t65 | \n\t\t66 |       destination {\n\t\t67 |         bucket        = \"${aws_s3_bucket.assets_backup.arn}\"\n\t\t68 |         storage_class = \"STANDARD\"\n\t\t69 |       }\n\t\t70 |     }\n\t\t71 |   }\n\t\t72 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.activestorage\n\tFile: /terraform/projects/infra-content-publisher/main.tf:59-90\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t59 | resource \"aws_s3_bucket\" \"activestorage\" {\n\t\t60 |   bucket = \"govuk-${var.aws_environment}-content-publisher-activestorage\"\n\t\t61 | \n\t\t62 |   tags {\n\t\t63 |     Name            = \"govuk-${var.aws_environment}-content-publisher-activestorage\"\n\t\t64 |     aws_environment = \"${var.aws_environment}\"\n\t\t65 |   }\n\t\t66 | \n\t\t67 |   logging {\n\t\t68 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t69 |     target_prefix = \"s3/govuk-${var.aws_environment}-content-publisher-activestorage/\"\n\t\t70 |   }\n\t\t71 | \n\t\t72 |   versioning {\n\t\t73 |     enabled = true\n\t\t74 |   }\n\t\t75 | \n\t\t76 |   replication_configuration {\n\t\t77 |     role = \"${aws_iam_role.govuk_content_publisher_activestorage_replication_role.arn}\"\n\t\t78 | \n\t\t79 |     rules {\n\t\t80 |       id     = \"govuk-content-publisher-activestorage-replication-whole-bucket-rule\"\n\t\t81 |       prefix = \"\"\n\t\t82 |       status = \"${var.replication_setting}\"\n\t\t83 | \n\t\t84 |       destination {\n\t\t85 |         bucket        = \"${aws_s3_bucket.activestorage_replica.arn}\"\n\t\t86 |         storage_class = \"STANDARD\"\n\t\t87 |       }\n\t\t88 |     }\n\t\t89 |   }\n\t\t90 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.database_backups_replica\n\tFile: /terraform/projects/infra-database-backups-bucket/main.tf:279-287\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t279 | resource \"aws_s3_bucket\" \"database_backups_replica\" {\n\t\t280 |   bucket   = \"govuk-${var.aws_environment}-database-backups-replica\"\n\t\t281 |   region   = \"${var.aws_backup_region}\"\n\t\t282 |   provider = \"aws.eu-london\"\n\t\t283 | \n\t\t284 |   versioning {\n\t\t285 |     enabled = true\n\t\t286 |   }\n\t\t287 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.datagovuk-organogram\n\tFile: /terraform/projects/infra-datagovuk-organogram-bucket/main.tf:63-84\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t63 | resource \"aws_s3_bucket\" \"datagovuk-organogram\" {\n\t\t64 |   bucket = \"datagovuk-${var.aws_environment}-ckan-organogram\"\n\t\t65 | \n\t\t66 |   cors_rule {\n\t\t67 |     allowed_methods = [\"GET\"]\n\t\t68 |     allowed_origins = \"${compact(list(var.domain, var.aws_environment == \"production\" ? \"https://staging.data.gov.uk\" : \"\"))}\"\n\t\t69 |   }\n\t\t70 | \n\t\t71 |   tags {\n\t\t72 |     Name            = \"datagovuk-${var.aws_environment}-ckan-organogram\"\n\t\t73 |     aws_environment = \"${var.aws_environment}\"\n\t\t74 |   }\n\t\t75 | \n\t\t76 |   logging {\n\t\t77 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t78 |     target_prefix = \"s3/datagovuk-${var.aws_environment}-ckan-organogram/\"\n\t\t79 |   }\n\t\t80 | \n\t\t81 |   versioning {\n\t\t82 |     enabled = true\n\t\t83 |   }\n\t\t84 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.datagovuk-static\n\tFile: /terraform/projects/infra-datagovuk-static-bucket/main.tf:63-79\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t63 | resource \"aws_s3_bucket\" \"datagovuk-static\" {\n\t\t64 |   bucket = \"datagovuk-${var.aws_environment}-ckan-static-data\"\n\t\t65 | \n\t\t66 |   tags {\n\t\t67 |     Name            = \"datagovuk-${var.aws_environment}-ckan-static-data\"\n\t\t68 |     aws_environment = \"${var.aws_environment}\"\n\t\t69 |   }\n\t\t70 | \n\t\t71 |   logging {\n\t\t72 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t73 |     target_prefix = \"s3/datagovuk-${var.aws_environment}-ckan-static-data/\"\n\t\t74 |   }\n\t\t75 | \n\t\t76 |   versioning {\n\t\t77 |     enabled = true\n\t\t78 |   }\n\t\t79 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.cdn_logs_monitor\n\tFile: /terraform/projects/infra-govuk-cdn-logs-monitor-bucket/main.tf:39-51\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t39 | resource \"aws_s3_bucket\" \"cdn_logs_monitor\" {\n\t\t40 |   bucket = \"govuk-${var.aws_environment}-cdn-logs-monitor-archive\"\n\t\t41 | \n\t\t42 |   tags {\n\t\t43 |     Name            = \"govuk-${var.aws_environment}-cdn-logs-monitor-archive\"\n\t\t44 |     aws_environment = \"${var.aws_environment}\"\n\t\t45 |   }\n\t\t46 | \n\t\t47 |   logging {\n\t\t48 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t49 |     target_prefix = \"s3/govuk-${var.aws_environment}-cdn-logs-monitor-archive/\"\n\t\t50 |   }\n\t\t51 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.specialist_publisher_csvs\n\tFile: /terraform/projects/infra-specialist-publisher/main.tf:35-47\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t35 | resource \"aws_s3_bucket\" \"specialist_publisher_csvs\" {\n\t\t36 |   bucket = \"govuk-${var.aws_environment}-specialist-publisher-csvs\"\n\t\t37 | \n\t\t38 |   tags {\n\t\t39 |     name            = \"govuk-${var.aws_environment}-specialist-publisher-csvs\"\n\t\t40 |     aws_environment = \"${var.aws_environment}\"\n\t\t41 |   }\n\t\t42 | \n\t\t43 |   logging {\n\t\t44 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t45 |     target_prefix = \"s3/govuk-${var.aws_environment}-specialist-publisher-csvs/\"\n\t\t46 |   }\n\t\t47 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.support_api_csvs\n\tFile: /terraform/projects/infra-support-api/main.tf:35-47\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t35 | resource \"aws_s3_bucket\" \"support_api_csvs\" {\n\t\t36 |   bucket = \"govuk-${var.aws_environment}-support-api-csvs\"\n\t\t37 | \n\t\t38 |   tags {\n\t\t39 |     name            = \"govuk-${var.aws_environment}-support-api-csvs\"\n\t\t40 |     aws_environment = \"${var.aws_environment}\"\n\t\t41 |   }\n\t\t42 | \n\t\t43 |   logging {\n\t\t44 |     target_bucket = \"${data.terraform_remote_state.infra_monitoring.aws_logging_bucket_id}\"\n\t\t45 |     target_prefix = \"s3/govuk-${var.aws_environment}-support-api-csvs/\"\n\t\t46 |   }\n\t\t47 | }\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/alphagov-govuk-aws-f844cd8e254b161bebef04101f8ce177bcd0840c/after/terraform/projects/infra-fastly-logs/main.tfֿ\n\n",
      "stderr": "2024-06-20 20:01:46,422 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/alphagov/csw-client-role.git:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:01:46,423 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/alphagov/tech-ops.git?ref=13f54e5//cyber-security/modules/gds_security_audit_role:None (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 45.953752384000836
    }
  },
  {
    "pattern": "Object storage lifecycle rules",
    "url": "https://github.com/alphagov/govuk-terraform-provisioning/commit/ac105ab0a5ae38fbf69167e072f8970a4a61c3e8",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 6, Skipped checks: 0, Parsing errors: 1\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.private_s3_bucket.aws_s3_bucket.bucket\n\tFile: /modules/private_s3_bucket/main.tf:39-67\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.lambda_app_bucket.aws_s3_bucket.bucket\n\tFile: /modules/private_s3_bucket/main.tf:39-67\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: module.paired_user.aws_s3_bucket.bucket\n\tFile: /modules/paired_user/main.tf:38-46\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t38 | resource \"aws_s3_bucket\" \"bucket\" {\n\t\t39 |     bucket = \"${var.bucket_name}-${var.environment}\"\n\t\t40 |     policy = \"${template_file.readonly_policy_file.rendered}\"\n\t\t41 | \n\t\t42 |     tags {\n\t\t43 |         Environment = \"${var.environment}\"\n\t\t44 |         Team = \"${var.team}\"\n\t\t45 |     }\n\t\t46 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.terraform_state_bucket\n\tFile: /projects/aws_bootstrap/resources/state_bucket.tf:11-18\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t11 | resource \"aws_s3_bucket\" \"terraform_state_bucket\" {\n\t\t12 |     acl = \"private\"\n\t\t13 |     bucket = \"${var.terraform_state_bucket_name}-${var.environment}\"\n\t\t14 |     tags {\n\t\t15 |         Environment = \"${var.environment}\"\n\t\t16 |         Team = \"Infrastructure\"\n\t\t17 |     }\n\t\t18 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.email_alert_inbox_bucket\n\tFile: /projects/email_alert_notifications/resources/email_alert_notifications.tf:34-38\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t34 | resource \"aws_s3_bucket\" \"email_alert_inbox_bucket\" {\n\t\t35 |   bucket = \"${var.s3_bucket_name}-${var.environment}\"\n\t\t36 |   acl = \"public-read\"\n\t\t37 |   policy = \"${template_file.s3_bucket_policy.rendered}\"\n\t\t38 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.govuk-mongodb-backup-s3\n\tFile: /projects/mongodb-backup-s3/resources/storage_and_access.tf:33-44\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t33 | resource \"aws_s3_bucket\" \"govuk-mongodb-backup-s3\" {\n\t\t34 |     bucket = \"${var.bucket_name}-${var.environment}\"\n\t\t35 | \n\t\t36 |     tags {\n\t\t37 |         Environment = \"${var.environment}\"\n\t\t38 |         Team = \"${var.team}\"\n\t\t39 |     }\n\t\t40 | \n\t\t41 |     versioning {\n\t\t42 |         enabled = \"${var.versioning}\"\n\t\t43 |     }\n\t\t44 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.govuk-mongodb-backup-s3-daily\n\tFile: /projects/mongodb-backup-s3/resources/storage_and_access.tf:48-59\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t48 | resource \"aws_s3_bucket\" \"govuk-mongodb-backup-s3-daily\" {\n\t\t49 |     bucket = \"${var.bucket_name}-daily-${var.environment}\"\n\t\t50 | \n\t\t51 |     tags {\n\t\t52 |         Environment = \"${var.environment}\"\n\t\t53 |         Team = \"${var.team}\"\n\t\t54 |     }\n\t\t55 | \n\t\t56 |     versioning {\n\t\t57 |         enabled = \"${var.versioning}\"\n\t\t58 |     }\n\t\t59 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.uktt_data_bucket\n\tFile: /projects/uktt_data/resources/production/main.tf:6-16\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t6  | resource \"aws_s3_bucket\" \"uktt_data_bucket\" {\n\t\t7  |     acl = \"private\"\n\t\t8  |     bucket = \"${var.uktt_data_bucket_name}-${var.environment}\"\n\t\t9  |     versioning {\n\t\t10 |       enabled = true\n\t\t11 |     }\n\t\t12 |     tags {\n\t\t13 |         Environment = \"${var.environment}\"\n\t\t14 |         Team = \"Infrastructure\"\n\t\t15 |     }\n\t\t16 | }\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/alphagov-govuk-terraform-provisioning-ac105ab0a5ae38fbf69167e072f8970a4a61c3e8/before-c167e29c9d5867b897bd035315341d14fff84f29/projects/uktt_data/README.tfֿ\n\n",
        "stderr": "",
        "duration_seconds": 5.499826572000529
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 4, Failed checks: 4, Skipped checks: 0, Parsing errors: 1\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.private_s3_bucket.aws_s3_bucket.bucket\n\tFile: /modules/private_s3_bucket/main.tf:39-67\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.lambda_app_bucket.aws_s3_bucket.bucket\n\tFile: /modules/private_s3_bucket/main.tf:39-67\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.govuk-mongodb-backup-s3\n\tFile: /projects/mongodb-backup-s3/resources/storage_and_access.tf:33-53\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.govuk-mongodb-backup-s3-daily\n\tFile: /projects/mongodb-backup-s3/resources/storage_and_access.tf:57-85\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: module.paired_user.aws_s3_bucket.bucket\n\tFile: /modules/paired_user/main.tf:38-46\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t38 | resource \"aws_s3_bucket\" \"bucket\" {\n\t\t39 |     bucket = \"${var.bucket_name}-${var.environment}\"\n\t\t40 |     policy = \"${template_file.readonly_policy_file.rendered}\"\n\t\t41 | \n\t\t42 |     tags {\n\t\t43 |         Environment = \"${var.environment}\"\n\t\t44 |         Team = \"${var.team}\"\n\t\t45 |     }\n\t\t46 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.terraform_state_bucket\n\tFile: /projects/aws_bootstrap/resources/state_bucket.tf:11-18\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t11 | resource \"aws_s3_bucket\" \"terraform_state_bucket\" {\n\t\t12 |     acl = \"private\"\n\t\t13 |     bucket = \"${var.terraform_state_bucket_name}-${var.environment}\"\n\t\t14 |     tags {\n\t\t15 |         Environment = \"${var.environment}\"\n\t\t16 |         Team = \"Infrastructure\"\n\t\t17 |     }\n\t\t18 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.email_alert_inbox_bucket\n\tFile: /projects/email_alert_notifications/resources/email_alert_notifications.tf:34-38\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t34 | resource \"aws_s3_bucket\" \"email_alert_inbox_bucket\" {\n\t\t35 |   bucket = \"${var.s3_bucket_name}-${var.environment}\"\n\t\t36 |   acl = \"public-read\"\n\t\t37 |   policy = \"${template_file.s3_bucket_policy.rendered}\"\n\t\t38 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.uktt_data_bucket\n\tFile: /projects/uktt_data/resources/production/main.tf:6-16\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t6  | resource \"aws_s3_bucket\" \"uktt_data_bucket\" {\n\t\t7  |     acl = \"private\"\n\t\t8  |     bucket = \"${var.uktt_data_bucket_name}-${var.environment}\"\n\t\t9  |     versioning {\n\t\t10 |       enabled = true\n\t\t11 |     }\n\t\t12 |     tags {\n\t\t13 |         Environment = \"${var.environment}\"\n\t\t14 |         Team = \"Infrastructure\"\n\t\t15 |     }\n\t\t16 | }\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/alphagov-govuk-terraform-provisioning-ac105ab0a5ae38fbf69167e072f8970a4a61c3e8/after/projects/uktt_data/README.tfֿ\n\n",
      "stderr": "",
      "duration_seconds": 5.736288954998599
    }
  },
  {
    "pattern": "Object storage lifecycle rules",
    "url": "https://github.com/ExpediaGroup/apiary-data-lake/commit/47e62f2fc73a96611606cd619c084d1ded9d844d",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.apiary_data_bucket\n\tFile: /s3.tf:28-40\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t28 | resource \"aws_s3_bucket\" \"apiary_data_bucket\" {\n\t\t29 |   count         = \"${length(local.apiary_data_buckets)}\"\n\t\t30 |   bucket        = \"${element(local.apiary_data_buckets, count.index)}\"\n\t\t31 |   acl           = \"private\"\n\t\t32 |   request_payer = \"BucketOwner\"\n\t\t33 |   policy        = \"${data.template_file.bucket_policy.*.rendered[count.index]}\"\n\t\t34 |   tags          = \"${var.apiary_tags}\"\n\t\t35 | \n\t\t36 |   logging {\n\t\t37 |     target_bucket = \"${var.apiary_log_bucket}\"\n\t\t38 |     target_prefix = \"${var.apiary_log_prefix}${local.apiary_data_buckets[count.index]}/\"\n\t\t39 |   }\n\t\t40 | }\n\nterraform_plan scan results:\n\nPassed checks: 0, Failed checks: 0, Skipped checks: 0, Parsing errors: 2\n\nError parsing file snapshots/ExpediaGroup-apiary-data-lake-47e62f2fc73a96611606cd619c084d1ded9d844d/before-f3c3068c66185f51ba97ed71a14ffdbea2a698b1/templates/apiary-hms-readonly.jsonֿ\nError parsing file snapshots/ExpediaGroup-apiary-data-lake-47e62f2fc73a96611606cd619c084d1ded9d844d/before-f3c3068c66185f51ba97ed71a14ffdbea2a698b1/templates/apiary-hms-readwrite.jsonֿ\n\n",
        "stderr": "",
        "duration_seconds": 4.714252231999126
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: aws_s3_bucket.apiary_data_bucket\n\tFile: /s3.tf:28-50\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nterraform_plan scan results:\n\nPassed checks: 0, Failed checks: 0, Skipped checks: 0, Parsing errors: 2\n\nError parsing file snapshots/ExpediaGroup-apiary-data-lake-47e62f2fc73a96611606cd619c084d1ded9d844d/after/templates/apiary-hms-readonly.jsonֿ\nError parsing file snapshots/ExpediaGroup-apiary-data-lake-47e62f2fc73a96611606cd619c084d1ded9d844d/after/templates/apiary-hms-readwrite.jsonֿ\n\n",
      "stderr": "",
      "duration_seconds": 4.653300388999924
    }
  },
  {
    "pattern": "Object storage lifecycle rules",
    "url": "https://github.com/SamTowne/BasketballDrillBot/commit/4ec6d54e4d36ab02b0a7daf042e727717371eaec",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 4, Skipped checks: 0\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: module.bootstrap.aws_s3_bucket.state_bucket\n\tFile: /modules/bootstrap/bootstrap.tf:2-18\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t2  | resource \"aws_s3_bucket\" \"state_bucket\" {\n\t\t3  |   bucket = var.tfstate_bucket\n\t\t4  | \n\t\t5  |   # Tells AWS to encrypt the S3 bucket at rest by default\n\t\t6  |   server_side_encryption_configuration {\n\t\t7  |     rule {\n\t\t8  |       apply_server_side_encryption_by_default {\n\t\t9  |         sse_algorithm = \"AES256\"\n\t\t10 |       }\n\t\t11 |     }\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   # Tells AWS to keep a version history of the state file\n\t\t15 |   versioning {\n\t\t16 |     enabled = true\n\t\t17 |   }\n\t\t18 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: module.bootstrap.aws_s3_bucket.s3_logging_bucket\n\tFile: /modules/bootstrap/bootstrap.tf:39-50\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t39 | resource \"aws_s3_bucket\" \"s3_logging_bucket\" {\n\t\t40 |   bucket = var.logging_bucket\n\t\t41 |   acl    = \"private\"\n\t\t42 | \n\t\t43 |   server_side_encryption_configuration {\n\t\t44 |     rule {\n\t\t45 |       apply_server_side_encryption_by_default {\n\t\t46 |         sse_algorithm = \"AES256\"\n\t\t47 |       }\n\t\t48 |     }\n\t\t49 |   }\n\t\t50 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: module.bootstrap.aws_s3_bucket.s3_data_bucket\n\tFile: /modules/bootstrap/bootstrap.tf:53-87\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t53 | resource \"aws_s3_bucket\" \"s3_data_bucket\" {\n\t\t54 |   bucket = var.data_bucket\n\t\t55 |   acl    = \"private\"\n\t\t56 |   policy = <<EOT\n\t\t57 | {\n\t\t58 |   \"Id\": \"SIDataBucketPolicy\",\n\t\t59 |   \"Version\": \"2012-10-17\",\n\t\t60 |   \"Statement\": [\n\t\t61 |     {\n\t\t62 |       \"Sid\": \"lambda\",\n\t\t63 |       \"Action\": [\n\t\t64 |         \"s3:PutObject\"\n\t\t65 |       ],\n\t\t66 |       \"Effect\": \"Allow\",\n\t\t67 |       \"Resource\": [\n\t\t68 |         \"arn:aws:s3:::shooting-insights-data/*\"\n\t\t69 |       ],\n\t\t70 |       \"Principal\": {\n\t\t71 |         \"AWS\": [\n\t\t72 |           \"arn:aws:iam::272773485930:role/collection_lambda_role\"\n\t\t73 |         ]\n\t\t74 |       }\n\t\t75 |     }\n\t\t76 |   ]\n\t\t77 | }\n\t\t78 |   EOT\n\t\t79 | \n\t\t80 |   server_side_encryption_configuration {\n\t\t81 |     rule {\n\t\t82 |       apply_server_side_encryption_by_default {\n\t\t83 |         sse_algorithm = \"AES256\"\n\t\t84 |       }\n\t\t85 |     }\n\t\t86 |   }\n\t\t87 | }\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: module.processing.aws_s3_bucket.athena_results_bucket\n\tFile: /modules/processing/processing.tf:2-37\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t2  | resource \"aws_s3_bucket\" \"athena_results_bucket\" {\n\t\t3  |   bucket = \"shooting-insights-athena-results\"\n\t\t4  |   acl    = \"private\"\n\t\t5  |   policy = <<EOT\n\t\t6  | {\n\t\t7  |   \"Id\": \"SIDataBucketPolicy\",\n\t\t8  |   \"Version\": \"2012-10-17\",\n\t\t9  |   \"Statement\": [\n\t\t10 |     {\n\t\t11 |       \"Sid\": \"lambda\",\n\t\t12 |       \"Action\": [\n\t\t13 |         \"s3:PutObject\"\n\t\t14 |       ],\n\t\t15 |       \"Effect\": \"Allow\",\n\t\t16 |       \"Resource\": [\n\t\t17 |         \"arn:aws:s3:::shooting-insights-athena-results/*\"\n\t\t18 |       ],\n\t\t19 |       \"Principal\": {\n\t\t20 |         \"AWS\": [\n\t\t21 |           \"arn:aws:iam::272773485930:role/collection_lambda_role\",\n\t\t22 |           \"arn:aws:iam::272773485930:role/processing_lambda_role\"\n\t\t23 |         ]\n\t\t24 |       }\n\t\t25 |     }\n\t\t26 |   ]\n\t\t27 | }\n\t\t28 |   EOT\n\t\t29 | \n\t\t30 |   server_side_encryption_configuration {\n\t\t31 |     rule {\n\t\t32 |       apply_server_side_encryption_by_default {\n\t\t33 |         sse_algorithm = \"AES256\"\n\t\t34 |       }\n\t\t35 |     }\n\t\t36 |   }\n\t\t37 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 5.402257447000011
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 5, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.bootstrap.aws_s3_bucket.state_bucket\n\tFile: /modules/bootstrap/bootstrap.tf:2-32\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.bootstrap.aws_s3_bucket.s3_data_bucket\n\tFile: /modules/bootstrap/bootstrap.tf:52-101\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.collection.aws_s3_bucket.shooting_insights_temp_bucket\n\tFile: /modules/collection/collection.tf:102-149\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.processing.aws_s3_bucket.athena_results_bucket\n\tFile: /modules/processing/processing.tf:2-53\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.processing.aws_s3_bucket.setup_processing_results_bucket\n\tFile: /modules/processing/processing.tf:56-105\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n",
      "stderr": "",
      "duration_seconds": 4.992753796001125
    }
  },
  {
    "pattern": "Object storage lifecycle rules",
    "url": "https://github.com/utilitywarehouse/tf_telecom/commit/17007456991c1a8faa26b1f4ac993883f577d124",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: aws_s3_bucket.bucket\n\tFile: /aws/bucket/main.tf:105-118\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t105 | resource \"aws_s3_bucket\" \"bucket\" {\n\t\t106 |   bucket = format(\n\t\t107 |     \"uw-%s-%s-%s\",\n\t\t108 |     replace(var.team, \"/^uw-/\", \"\"),\n\t\t109 |     var.name,\n\t\t110 |     var.env,\n\t\t111 |   )\n\t\t112 |   acl    = \"private\"\n\t\t113 |   policy = data.aws_iam_policy_document.access.json\n\t\t114 |   tags = {\n\t\t115 |     terraform = \"Managed by terraform\"\n\t\t116 |     team      = var.team\n\t\t117 |   }\n\t\t118 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 4.785379528000703
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 0, Skipped checks: 0, Parsing errors: 1\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/utilitywarehouse-tf_telecom-17007456991c1a8faa26b1f4ac993883f577d124/after/aws/bucket/main.tfֿ\n\n",
      "stderr": "",
      "duration_seconds": 5.863543281000602
    }
  },
  {
    "pattern": "Object storage lifecycle rules",
    "url": "https://github.com/trajano/terraform-s3-backend/commit/cb9f00a2f6f23b44f7db08863ef5fb0b9ea0bc0c",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tFAILED for resource: module.terraform-s3-backend.aws_s3_bucket.terraform\n\tFile: /main.tf:45-57\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n\t\t45 | resource \"aws_s3_bucket\" \"terraform\" {\n\t\t46 |   bucket = var.bucket\n\t\t47 |   acl    = \"private\"\n\t\t48 |   region = var.region\n\t\t49 | \n\t\t50 |   tags = {\n\t\t51 |     Name = \"Terraform S3 backend bucket\"\n\t\t52 |   }\n\t\t53 | \n\t\t54 |   versioning {\n\t\t55 |     enabled = true\n\t\t56 |   }\n\t\t57 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 4.4546513490004145
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV2_AWS_61: \"Ensure that an S3 bucket has a lifecycle configuration\"\n\tPASSED for resource: module.terraform-s3-backend.aws_s3_bucket.terraform\n\tFile: /main.tf:45-64\n\tGuide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61\n\n",
      "stderr": "",
      "duration_seconds": 4.325429058000736
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/deptno/terraform-aws-modules/commit/49f447bdbb3cf23499e8194e78f852ea1e256d3a",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.token\n\tFile: /serverless-passport/main.tf:1-18\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.token\n\tFile: /serverless-passport/main.tf:1-18\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.token\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /serverless-passport/main.tf:1-18\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource aws_dynamodb_table token {\n\t\t2  |   name = var.token-table-name\n\t\t3  |   hash_key = var.token-table-hash-key\n\t\t4  |   range_key = var.token-table-range-key\n\t\t5  | \n\t\t6  |   ttl {\n\t\t7  |     attribute_name = var.token-table-ttl-key\n\t\t8  |   }\n\t\t9  | \n\t\t10 |   attribute {\n\t\t11 |     name = var.token-table-hash-key\n\t\t12 |     type = \"S\"\n\t\t13 |   }\n\t\t14 |   attribute {\n\t\t15 |     name = var.token-table-range-key\n\t\t16 |     type = \"S\"\n\t\t17 |   }\n\t\t18 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 4.393681090001337
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.token\n\tFile: /serverless-passport/main.tf:1-19\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.token\n\tFile: /serverless-passport/main.tf:1-19\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.token\n\tFile: /serverless-passport/main.tf:1-19\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "",
      "duration_seconds": 4.218673991999822
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/ONSdigital/eq-terraform-dynamodb/commit/40eb651a50d0dfd5cf047ef62c8a6259c1c66e02",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 4, Failed checks: 8, Skipped checks: 0\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.eq_session_table\n\tFile: /eq_session.tf:1-29\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.questionnaire_state_table\n\tFile: /questionnaire_state.tf:1-20\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.submitted_responses_table\n\tFile: /submitted_responses.tf:1-25\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.used_jti_claim_table\n\tFile: /used_jti_claim.tf:1-25\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.eq_session_table\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /eq_session.tf:1-29\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"eq_session_table\" {\n\t\t2  |   name           = \"${var.env}-eq-session\"\n\t\t3  |   read_capacity  = \"${var.eq_session_min_read_capacity}\"\n\t\t4  |   write_capacity = \"${var.eq_session_min_write_capacity}\"\n\t\t5  |   hash_key       = \"eq_session_id\"\n\t\t6  | \n\t\t7  |   attribute {\n\t\t8  |     name = \"eq_session_id\"\n\t\t9  |     type = \"S\"\n\t\t10 |   }\n\t\t11 | \n\t\t12 |   ttl {\n\t\t13 |     attribute_name = \"expires_at\"\n\t\t14 |     enabled        = true\n\t\t15 |   }\n\t\t16 | \n\t\t17 |   tags {\n\t\t18 |     Name        = \"${var.env}-eq-session\"\n\t\t19 |     Environment = \"${var.env}\"\n\t\t20 |   }\n\t\t21 | \n\t\t22 |   point_in_time_recovery {\n\t\t23 |     enabled = true\n\t\t24 |   }\n\t\t25 | \n\t\t26 |   lifecycle {\n\t\t27 |     ignore_changes = [\"read_capacity\", \"write_capacity\"]\n\t\t28 |   }\n\t\t29 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.eq_session_table\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /eq_session.tf:1-29\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"eq_session_table\" {\n\t\t2  |   name           = \"${var.env}-eq-session\"\n\t\t3  |   read_capacity  = \"${var.eq_session_min_read_capacity}\"\n\t\t4  |   write_capacity = \"${var.eq_session_min_write_capacity}\"\n\t\t5  |   hash_key       = \"eq_session_id\"\n\t\t6  | \n\t\t7  |   attribute {\n\t\t8  |     name = \"eq_session_id\"\n\t\t9  |     type = \"S\"\n\t\t10 |   }\n\t\t11 | \n\t\t12 |   ttl {\n\t\t13 |     attribute_name = \"expires_at\"\n\t\t14 |     enabled        = true\n\t\t15 |   }\n\t\t16 | \n\t\t17 |   tags {\n\t\t18 |     Name        = \"${var.env}-eq-session\"\n\t\t19 |     Environment = \"${var.env}\"\n\t\t20 |   }\n\t\t21 | \n\t\t22 |   point_in_time_recovery {\n\t\t23 |     enabled = true\n\t\t24 |   }\n\t\t25 | \n\t\t26 |   lifecycle {\n\t\t27 |     ignore_changes = [\"read_capacity\", \"write_capacity\"]\n\t\t28 |   }\n\t\t29 | }\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.questionnaire_state_table\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /questionnaire_state.tf:1-20\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"questionnaire_state_table\" {\n\t\t2  |   name           = \"${var.env}-questionnaire-state\"\n\t\t3  |   read_capacity  = \"${var.questionnaire_state_min_read_capacity}\"\n\t\t4  |   write_capacity = \"${var.questionnaire_state_min_write_capacity}\"\n\t\t5  |   hash_key       = \"user_id\"\n\t\t6  | \n\t\t7  |   attribute {\n\t\t8  |     name = \"user_id\"\n\t\t9  |     type = \"S\"\n\t\t10 |   }\n\t\t11 | \n\t\t12 |   tags {\n\t\t13 |     Name        = \"${var.env}-questionnaire-state\"\n\t\t14 |     Environment = \"${var.env}\"\n\t\t15 |   }\n\t\t16 | \n\t\t17 |   lifecycle {\n\t\t18 |     ignore_changes = [\"read_capacity\", \"write_capacity\"]\n\t\t19 |   }\n\t\t20 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.questionnaire_state_table\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /questionnaire_state.tf:1-20\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"questionnaire_state_table\" {\n\t\t2  |   name           = \"${var.env}-questionnaire-state\"\n\t\t3  |   read_capacity  = \"${var.questionnaire_state_min_read_capacity}\"\n\t\t4  |   write_capacity = \"${var.questionnaire_state_min_write_capacity}\"\n\t\t5  |   hash_key       = \"user_id\"\n\t\t6  | \n\t\t7  |   attribute {\n\t\t8  |     name = \"user_id\"\n\t\t9  |     type = \"S\"\n\t\t10 |   }\n\t\t11 | \n\t\t12 |   tags {\n\t\t13 |     Name        = \"${var.env}-questionnaire-state\"\n\t\t14 |     Environment = \"${var.env}\"\n\t\t15 |   }\n\t\t16 | \n\t\t17 |   lifecycle {\n\t\t18 |     ignore_changes = [\"read_capacity\", \"write_capacity\"]\n\t\t19 |   }\n\t\t20 | }\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.submitted_responses_table\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /submitted_responses.tf:1-25\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"submitted_responses_table\" {\n\t\t2  |   name           = \"${var.env}-submitted-responses\"\n\t\t3  |   read_capacity  = \"${var.submitted_responses_min_read_capacity}\"\n\t\t4  |   write_capacity = \"${var.submitted_responses_min_write_capacity}\"\n\t\t5  |   hash_key       = \"tx_id\"\n\t\t6  | \n\t\t7  |   attribute {\n\t\t8  |     name = \"tx_id\"\n\t\t9  |     type = \"S\"\n\t\t10 |   }\n\t\t11 | \n\t\t12 |   ttl {\n\t\t13 |     attribute_name = \"valid_until\"\n\t\t14 |     enabled        = true\n\t\t15 |   }\n\t\t16 | \n\t\t17 |   tags {\n\t\t18 |     Name        = \"${var.env}-submitted-responses\"\n\t\t19 |     Environment = \"${var.env}\"\n\t\t20 |   }\n\t\t21 | \n\t\t22 |   lifecycle {\n\t\t23 |     ignore_changes = [\"read_capacity\", \"write_capacity\"]\n\t\t24 |   }\n\t\t25 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.submitted_responses_table\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /submitted_responses.tf:1-25\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"submitted_responses_table\" {\n\t\t2  |   name           = \"${var.env}-submitted-responses\"\n\t\t3  |   read_capacity  = \"${var.submitted_responses_min_read_capacity}\"\n\t\t4  |   write_capacity = \"${var.submitted_responses_min_write_capacity}\"\n\t\t5  |   hash_key       = \"tx_id\"\n\t\t6  | \n\t\t7  |   attribute {\n\t\t8  |     name = \"tx_id\"\n\t\t9  |     type = \"S\"\n\t\t10 |   }\n\t\t11 | \n\t\t12 |   ttl {\n\t\t13 |     attribute_name = \"valid_until\"\n\t\t14 |     enabled        = true\n\t\t15 |   }\n\t\t16 | \n\t\t17 |   tags {\n\t\t18 |     Name        = \"${var.env}-submitted-responses\"\n\t\t19 |     Environment = \"${var.env}\"\n\t\t20 |   }\n\t\t21 | \n\t\t22 |   lifecycle {\n\t\t23 |     ignore_changes = [\"read_capacity\", \"write_capacity\"]\n\t\t24 |   }\n\t\t25 | }\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.used_jti_claim_table\n\tDetails: Using high write capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /used_jti_claim.tf:1-25\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"used_jti_claim_table\" {\n\t\t2  |   name           = \"${var.env}-used-jti-claim\"\n\t\t3  |   read_capacity  = \"${var.used_jti_claim_min_read_capacity}\"\n\t\t4  |   write_capacity = \"${var.used_jti_claim_min_write_capacity}\"\n\t\t5  |   hash_key       = \"jti_claim\"\n\t\t6  | \n\t\t7  |   attribute {\n\t\t8  |     name = \"jti_claim\"\n\t\t9  |     type = \"S\"\n\t\t10 |   }\n\t\t11 | \n\t\t12 |   ttl {\n\t\t13 |     attribute_name = \"expires\"\n\t\t14 |     enabled        = true\n\t\t15 |   }\n\t\t16 | \n\t\t17 |   tags {\n\t\t18 |     Name        = \"${var.env}-used-jti-claim\"\n\t\t19 |     Environment = \"${var.env}\"\n\t\t20 |   }\n\t\t21 | \n\t\t22 |   lifecycle {\n\t\t23 |     ignore_changes = [\"read_capacity\", \"write_capacity\"]\n\t\t24 |   }\n\t\t25 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.used_jti_claim_table\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /used_jti_claim.tf:1-25\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"used_jti_claim_table\" {\n\t\t2  |   name           = \"${var.env}-used-jti-claim\"\n\t\t3  |   read_capacity  = \"${var.used_jti_claim_min_read_capacity}\"\n\t\t4  |   write_capacity = \"${var.used_jti_claim_min_write_capacity}\"\n\t\t5  |   hash_key       = \"jti_claim\"\n\t\t6  | \n\t\t7  |   attribute {\n\t\t8  |     name = \"jti_claim\"\n\t\t9  |     type = \"S\"\n\t\t10 |   }\n\t\t11 | \n\t\t12 |   ttl {\n\t\t13 |     attribute_name = \"expires\"\n\t\t14 |     enabled        = true\n\t\t15 |   }\n\t\t16 | \n\t\t17 |   tags {\n\t\t18 |     Name        = \"${var.env}-used-jti-claim\"\n\t\t19 |     Environment = \"${var.env}\"\n\t\t20 |   }\n\t\t21 | \n\t\t22 |   lifecycle {\n\t\t23 |     ignore_changes = [\"read_capacity\", \"write_capacity\"]\n\t\t24 |   }\n\t\t25 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 4.492025296000065
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 12, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.eq_session_table\n\tFile: /eq_session.tf:1-28\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.eq_session_table\n\tFile: /eq_session.tf:1-28\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.eq_session_table\n\tFile: /eq_session.tf:1-28\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.questionnaire_state_table\n\tFile: /questionnaire_state.tf:1-19\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.questionnaire_state_table\n\tFile: /questionnaire_state.tf:1-19\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.questionnaire_state_table\n\tFile: /questionnaire_state.tf:1-19\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.submitted_responses_table\n\tFile: /submitted_responses.tf:1-24\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.submitted_responses_table\n\tFile: /submitted_responses.tf:1-24\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.submitted_responses_table\n\tFile: /submitted_responses.tf:1-24\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.used_jti_claim_table\n\tFile: /used_jti_claim.tf:1-24\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.used_jti_claim_table\n\tFile: /used_jti_claim.tf:1-24\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.used_jti_claim_table\n\tFile: /used_jti_claim.tf:1-24\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "",
      "duration_seconds": 4.497306405999552
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/olliefr/aws-terraform-cloud1/commit/bf753832a519b0649f8d58d93aa643afe3f94fc7",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.tfc_example_table\n\tFile: /example.tf:45-56\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.tfc_example_table\n\tFile: /example.tf:45-56\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.tfc_example_table\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /example.tf:45-56\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t45 | resource \"aws_dynamodb_table\" \"tfc_example_table\" {\n\t\t46 |   name = \"${var.db_table_name}-${random_pet.table_name.id}\"\n\t\t47 | \n\t\t48 |   read_capacity  = var.db_read_capacity\n\t\t49 |   write_capacity = var.db_write_capacity\n\t\t50 |   hash_key       = \"UUID\"\n\t\t51 | \n\t\t52 |   attribute {\n\t\t53 |     name = \"UUID\"\n\t\t54 |     type = \"S\"\n\t\t55 |   }\n\t\t56 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 4.458162267999796
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.tfc_example_table\n\tFile: /example.tf:45-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.tfc_example_table\n\tFile: /example.tf:45-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.tfc_example_table\n\tFile: /example.tf:45-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "",
      "duration_seconds": 4.569096334000278
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/garylb2/terraform-example-patterns/commit/6de6d83d930bd9459e1cf8c311fa7b45c3f90987",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 6, Failed checks: 12, Skipped checks: 0, Parsing errors: 9\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.data\n\tFile: /basic-terraform/awsaccnt1/us-west-2/lookup/dynamodb.tf:3-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.data\n\tFile: /basic-terraform/nonprod/us-west-2/lookup/dynamodb.tf:3-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.persistence.aws_dynamodb_table.data\n\tFile: /dry-workspace-terragrunt/modules/persistence/main.tf:3-57\n\tCalling File: /dry-workspace-terragrunt/modules/plumbing/main.tf:14-21\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.persistence.aws_dynamodb_table.data\n\tFile: /envvar-terragrunt/modules/persistence/main.tf:3-57\n\tCalling File: /envvar-terragrunt/modules/plumbing/main.tf:6-12\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.persistence.aws_dynamodb_table.data\n\tFile: /module-terraform/modules/persistence/main.tf:3-57\n\tCalling File: /module-terraform/awsaccnt1/us-west-2/lookup/main.tf:34-40\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.data\n\tFile: /module-terragrunt/modules/persistence/main.tf:3-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: aws_dynamodb_table.data\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /basic-terraform/awsaccnt1/us-west-2/lookup/dynamodb.tf:3-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.data\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /basic-terraform/awsaccnt1/us-west-2/lookup/dynamodb.tf:3-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: aws_dynamodb_table.data\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /basic-terraform/nonprod/us-west-2/lookup/dynamodb.tf:3-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.data\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /basic-terraform/nonprod/us-west-2/lookup/dynamodb.tf:3-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: module.persistence.aws_dynamodb_table.data\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /dry-workspace-terragrunt/modules/persistence/main.tf:3-57\n\tCalling File: /dry-workspace-terragrunt/modules/plumbing/main.tf:14-21\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.persistence.aws_dynamodb_table.data\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /dry-workspace-terragrunt/modules/persistence/main.tf:3-57\n\tCalling File: /dry-workspace-terragrunt/modules/plumbing/main.tf:14-21\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: module.persistence.aws_dynamodb_table.data\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /envvar-terragrunt/modules/persistence/main.tf:3-57\n\tCalling File: /envvar-terragrunt/modules/plumbing/main.tf:6-12\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.persistence.aws_dynamodb_table.data\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /envvar-terragrunt/modules/persistence/main.tf:3-57\n\tCalling File: /envvar-terragrunt/modules/plumbing/main.tf:6-12\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: module.persistence.aws_dynamodb_table.data\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /module-terraform/modules/persistence/main.tf:3-57\n\tCalling File: /module-terraform/awsaccnt1/us-west-2/lookup/main.tf:34-40\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.persistence.aws_dynamodb_table.data\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /module-terraform/modules/persistence/main.tf:3-57\n\tCalling File: /module-terraform/awsaccnt1/us-west-2/lookup/main.tf:34-40\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: aws_dynamodb_table.data\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /module-terragrunt/modules/persistence/main.tf:3-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.data\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /module-terragrunt/modules/persistence/main.tf:3-57\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/before-2701c8528649a1f31badd02b46cee2f390d593d5/basic-terraform/awsaccnt1/us-west-2/lookup/api.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/before-2701c8528649a1f31badd02b46cee2f390d593d5/basic-terraform/nonprod/us-west-2/lookup/api.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/before-2701c8528649a1f31badd02b46cee2f390d593d5/dry-workspace-terragrunt/modules/api/lookup-method.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/before-2701c8528649a1f31badd02b46cee2f390d593d5/dry-workspace-terragrunt/systems/terraform.tfvarsֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/before-2701c8528649a1f31badd02b46cee2f390d593d5/envvar-terragrunt/modules/api/lookup-method.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/before-2701c8528649a1f31badd02b46cee2f390d593d5/envvar-terragrunt/systems/terraform.tfvarsֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/before-2701c8528649a1f31badd02b46cee2f390d593d5/module-terraform/modules/api/lookup-method.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/before-2701c8528649a1f31badd02b46cee2f390d593d5/module-terragrunt/modules/api/lookup-method.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/before-2701c8528649a1f31badd02b46cee2f390d593d5/module-terragrunt/systems/terraform.tfvarsֿ\n\n",
        "stderr": "",
        "duration_seconds": 5.759112383999309
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 12, Failed checks: 6, Skipped checks: 0, Parsing errors: 9\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.data\n\tFile: /basic-terraform/awsaccnt1/us-west-2/lookup/dynamodb.tf:3-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.data\n\tFile: /basic-terraform/awsaccnt1/us-west-2/lookup/dynamodb.tf:3-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.data\n\tFile: /basic-terraform/nonprod/us-west-2/lookup/dynamodb.tf:3-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.data\n\tFile: /basic-terraform/nonprod/us-west-2/lookup/dynamodb.tf:3-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.persistence.aws_dynamodb_table.data\n\tFile: /dry-workspace-terragrunt/modules/persistence/main.tf:3-47\n\tCalling File: /dry-workspace-terragrunt/modules/plumbing/main.tf:14-21\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.persistence.aws_dynamodb_table.data\n\tFile: /dry-workspace-terragrunt/modules/persistence/main.tf:3-47\n\tCalling File: /dry-workspace-terragrunt/modules/plumbing/main.tf:14-21\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.persistence.aws_dynamodb_table.data\n\tFile: /envvar-terragrunt/modules/persistence/main.tf:3-47\n\tCalling File: /envvar-terragrunt/modules/plumbing/main.tf:6-12\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.persistence.aws_dynamodb_table.data\n\tFile: /envvar-terragrunt/modules/persistence/main.tf:3-47\n\tCalling File: /envvar-terragrunt/modules/plumbing/main.tf:6-12\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.persistence.aws_dynamodb_table.data\n\tFile: /module-terraform/modules/persistence/main.tf:3-47\n\tCalling File: /module-terraform/awsaccnt1/us-west-2/lookup/main.tf:34-40\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.persistence.aws_dynamodb_table.data\n\tFile: /module-terraform/modules/persistence/main.tf:3-47\n\tCalling File: /module-terraform/awsaccnt1/us-west-2/lookup/main.tf:34-40\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.data\n\tFile: /module-terragrunt/modules/persistence/main.tf:3-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.data\n\tFile: /module-terragrunt/modules/persistence/main.tf:3-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.data\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /basic-terraform/awsaccnt1/us-west-2/lookup/dynamodb.tf:3-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t3  | resource \"aws_dynamodb_table\" \"data\" {\n\t\t4  |   name           = \"${local.application-name}-data\"\n\t\t5  |   read_capacity  = 1\n\t\t6  |   write_capacity = 1\n\t\t7  |   hash_key       = \"customerId\"\n\t\t8  |   range_key      = \"\"\n\t\t9  | \n\t\t10 |   attribute = [{\n\t\t11 |     name = \"customerId\"\n\t\t12 |     type = \"S\"\n\t\t13 |   }]\n\t\t14 | \n\t\t15 |   ttl {\n\t\t16 |     attribute_name = \"TimeToExist\"\n\t\t17 |     enabled = false\n\t\t18 |   }\n\t\t19 | \n\t\t20 |   ## stop redeploying TTL\n\t\t21 |   lifecycle {\n\t\t22 |     ignore_changes = [\"ttl\"]\n\t\t23 |   }\n\t\t24 | \n\t\t25 |   server_side_encryption {\n\t\t26 |     enabled = \"true\"\n\t\t27 |   }\n\t\t28 | \n\t\t29 |   point_in_time_recovery {\n\t\t30 |     enabled = \"false\"\n\t\t31 |   }\n\t\t32 | \n\t\t33 |   stream_enabled = \"false\"\n\t\t34 |   stream_view_type = \"\"\n\t\t35 | \n\t\t36 |   timeouts {\n\t\t37 |     create = \"10m\"\n\t\t38 |     delete = \"10m\"\n\t\t39 |     update = \"10m\"\n\t\t40 |   }\n\t\t41 | \n\t\t42 |   tags {\n\t\t43 |     Name        = \"${local.application-name}\"\n\t\t44 |     Application = \"example\"\n\t\t45 |     Environment = \"${local.env}\"\n\t\t46 |   }\n\t\t47 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.data\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /basic-terraform/nonprod/us-west-2/lookup/dynamodb.tf:3-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t3  | resource \"aws_dynamodb_table\" \"data\" {\n\t\t4  |   name           = \"${local.application-name}-data\"\n\t\t5  |   read_capacity  = 1\n\t\t6  |   write_capacity = 1\n\t\t7  |   hash_key       = \"customerId\"\n\t\t8  |   range_key      = \"\"\n\t\t9  | \n\t\t10 |   attribute = [{\n\t\t11 |     name = \"customerId\"\n\t\t12 |     type = \"S\"\n\t\t13 |   }]\n\t\t14 | \n\t\t15 |   ttl {\n\t\t16 |     attribute_name = \"TimeToExist\"\n\t\t17 |     enabled = false\n\t\t18 |   }\n\t\t19 | \n\t\t20 |   ## stop redeploying TTL\n\t\t21 |   lifecycle {\n\t\t22 |     ignore_changes = [\"ttl\"]\n\t\t23 |   }\n\t\t24 | \n\t\t25 |   server_side_encryption {\n\t\t26 |     enabled = \"true\"\n\t\t27 |   }\n\t\t28 | \n\t\t29 |   point_in_time_recovery {\n\t\t30 |     enabled = \"false\"\n\t\t31 |   }\n\t\t32 | \n\t\t33 |   stream_enabled = \"false\"\n\t\t34 |   stream_view_type = \"\"\n\t\t35 | \n\t\t36 |   timeouts {\n\t\t37 |     create = \"10m\"\n\t\t38 |     delete = \"10m\"\n\t\t39 |     update = \"10m\"\n\t\t40 |   }\n\t\t41 | \n\t\t42 |   tags {\n\t\t43 |     Name        = \"${local.application-name}\"\n\t\t44 |     Application = \"example\"\n\t\t45 |     Environment = \"${local.env}\"\n\t\t46 |   }\n\t\t47 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.persistence.aws_dynamodb_table.data\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /dry-workspace-terragrunt/modules/persistence/main.tf:3-47\n\tCalling File: /dry-workspace-terragrunt/modules/plumbing/main.tf:14-21\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t3  | resource \"aws_dynamodb_table\" \"data\" {\n\t\t4  |   name           = \"${var.resource-prefix}-data${var.resource-suffix}\"\n\t\t5  |   read_capacity  = 1\n\t\t6  |   write_capacity = 1\n\t\t7  |   hash_key       = \"customerId\"\n\t\t8  |   range_key      = \"\"\n\t\t9  | \n\t\t10 |   attribute = [{\n\t\t11 |     name = \"customerId\"\n\t\t12 |     type = \"S\"\n\t\t13 |   }]\n\t\t14 | \n\t\t15 |   ttl {\n\t\t16 |     attribute_name = \"TimeToExist\"\n\t\t17 |     enabled = false\n\t\t18 |   }\n\t\t19 | \n\t\t20 |   ## stop redeploying TTL\n\t\t21 |   lifecycle {\n\t\t22 |     ignore_changes = [\"ttl\"]\n\t\t23 |   }\n\t\t24 | \n\t\t25 |   server_side_encryption {\n\t\t26 |     enabled = \"true\"\n\t\t27 |   }\n\t\t28 | \n\t\t29 |   point_in_time_recovery {\n\t\t30 |     enabled = \"false\"\n\t\t31 |   }\n\t\t32 | \n\t\t33 |   stream_enabled = \"false\"\n\t\t34 |   stream_view_type = \"\"\n\t\t35 | \n\t\t36 |   timeouts {\n\t\t37 |     create = \"10m\"\n\t\t38 |     delete = \"10m\"\n\t\t39 |     update = \"10m\"\n\t\t40 |   }\n\t\t41 | \n\t\t42 |   tags {\n\t\t43 |     Name        = \"${var.resource-prefix}-data${var.resource-suffix}\"\n\t\t44 |     Application = \"example\"\n\t\t45 |     Environment = \"${var.env}\"\n\t\t46 |   }\n\t\t47 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.persistence.aws_dynamodb_table.data\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /envvar-terragrunt/modules/persistence/main.tf:3-47\n\tCalling File: /envvar-terragrunt/modules/plumbing/main.tf:6-12\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t3  | resource \"aws_dynamodb_table\" \"data\" {\n\t\t4  |   name           = \"${var.application-name}-data-${var.env}\"\n\t\t5  |   read_capacity  = 1\n\t\t6  |   write_capacity = 1\n\t\t7  |   hash_key       = \"customerId\"\n\t\t8  |   range_key      = \"\"\n\t\t9  | \n\t\t10 |   attribute = [{\n\t\t11 |     name = \"customerId\"\n\t\t12 |     type = \"S\"\n\t\t13 |   }]\n\t\t14 | \n\t\t15 |   ttl {\n\t\t16 |     attribute_name = \"TimeToExist\"\n\t\t17 |     enabled = false\n\t\t18 |   }\n\t\t19 | \n\t\t20 |   ## stop redeploying TTL\n\t\t21 |   lifecycle {\n\t\t22 |     ignore_changes = [\"ttl\"]\n\t\t23 |   }\n\t\t24 | \n\t\t25 |   server_side_encryption {\n\t\t26 |     enabled = \"true\"\n\t\t27 |   }\n\t\t28 | \n\t\t29 |   point_in_time_recovery {\n\t\t30 |     enabled = \"false\"\n\t\t31 |   }\n\t\t32 | \n\t\t33 |   stream_enabled = \"false\"\n\t\t34 |   stream_view_type = \"\"\n\t\t35 | \n\t\t36 |   timeouts {\n\t\t37 |     create = \"10m\"\n\t\t38 |     delete = \"10m\"\n\t\t39 |     update = \"10m\"\n\t\t40 |   }\n\t\t41 | \n\t\t42 |   tags {\n\t\t43 |     Name        = \"${var.application-name}-data-${var.env}\"\n\t\t44 |     Application = \"example\"\n\t\t45 |     Environment = \"${var.env}\"\n\t\t46 |   }\n\t\t47 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.persistence.aws_dynamodb_table.data\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /module-terraform/modules/persistence/main.tf:3-47\n\tCalling File: /module-terraform/awsaccnt1/us-west-2/lookup/main.tf:34-40\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t3  | resource \"aws_dynamodb_table\" \"data\" {\n\t\t4  |   name           = \"${var.application-name}-data\"\n\t\t5  |   read_capacity  = 1\n\t\t6  |   write_capacity = 1\n\t\t7  |   hash_key       = \"customerId\"\n\t\t8  |   range_key      = \"\"\n\t\t9  | \n\t\t10 |   attribute = [{\n\t\t11 |     name = \"customerId\"\n\t\t12 |     type = \"S\"\n\t\t13 |   }]\n\t\t14 | \n\t\t15 |   ttl {\n\t\t16 |     attribute_name = \"TimeToExist\"\n\t\t17 |     enabled = false\n\t\t18 |   }\n\t\t19 | \n\t\t20 |   ## stop redeploying TTL\n\t\t21 |   lifecycle {\n\t\t22 |     ignore_changes = [\"ttl\"]\n\t\t23 |   }\n\t\t24 | \n\t\t25 |   server_side_encryption {\n\t\t26 |     enabled = \"true\"\n\t\t27 |   }\n\t\t28 | \n\t\t29 |   point_in_time_recovery {\n\t\t30 |     enabled = \"false\"\n\t\t31 |   }\n\t\t32 | \n\t\t33 |   stream_enabled = \"false\"\n\t\t34 |   stream_view_type = \"\"\n\t\t35 | \n\t\t36 |   timeouts {\n\t\t37 |     create = \"10m\"\n\t\t38 |     delete = \"10m\"\n\t\t39 |     update = \"10m\"\n\t\t40 |   }\n\t\t41 | \n\t\t42 |   tags {\n\t\t43 |     Name        = \"${var.application-name}\"\n\t\t44 |     Application = \"example\"\n\t\t45 |     Environment = \"${var.env}\"\n\t\t46 |   }\n\t\t47 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.data\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /module-terragrunt/modules/persistence/main.tf:3-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t3  | resource \"aws_dynamodb_table\" \"data\" {\n\t\t4  |   name           = \"${var.application-name}-data\"\n\t\t5  |   read_capacity  = 1\n\t\t6  |   write_capacity = 1\n\t\t7  |   hash_key       = \"customerId\"\n\t\t8  |   range_key      = \"\"\n\t\t9  | \n\t\t10 |   attribute = [{\n\t\t11 |     name = \"customerId\"\n\t\t12 |     type = \"S\"\n\t\t13 |   }]\n\t\t14 | \n\t\t15 |   ttl {\n\t\t16 |     attribute_name = \"TimeToExist\"\n\t\t17 |     enabled = false\n\t\t18 |   }\n\t\t19 | \n\t\t20 |   ## stop redeploying TTL\n\t\t21 |   lifecycle {\n\t\t22 |     ignore_changes = [\"ttl\"]\n\t\t23 |   }\n\t\t24 | \n\t\t25 |   server_side_encryption {\n\t\t26 |     enabled = \"true\"\n\t\t27 |   }\n\t\t28 | \n\t\t29 |   point_in_time_recovery {\n\t\t30 |     enabled = \"false\"\n\t\t31 |   }\n\t\t32 | \n\t\t33 |   stream_enabled = \"false\"\n\t\t34 |   stream_view_type = \"\"\n\t\t35 | \n\t\t36 |   timeouts {\n\t\t37 |     create = \"10m\"\n\t\t38 |     delete = \"10m\"\n\t\t39 |     update = \"10m\"\n\t\t40 |   }\n\t\t41 | \n\t\t42 |   tags {\n\t\t43 |     Name        = \"${var.application-name}\"\n\t\t44 |     Application = \"example\"\n\t\t45 |     Environment = \"${var.env}\"\n\t\t46 |   }\n\t\t47 | }\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/after/basic-terraform/awsaccnt1/us-west-2/lookup/api.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/after/basic-terraform/nonprod/us-west-2/lookup/api.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/after/dry-workspace-terragrunt/modules/api/lookup-method.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/after/dry-workspace-terragrunt/systems/terraform.tfvarsֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/after/envvar-terragrunt/modules/api/lookup-method.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/after/envvar-terragrunt/systems/terraform.tfvarsֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/after/module-terraform/modules/api/lookup-method.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/after/module-terragrunt/modules/api/lookup-method.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/garylb2-terraform-example-patterns-6de6d83d930bd9459e1cf8c311fa7b45c3f90987/after/module-terragrunt/systems/terraform.tfvarsֿ\n\n",
      "stderr": "",
      "duration_seconds": 6.540779286999168
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/Arkoprabho/TerraformTutorial/commit/ba317d7e402f014589e230fad8c7384016211ba2",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.terraform_locks\n\tFile: /tfstate/main.tf:36-44\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.terraform_locks\n\tFile: /tfstate/main.tf:36-44\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.terraform_locks\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /tfstate/main.tf:36-44\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t36 | resource \"aws_dynamodb_table\" \"terraform_locks\" {\n\t\t37 |   name         = \"terraform-state-locks\"\n\t\t38 |   hash_key     = \"LockID\"\n\t\t39 | \n\t\t40 |   attribute {\n\t\t41 |     name = \"LockID\"\n\t\t42 |     type = \"S\"\n\t\t43 |   }\n\t\t44 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 4.336803211001097
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.terraform_locks\n\tFile: /tfstate/main.tf:36-45\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.terraform_locks\n\tFile: /tfstate/main.tf:36-45\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.terraform_locks\n\tFile: /tfstate/main.tf:36-45\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "",
      "duration_seconds": 4.0163209499987715
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/jkstenzel95/jks.gameservers/commit/411ab992ba07e698cb08b56eb4cfc9d6e001d43f",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 11, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.game_servers.module.ark_resources.module.kv_store.aws_dynamodb_table.game_key_value_store\n\tFile: /infra/service/game-servers/modules/game-kv-store/main.tf:1-17\n\tCalling File: /infra/service/game-servers/modules/Ark/ark-resources/main.tf:34-41\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.game_servers.module.ark_resources.module.kv_store.aws_dynamodb_table.game_key_value_store\n\tFile: /infra/service/game-servers/modules/game-kv-store/main.tf:1-17\n\tCalling File: /infra/service/game-servers/modules/Ark/ark-resources/main.tf:34-41\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.dev_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:6-9\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.dev_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:6-9\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.dev_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:6-9\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.prod_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:11-14\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.prod_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:11-14\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.prod_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:11-14\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.shared_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:16-19\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.shared_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:16-19\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.shared_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:16-19\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.game_servers.module.ark_resources.module.kv_store.aws_dynamodb_table.game_key_value_store\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /infra/service/game-servers/modules/game-kv-store/main.tf:1-17\n\tCalling File: /infra/service/game-servers/modules/Ark/ark-resources/main.tf:34-41\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"game_key_value_store\" {\n\t\t2  |   name             = \"jks-gs-${var.env}-${var.region_shortname}-${var.game_name}-${var.map_name}-kv_table\"\n\t\t3  |   hash_key         = \"Key\"\n\t\t4  | \n\t\t5  |   attribute {\n\t\t6  |     name = \"Key\"\n\t\t7  |     type = \"S\"\n\t\t8  |   }\n\t\t9  | \n\t\t10 |   replica {\n\t\t11 |     region_name = \"us-east-2\"\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   replica {\n\t\t15 |     region_name = \"us-west-2\"\n\t\t16 |   }\n\t\t17 | }\n\n",
        "stderr": "2024-06-20 20:05:03,780 [MainThread  ] [WARNI]  Failed processing helm chart game-server at dir: snapshots/jkstenzel95-jks.gameservers-411ab992ba07e698cb08b56eb4cfc9d6e001d43f/before-79323c3894373739c61477b17736bc260834fa6f/game-server/helm/game-server. Working dir: /tmp/tmp85dtadi6. Failure details: Error: template: game-server/templates/deployment.yaml:55:21: executing \"game-server/templates/deployment.yaml\" at <.Values.environmentVariableFile>: wrong type for value; expected string; got interface {}\n\nUse --debug flag to render out invalid YAML\n\n",
        "duration_seconds": 9.211282559999745
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 12, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.game_servers.module.ark_resources.module.kv_store.aws_dynamodb_table.game_key_value_store\n\tFile: /infra/service/game-servers/modules/game-kv-store/main.tf:1-18\n\tCalling File: /infra/service/game-servers/modules/Ark/ark-resources/main.tf:34-41\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.game_servers.module.ark_resources.module.kv_store.aws_dynamodb_table.game_key_value_store\n\tFile: /infra/service/game-servers/modules/game-kv-store/main.tf:1-18\n\tCalling File: /infra/service/game-servers/modules/Ark/ark-resources/main.tf:34-41\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.game_servers.module.ark_resources.module.kv_store.aws_dynamodb_table.game_key_value_store\n\tFile: /infra/service/game-servers/modules/game-kv-store/main.tf:1-18\n\tCalling File: /infra/service/game-servers/modules/Ark/ark-resources/main.tf:34-41\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.dev_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:6-9\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.dev_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:6-9\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.dev_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:6-9\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.prod_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:11-14\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.prod_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:11-14\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.prod_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:11-14\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.shared_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:16-19\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.shared_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:16-19\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.shared_state_store.aws_dynamodb_table.terraform_locks\n\tFile: /infra/terraform-backend/env/main.tf:18-26\n\tCalling File: /infra/terraform-backend/main.tf:16-19\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "2024-06-20 20:04:55,679 [MainThread  ] [WARNI]  Failed processing helm chart game-server at dir: snapshots/jkstenzel95-jks.gameservers-411ab992ba07e698cb08b56eb4cfc9d6e001d43f/after/game-server/helm/game-server. Working dir: /tmp/tmpwdx71l9s. Failure details: Error: template: game-server/templates/deployment.yaml:55:21: executing \"game-server/templates/deployment.yaml\" at <.Values.environmentVariableFile>: wrong type for value; expected string; got interface {}\n\nUse --debug flag to render out invalid YAML\n\n",
      "duration_seconds": 8.223799589000919
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/techservicesillinois/aws-enterprise-vpc/commit/0d21bea79e1936e2bdaee58bd6e328dd08e59b30",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.lock_table\n\tFile: /modules/bootstrap/main.tf:89-108\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.lock_table\n\tFile: /modules/bootstrap/main.tf:89-108\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.lock_table\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /modules/bootstrap/main.tf:89-108\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t89  | resource \"aws_dynamodb_table\" \"lock_table\" {\n\t\t90  |   name = var.dynamodb_table\n\t\t91  |   tags = var.tags\n\t\t92  | \n\t\t93  |   billing_mode   = \"PROVISIONED\"\n\t\t94  |   read_capacity  = 1\n\t\t95  |   write_capacity = 1\n\t\t96  | \n\t\t97  |   hash_key = \"LockID\"\n\t\t98  | \n\t\t99  |   attribute {\n\t\t100 |     name = \"LockID\"\n\t\t101 |     type = \"S\"\n\t\t102 |   }\n\t\t103 | \n\t\t104 |   # Terraform should never destroy this resource\n\t\t105 |   lifecycle {\n\t\t106 |     prevent_destroy = true\n\t\t107 |   }\n\t\t108 | }\n\nterraform_plan scan results:\n\nPassed checks: 0, Failed checks: 0, Skipped checks: 0, Parsing errors: 1\n\nError parsing file snapshots/techservicesillinois-aws-enterprise-vpc-0d21bea79e1936e2bdaee58bd6e328dd08e59b30/before-11ad9a5261fb1c5d15e8f8be9ba3a59b8fc78fb2/modules/rdns-forwarder/roles/rdns-forwarder/templates/opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.jsonֿ\n\n",
        "stderr": "2024-06-20 20:05:24,515 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/customer-gateways?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:05:24,516 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/subnet-common?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:05:24,517 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/nat-gateway?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:05:24,517 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/vpn-connection?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:05:24,518 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/public-facing-subnet?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:05:24,518 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/campus-facing-subnet?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:05:24,519 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/private-facing-subnet?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:05:24,519 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/rdns-forwarder?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 10.003702940999574
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.lock_table\n\tFile: /modules/bootstrap/main.tf:89-106\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.lock_table\n\tFile: /modules/bootstrap/main.tf:89-106\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.lock_table\n\tFile: /modules/bootstrap/main.tf:89-106\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nterraform_plan scan results:\n\nPassed checks: 0, Failed checks: 0, Skipped checks: 0, Parsing errors: 1\n\nError parsing file snapshots/techservicesillinois-aws-enterprise-vpc-0d21bea79e1936e2bdaee58bd6e328dd08e59b30/after/modules/rdns-forwarder/roles/rdns-forwarder/templates/opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.jsonֿ\n\n",
      "stderr": "2024-06-20 20:05:14,251 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/customer-gateways?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:05:14,252 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/subnet-common?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:05:14,252 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/nat-gateway?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:05:14,252 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/vpn-connection?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:05:14,253 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/public-facing-subnet?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:05:14,253 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/campus-facing-subnet?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:05:14,253 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/private-facing-subnet?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:05:14,253 [MainThread  ] [WARNI]  Failed to download module git::https://github.com/techservicesillinois/aws-enterprise-vpc.git//modules/rdns-forwarder?ref=v0.10:None (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 8.843459547000748
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/austin1237/gifbot/commit/c11dabf1ea02c0e044c62448986bb3f9abdf3967",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 4, Skipped checks: 0\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.terraform_state_lock\n\tFile: /terraform/dev/remote-state/main.tf:17-27\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.terraform_state_lock\n\tFile: /terraform/prod/remote-state/main.tf:17-27\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.terraform_state_lock\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/dev/remote-state/main.tf:17-27\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t17 | resource \"aws_dynamodb_table\" \"terraform_state_lock\" {\n\t\t18 |   name           = \"gifbot-state-lock-${var.ENVIRONMENT}\"\n\t\t19 |   read_capacity  = 20\n\t\t20 |   write_capacity = 20\n\t\t21 |   hash_key       = \"LockID\"\n\t\t22 | \n\t\t23 |   attribute {\n\t\t24 |     name = \"LockID\"\n\t\t25 |     type = \"S\"\n\t\t26 |   }\n\t\t27 | }\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.terraform_state_lock\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/dev/remote-state/main.tf:17-27\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t17 | resource \"aws_dynamodb_table\" \"terraform_state_lock\" {\n\t\t18 |   name           = \"gifbot-state-lock-${var.ENVIRONMENT}\"\n\t\t19 |   read_capacity  = 20\n\t\t20 |   write_capacity = 20\n\t\t21 |   hash_key       = \"LockID\"\n\t\t22 | \n\t\t23 |   attribute {\n\t\t24 |     name = \"LockID\"\n\t\t25 |     type = \"S\"\n\t\t26 |   }\n\t\t27 | }\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.terraform_state_lock\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/prod/remote-state/main.tf:17-27\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t17 | resource \"aws_dynamodb_table\" \"terraform_state_lock\" {\n\t\t18 |   name           = \"gifbot-state-lock-${var.ENVIRONMENT}\"\n\t\t19 |   read_capacity  = 20\n\t\t20 |   write_capacity = 20\n\t\t21 |   hash_key       = \"LockID\"\n\t\t22 | \n\t\t23 |   attribute {\n\t\t24 |     name = \"LockID\"\n\t\t25 |     type = \"S\"\n\t\t26 |   }\n\t\t27 | }\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.terraform_state_lock\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/prod/remote-state/main.tf:17-27\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t17 | resource \"aws_dynamodb_table\" \"terraform_state_lock\" {\n\t\t18 |   name           = \"gifbot-state-lock-${var.ENVIRONMENT}\"\n\t\t19 |   read_capacity  = 20\n\t\t20 |   write_capacity = 20\n\t\t21 |   hash_key       = \"LockID\"\n\t\t22 | \n\t\t23 |   attribute {\n\t\t24 |     name = \"LockID\"\n\t\t25 |     type = \"S\"\n\t\t26 |   }\n\t\t27 | }\n\n",
        "stderr": "",
        "duration_seconds": 5.1924480620000395
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 4, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.terraform_state_lock\n\tFile: /terraform/dev/remote-state/main.tf:17-27\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.terraform_state_lock\n\tFile: /terraform/dev/remote-state/main.tf:17-27\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.terraform_state_lock\n\tFile: /terraform/prod/remote-state/main.tf:17-27\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.terraform_state_lock\n\tFile: /terraform/prod/remote-state/main.tf:17-27\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.terraform_state_lock\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/dev/remote-state/main.tf:17-27\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t17 | resource \"aws_dynamodb_table\" \"terraform_state_lock\" {\n\t\t18 |   name           = \"gifbot-state-lock-${var.ENVIRONMENT}\"\n\t\t19 |   read_capacity  = 1\n\t\t20 |   write_capacity = 1\n\t\t21 |   hash_key       = \"LockID\"\n\t\t22 | \n\t\t23 |   attribute {\n\t\t24 |     name = \"LockID\"\n\t\t25 |     type = \"S\"\n\t\t26 |   }\n\t\t27 | }\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.terraform_state_lock\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/prod/remote-state/main.tf:17-27\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t17 | resource \"aws_dynamodb_table\" \"terraform_state_lock\" {\n\t\t18 |   name           = \"gifbot-state-lock-${var.ENVIRONMENT}\"\n\t\t19 |   read_capacity  = 1\n\t\t20 |   write_capacity = 1\n\t\t21 |   hash_key       = \"LockID\"\n\t\t22 | \n\t\t23 |   attribute {\n\t\t24 |     name = \"LockID\"\n\t\t25 |     type = \"S\"\n\t\t26 |   }\n\t\t27 | }\n\n",
      "stderr": "",
      "duration_seconds": 5.634574663001331
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/servers-tf/infrastructure/commit/cc9e50a3864511f9fb9f871293e6a6e7e2719d2c",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.tf2_competitive_auth\n\tFile: /main.tf:29-39\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.tf2_competitive_auth\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /main.tf:29-39\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t29 | resource \"aws_dynamodb_table\" \"tf2_competitive_auth\" {\n\t\t30 |     name = \"tf2_competitive_auth\"\n\t\t31 |     hash_key = \"steam_id\"\n\t\t32 |     read_capacity  = 5\n\t\t33 |     write_capacity = 5\n\t\t34 | \n\t\t35 |     attribute {\n\t\t36 |         name = \"steam_id\"\n\t\t37 |         type = \"S\"\n\t\t38 |     }\n\t\t39 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.tf2_competitive_auth\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /main.tf:29-39\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t29 | resource \"aws_dynamodb_table\" \"tf2_competitive_auth\" {\n\t\t30 |     name = \"tf2_competitive_auth\"\n\t\t31 |     hash_key = \"steam_id\"\n\t\t32 |     read_capacity  = 5\n\t\t33 |     write_capacity = 5\n\t\t34 | \n\t\t35 |     attribute {\n\t\t36 |         name = \"steam_id\"\n\t\t37 |         type = \"S\"\n\t\t38 |     }\n\t\t39 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 5.566783152000426
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.tf2_competitive_auth\n\tFile: /main.tf:29-39\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.tf2_competitive_auth\n\tFile: /main.tf:29-39\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.tf2_competitive_auth\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /main.tf:29-39\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t29 | resource \"aws_dynamodb_table\" \"tf2_competitive_auth\" {\n\t\t30 |     name = \"tf2_competitive_auth\"\n\t\t31 |     hash_key = \"steam_id\"\n\t\t32 |     read_capacity  = 1\n\t\t33 |     write_capacity = 1\n\t\t34 | \n\t\t35 |     attribute {\n\t\t36 |         name = \"steam_id\"\n\t\t37 |         type = \"S\"\n\t\t38 |     }\n\t\t39 | }\n\n\n",
      "stderr": "",
      "duration_seconds": 5.792084063999937
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/jsoconno/aws-terraform-remote-state-infrastructure/commit/fed8be2748bc2286a6f9888d282d66763ba612ed",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.dynamodb.aws_dynamodb_table.standard[0]\n\tFile: /modules/dynamodb/main.tf:16-91\n\tCalling File: /terraform/main.tf:9-28\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.dynamodb.aws_dynamodb_table.standard[0]\n\tFile: /modules/dynamodb/main.tf:16-91\n\tCalling File: /terraform/main.tf:9-28\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: module.dynamodb.aws_dynamodb_table.standard[0]\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /modules/dynamodb/main.tf:16-91\n\tCalling File: /terraform/main.tf:9-28\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\n\n",
        "stderr": "",
        "duration_seconds": 4.882528058000389
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.dynamodb.aws_dynamodb_table.standard\n\tFile: /modules/dynamodb/main.tf:16-87\n\tCalling File: /terraform/main.tf:9-28\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.dynamodb.aws_dynamodb_table.standard\n\tFile: /modules/dynamodb/main.tf:16-87\n\tCalling File: /terraform/main.tf:9-28\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: module.dynamodb.aws_dynamodb_table.standard\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /modules/dynamodb/main.tf:16-87\n\tCalling File: /terraform/main.tf:9-28\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\n\n",
      "stderr": "",
      "duration_seconds": 4.597440550000101
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/ONSdigital/eq-terraform/commit/6eaf697bf9f111214a6d74ee3094e5784a57d1bb",
    "before": [
      {
        "return_code": 0,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 0, Skipped checks: 0, Parsing errors: 4\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/ONSdigital-eq-terraform-6eaf697bf9f111214a6d74ee3094e5784a57d1bb/before-e2d4cd25e676ffbfdd7d578795b76ed2866a17f4/survey-runner-alerting/iam.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/ONSdigital-eq-terraform-6eaf697bf9f111214a6d74ee3094e5784a57d1bb/before-e2d4cd25e676ffbfdd7d578795b76ed2866a17f4/survey-runner-application/iam.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/ONSdigital-eq-terraform-6eaf697bf9f111214a6d74ee3094e5784a57d1bb/before-e2d4cd25e676ffbfdd7d578795b76ed2866a17f4/survey-runner-database/cloudwatch.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/ONSdigital-eq-terraform-6eaf697bf9f111214a6d74ee3094e5784a57d1bb/before-e2d4cd25e676ffbfdd7d578795b76ed2866a17f4/survey-runner-queue/cloudwatch.tfֿ\n\n",
        "stderr": "2024-06-20 20:06:08,264 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/eq-terraform-ecs?ref=v7.0:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:06:08,264 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/eq-ecs-deploy?ref=v2.0:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:06:08,264 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/eq-terraform-elasticsearch:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:06:08,264 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/eq-terraform-dynamodb?ref=v2.0:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:06:08,264 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/ebs_bckup:None (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 5.571221976999368
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 0, Skipped checks: 0, Parsing errors: 4\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/ONSdigital-eq-terraform-6eaf697bf9f111214a6d74ee3094e5784a57d1bb/after/survey-runner-alerting/iam.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/ONSdigital-eq-terraform-6eaf697bf9f111214a6d74ee3094e5784a57d1bb/after/survey-runner-application/iam.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/ONSdigital-eq-terraform-6eaf697bf9f111214a6d74ee3094e5784a57d1bb/after/survey-runner-database/cloudwatch.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/ONSdigital-eq-terraform-6eaf697bf9f111214a6d74ee3094e5784a57d1bb/after/survey-runner-queue/cloudwatch.tfֿ\n\n",
      "stderr": "2024-06-20 20:06:02,719 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/eq-terraform-ecs?ref=v7.0:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:06:02,719 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/eq-ecs-deploy?ref=v2.0:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:06:02,719 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/eq-terraform-elasticsearch:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:06:02,719 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/eq-terraform-dynamodb?ref=v2.2:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:06:02,720 [MainThread  ] [WARNI]  Failed to download module github.com/ONSdigital/ebs_bckup:None (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 5.530199394001102
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/nikkiwritescode/flask-app-terraform-deployment/commit/af47bb6201f1dcc8264e60da429e4ff8d126e56c",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.db.aws_dynamodb_table.flask-db-table-1\n\tFile: /modules/db/main.tf:1-28\n\tCalling File: /main.tf:49-53\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.db.aws_dynamodb_table.flask-db-table-1\n\tFile: /modules/db/main.tf:1-28\n\tCalling File: /main.tf:49-53\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.db.aws_dynamodb_table.flask-db-table-1\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /modules/db/main.tf:1-28\n\tCalling File: /main.tf:49-53\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"flask-db-table-1\" {\n\t\t2  |   name           = \"${var.app_name}-${var.env_prefix}-FlaskDB\"\n\t\t3  |   billing_mode   = \"PROVISIONED\"\n\t\t4  |   read_capacity  = 1\n\t\t5  |   write_capacity = 1\n\t\t6  |   hash_key       = \"Name\"\n\t\t7  |   range_key      = \"Party\"\n\t\t8  | \n\t\t9  |   attribute {\n\t\t10 |     name = \"Name\"\n\t\t11 |     type = \"S\"\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   attribute {\n\t\t15 |     name = \"Party\"\n\t\t16 |     type = \"S\"\n\t\t17 |   }\n\t\t18 | \n\t\t19 |   ttl {\n\t\t20 |     attribute_name = \"TimeToExist\"\n\t\t21 |     enabled        = false\n\t\t22 |   }\n\t\t23 | \n\t\t24 |   tags = {\n\t\t25 |     Name        = \"${var.app_name}-${var.env_prefix}-flask-db-table-1\"\n\t\t26 |     Environment = \"${var.env_prefix}\"\n\t\t27 |   }\n\t\t28 | }\n\n",
        "stderr": "",
        "duration_seconds": 4.384310521998486
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.db.aws_dynamodb_table.candidate-table\n\tFile: /modules/db/main.tf:1-20\n\tCalling File: /main.tf:50-54\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.db.aws_dynamodb_table.candidate-table\n\tFile: /modules/db/main.tf:1-20\n\tCalling File: /main.tf:50-54\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.db.aws_dynamodb_table.candidate-table\n\tFile: /modules/db/main.tf:1-20\n\tCalling File: /main.tf:50-54\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "",
      "duration_seconds": 4.502025563000643
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/kperson/terraform-modules/commit/53bd2d84776f9ed7ae287fc59ed42f87bd7bbc4b",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.table\n\tFile: /auto-scaled-dynamo/main.tf:46-102\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: aws_dynamodb_table.table\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /auto-scaled-dynamo/main.tf:46-102\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.table\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /auto-scaled-dynamo/main.tf:46-102\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\n\n",
        "stderr": "",
        "duration_seconds": 4.274693179000678
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.table\n\tFile: /auto-scaled-dynamo/main.tf:50-107\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: aws_dynamodb_table.table\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /auto-scaled-dynamo/main.tf:50-107\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.table\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /auto-scaled-dynamo/main.tf:50-107\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\n\n",
      "stderr": "",
      "duration_seconds": 4.278299854999204
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/kody-abe/terraform/commit/169c7768b0b1584945362c035a2b227d2f579466",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 5, Failed checks: 4, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.geopoiesis-scopes\n\tFile: /aws/dynamodb.tf:1-20\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.geopoiesis-scopes\n\tFile: /aws/dynamodb.tf:1-20\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.geopoiesis-runs\n\tFile: /aws/dynamodb.tf:29-114\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.geopoiesis-workers\n\tFile: /aws/dynamodb.tf:155-174\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.geopoiesis-workers\n\tFile: /aws/dynamodb.tf:155-174\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.geopoiesis-scopes\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /aws/dynamodb.tf:1-20\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"geopoiesis-scopes\" {\n\t\t2  |   name           = \"${var.scopes_table_name}\"\n\t\t3  |   read_capacity  = \"${var.min_capacity}\"\n\t\t4  |   write_capacity = \"${var.min_capacity}\"\n\t\t5  |   hash_key       = \"scope\"\n\t\t6  | \n\t\t7  |   attribute {\n\t\t8  |     name = \"scope\"\n\t\t9  |     type = \"S\"\n\t\t10 |   }\n\t\t11 | \n\t\t12 |   lifecycle {\n\t\t13 |     ignore_changes = [\"read_capacity\", \"write_capacity\"]\n\t\t14 |   }\n\t\t15 | \n\t\t16 |   tags {\n\t\t17 |     Name        = \"Owner\"\n\t\t18 |     Description = \"Geopoiesis\"\n\t\t19 |   }\n\t\t20 | }\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: aws_dynamodb_table.geopoiesis-runs\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /aws/dynamodb.tf:29-114\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.geopoiesis-runs\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /aws/dynamodb.tf:29-114\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.geopoiesis-workers\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /aws/dynamodb.tf:155-174\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t155 | resource \"aws_dynamodb_table\" \"geopoiesis-workers\" {\n\t\t156 |   name           = \"${var.workers_table_name}\"\n\t\t157 |   read_capacity  = \"${var.min_capacity}\"\n\t\t158 |   write_capacity = \"${var.min_capacity}\"\n\t\t159 |   hash_key       = \"worker_id\"\n\t\t160 | \n\t\t161 |   attribute {\n\t\t162 |     name = \"worker_id\"\n\t\t163 |     type = \"S\"\n\t\t164 |   }\n\t\t165 | \n\t\t166 |   lifecycle {\n\t\t167 |     ignore_changes = [\"read_capacity\", \"write_capacity\"]\n\t\t168 |   }\n\t\t169 | \n\t\t170 |   tags {\n\t\t171 |     Name        = \"Owner\"\n\t\t172 |     Description = \"Geopoiesis\"\n\t\t173 |   }\n\t\t174 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 4.492604187000325
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 7, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.geopoiesis-scopes\n\tFile: /aws/dynamodb.tf:1-14\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.geopoiesis-scopes\n\tFile: /aws/dynamodb.tf:1-14\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.geopoiesis-runs\n\tFile: /aws/dynamodb.tf:16-84\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.geopoiesis-runs\n\tFile: /aws/dynamodb.tf:16-84\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.geopoiesis-workers\n\tFile: /aws/dynamodb.tf:86-100\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.geopoiesis-workers\n\tFile: /aws/dynamodb.tf:86-100\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.geopoiesis-workers\n\tFile: /aws/dynamodb.tf:86-100\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.geopoiesis-scopes\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /aws/dynamodb.tf:1-14\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"geopoiesis-scopes\" {\n\t\t2  |   name     = \"${var.scopes_table_name}\"\n\t\t3  |   hash_key = \"scope\"\n\t\t4  | \n\t\t5  |   attribute {\n\t\t6  |     name = \"scope\"\n\t\t7  |     type = \"S\"\n\t\t8  |   }\n\t\t9  | \n\t\t10 |   tags {\n\t\t11 |     Name        = \"Owner\"\n\t\t12 |     Description = \"Geopoiesis\"\n\t\t13 |   }\n\t\t14 | }\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: aws_dynamodb_table.geopoiesis-runs\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /aws/dynamodb.tf:16-84\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\tCode lines for this resource are too many. Please use IDE of your choice to review the file.\n\n",
      "stderr": "",
      "duration_seconds": 4.316608002000066
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/jenkins-x/terraform-aws-eks-jx/commit/cce6b14692fccd30c027851607a9526151d4c3d2",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.vault.aws_dynamodb_table.vault-dynamodb-table[0]\n\tFile: /modules/vault/main.tf:48-71\n\tCalling File: /main.tf:56-62\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: module.vault.aws_dynamodb_table.vault-dynamodb-table[0]\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /modules/vault/main.tf:48-71\n\tCalling File: /main.tf:56-62\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t48 | resource \"aws_dynamodb_table\" \"vault-dynamodb-table\" {\n\t\t49 |   count = var.external_vault ? 0 : 1 \n\t\t50 | \n\t\t51 |   name           = \"vault-unseal-${var.cluster_name}-${local.vault_seed}\"\n\t\t52 |   billing_mode   = \"PROVISIONED\"\n\t\t53 |   read_capacity  = 2\n\t\t54 |   write_capacity = 2\n\t\t55 |   hash_key       = \"Path\"\n\t\t56 |   range_key      = \"Key\"\n\t\t57 | \n\t\t58 |   attribute {\n\t\t59 |     name = \"Path\"\n\t\t60 |     type = \"S\"\n\t\t61 |   }\n\t\t62 | \n\t\t63 |   attribute {\n\t\t64 |     name = \"Key\"\n\t\t65 |     type = \"S\"\n\t\t66 |   }\n\t\t67 | \n\t\t68 |   tags = {\n\t\t69 |     Name = \"vault-dynamo-db-table\"\n\t\t70 |   }\n\t\t71 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.vault.aws_dynamodb_table.vault-dynamodb-table[0]\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /modules/vault/main.tf:48-71\n\tCalling File: /main.tf:56-62\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t48 | resource \"aws_dynamodb_table\" \"vault-dynamodb-table\" {\n\t\t49 |   count = var.external_vault ? 0 : 1 \n\t\t50 | \n\t\t51 |   name           = \"vault-unseal-${var.cluster_name}-${local.vault_seed}\"\n\t\t52 |   billing_mode   = \"PROVISIONED\"\n\t\t53 |   read_capacity  = 2\n\t\t54 |   write_capacity = 2\n\t\t55 |   hash_key       = \"Path\"\n\t\t56 |   range_key      = \"Key\"\n\t\t57 | \n\t\t58 |   attribute {\n\t\t59 |     name = \"Path\"\n\t\t60 |     type = \"S\"\n\t\t61 |   }\n\t\t62 | \n\t\t63 |   attribute {\n\t\t64 |     name = \"Key\"\n\t\t65 |     type = \"S\"\n\t\t66 |   }\n\t\t67 | \n\t\t68 |   tags = {\n\t\t69 |     Name = \"vault-dynamo-db-table\"\n\t\t70 |   }\n\t\t71 | }\n\n\n",
        "stderr": "2024-06-20 20:06:45,716 [MainThread  ] [WARNI]  Failed to download module jenkins-x/eks-jx/aws:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:06:45,717 [MainThread  ] [WARNI]  Failed to download module terraform-aws-modules/iam/aws//modules/iam-assumable-role-with-oidc:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:06:45,717 [MainThread  ] [WARNI]  Failed to download module terraform-aws-modules/vpc/aws:2.39.0 (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:06:45,717 [MainThread  ] [WARNI]  Failed to download module terraform-aws-modules/eks/aws:12.1.0 (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 5.402616659999694
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.vault.aws_dynamodb_table.vault-dynamodb-table[0]\n\tFile: /modules/vault/main.tf:48-71\n\tCalling File: /main.tf:56-62\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.vault.aws_dynamodb_table.vault-dynamodb-table[0]\n\tFile: /modules/vault/main.tf:48-71\n\tCalling File: /main.tf:56-62\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.vault.aws_dynamodb_table.vault-dynamodb-table[0]\n\tFile: /modules/vault/main.tf:48-71\n\tCalling File: /main.tf:56-62\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "2024-06-20 20:06:40,177 [MainThread  ] [WARNI]  Failed to download module jenkins-x/eks-jx/aws:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:06:40,177 [MainThread  ] [WARNI]  Failed to download module terraform-aws-modules/iam/aws//modules/iam-assumable-role-with-oidc:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:06:40,178 [MainThread  ] [WARNI]  Failed to download module terraform-aws-modules/vpc/aws:2.39.0 (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:06:40,178 [MainThread  ] [WARNI]  Failed to download module terraform-aws-modules/eks/aws:12.1.0 (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 5.264520536000418
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/telia-oss/terraform-aws-terraform-init/commit/e8c7b2eb22d08ddd1a1bb375cb6efa4165c9098f",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.terraform_init.aws_dynamodb_table.lock\n\tFile: /main.tf:20-37\n\tCalling File: /examples/basic/main.tf:12-20\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: module.terraform_init.aws_dynamodb_table.lock\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /main.tf:20-37\n\tCalling File: /examples/basic/main.tf:12-20\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t20 | resource \"aws_dynamodb_table\" \"lock\" {\n\t\t21 |   name           = \"${var.name_prefix}-terraform-state\"\n\t\t22 |   read_capacity  = 20\n\t\t23 |   write_capacity = 20\n\t\t24 |   hash_key       = \"LockID\"\n\t\t25 | \n\t\t26 |   attribute {\n\t\t27 |     name = \"LockID\"\n\t\t28 |     type = \"S\"\n\t\t29 |   }\n\t\t30 | \n\t\t31 |   tags = merge(\n\t\t32 |     var.tags,\n\t\t33 |     {\n\t\t34 |       \"Name\" = \"${var.name_prefix}-terraform-state\"\n\t\t35 |     },\n\t\t36 |   )\n\t\t37 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.terraform_init.aws_dynamodb_table.lock\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /main.tf:20-37\n\tCalling File: /examples/basic/main.tf:12-20\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t20 | resource \"aws_dynamodb_table\" \"lock\" {\n\t\t21 |   name           = \"${var.name_prefix}-terraform-state\"\n\t\t22 |   read_capacity  = 20\n\t\t23 |   write_capacity = 20\n\t\t24 |   hash_key       = \"LockID\"\n\t\t25 | \n\t\t26 |   attribute {\n\t\t27 |     name = \"LockID\"\n\t\t28 |     type = \"S\"\n\t\t29 |   }\n\t\t30 | \n\t\t31 |   tags = merge(\n\t\t32 |     var.tags,\n\t\t33 |     {\n\t\t34 |       \"Name\" = \"${var.name_prefix}-terraform-state\"\n\t\t35 |     },\n\t\t36 |   )\n\t\t37 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 4.510047088000647
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.terraform_init.aws_dynamodb_table.lock\n\tFile: /main.tf:20-38\n\tCalling File: /examples/basic/main.tf:12-20\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.terraform_init.aws_dynamodb_table.lock\n\tFile: /main.tf:20-38\n\tCalling File: /examples/basic/main.tf:12-20\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.terraform_init.aws_dynamodb_table.lock\n\tFile: /main.tf:20-38\n\tCalling File: /examples/basic/main.tf:12-20\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "",
      "duration_seconds": 4.485110292998797
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/trajano/terraform-s3-backend/commit/f4b61c7bedae856439f01499de1ec9050b4c40fc",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.terraform-s3-backend.aws_dynamodb_table.terraform\n\tFile: /main.tf:68-83\n\tCalling File: /examples/sample/terraform-s3-backend.tf:1-5\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: module.terraform-s3-backend.aws_dynamodb_table.terraform\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /main.tf:68-83\n\tCalling File: /examples/sample/terraform-s3-backend.tf:1-5\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t68 | resource \"aws_dynamodb_table\" \"terraform\" {\n\t\t69 |   name      = \"${var.bucket}-locks\"\n\t\t70 |   hash_key  = \"LockID\"\n\t\t71 | \n\t\t72 |   # Not sure if this is okay or not, it may be better to use PAY_PER_REQUEST since Terraforms do not happen often.\n\t\t73 |   read_capacity  = 20\n\t\t74 |   write_capacity = 20\n\t\t75 |   attribute {\n\t\t76 |     name = \"LockID\"\n\t\t77 |     type = \"S\"\n\t\t78 |   }\n\t\t79 | \n\t\t80 |   tags = {\n\t\t81 |     Name = \"${var.bucket} Terraform S3 Backend Locks\"\n\t\t82 |   }\n\t\t83 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.terraform-s3-backend.aws_dynamodb_table.terraform\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /main.tf:68-83\n\tCalling File: /examples/sample/terraform-s3-backend.tf:1-5\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t68 | resource \"aws_dynamodb_table\" \"terraform\" {\n\t\t69 |   name      = \"${var.bucket}-locks\"\n\t\t70 |   hash_key  = \"LockID\"\n\t\t71 | \n\t\t72 |   # Not sure if this is okay or not, it may be better to use PAY_PER_REQUEST since Terraforms do not happen often.\n\t\t73 |   read_capacity  = 20\n\t\t74 |   write_capacity = 20\n\t\t75 |   attribute {\n\t\t76 |     name = \"LockID\"\n\t\t77 |     type = \"S\"\n\t\t78 |   }\n\t\t79 | \n\t\t80 |   tags = {\n\t\t81 |     Name = \"${var.bucket} Terraform S3 Backend Locks\"\n\t\t82 |   }\n\t\t83 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 4.095710822999536
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.terraform-s3-backend.aws_dynamodb_table.terraform\n\tFile: /main.tf:68-81\n\tCalling File: /examples/sample/terraform-s3-backend.tf:1-5\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.terraform-s3-backend.aws_dynamodb_table.terraform\n\tFile: /main.tf:68-81\n\tCalling File: /examples/sample/terraform-s3-backend.tf:1-5\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: module.terraform-s3-backend.aws_dynamodb_table.terraform\n\tFile: /main.tf:68-81\n\tCalling File: /examples/sample/terraform-s3-backend.tf:1-5\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "",
      "duration_seconds": 4.137962212000275
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/poldi2015/chat-app/commit/cb45bf17da799afaa789206e3fcd39d9403e0567",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.chat-app-messages\n\tFile: /chat-app/terraform/dynamodb.tf:1-12\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.chat-app-messages\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /chat-app/terraform/dynamodb.tf:1-12\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"chat-app-messages\" {\n\t\t2  |   name           = \"ChatAppMessages\"\n\t\t3  |   read_capacity  = 5\n\t\t4  |   write_capacity = 5\n\t\t5  | \n\t\t6  |   hash_key       = \"connectionId\"\n\t\t7  | \n\t\t8  |   attribute {\n\t\t9  |     name = \"connectionId\"\n\t\t10 |     type = \"S\"\n\t\t11 |   }\n\t\t12 | }\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.chat-app-messages\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /chat-app/terraform/dynamodb.tf:1-12\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"chat-app-messages\" {\n\t\t2  |   name           = \"ChatAppMessages\"\n\t\t3  |   read_capacity  = 5\n\t\t4  |   write_capacity = 5\n\t\t5  | \n\t\t6  |   hash_key       = \"connectionId\"\n\t\t7  | \n\t\t8  |   attribute {\n\t\t9  |     name = \"connectionId\"\n\t\t10 |     type = \"S\"\n\t\t11 |   }\n\t\t12 | }\n\n",
        "stderr": "",
        "duration_seconds": 4.684172451001359
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.chat-app-messages\n\tFile: /chat-app/terraform/dynamodb.tf:1-13\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.chat-app-messages\n\tFile: /chat-app/terraform/dynamodb.tf:1-13\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.chat-app-messages\n\tFile: /chat-app/terraform/dynamodb.tf:1-13\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "",
      "duration_seconds": 4.246685586998865
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/tesera/terraform-modules/commit/3cd4d7b55ac2003153fd0670151ab395ae182431",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 4, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.main\n\tFile: /dynamodb/main.tf:1-32\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.main\n\tFile: /dynamodb/main.tf:1-32\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.main\n\tFile: /state/dynamodb.tf:1-21\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.main\n\tFile: /state/dynamodb.tf:1-21\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.main\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /dynamodb/main.tf:1-32\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"main\" {\n\t\t2  |   name           = local.name\n\t\t3  |   read_capacity  = var.min_read_capacity\n\t\t4  |   write_capacity = var.min_write_capacity\n\t\t5  |   hash_key       = var.hash_key\n\t\t6  | \n\t\t7  |   #range_key      = \"${var.range_key}\"\n\t\t8  | \n\t\t9  |   attribute {\n\t\t10 |     name = var.hash_key\n\t\t11 |     type = \"S\"\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   #attribute {\n\t\t15 |   #  name = \"${var.range_key}\"\n\t\t16 |   #  type = \"S\"\n\t\t17 |   #}\n\t\t18 | \n\t\t19 |   ttl {\n\t\t20 |     enabled        = var.ttl_enabled\n\t\t21 |     attribute_name = \"timeToLive\"\n\t\t22 |   }\n\t\t23 |   server_side_encryption {\n\t\t24 |     enabled = var.encryption_enabled\n\t\t25 |   }\n\t\t26 |   tags = merge(\n\t\t27 |     local.tags,\n\t\t28 |     {\n\t\t29 |       \"Name\" = local.name\n\t\t30 |     },\n\t\t31 |   )\n\t\t32 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.main\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /state/dynamodb.tf:1-21\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"main\" {\n\t\t2  |   name           = \"terraform-state${local.name}\"\n\t\t3  |   read_capacity  = 1\n\t\t4  |   write_capacity = 1\n\t\t5  |   hash_key       = \"LockID\"\n\t\t6  | \n\t\t7  |   attribute {\n\t\t8  |     name = \"LockID\"\n\t\t9  |     type = \"S\"\n\t\t10 |   }\n\t\t11 | \n\t\t12 |   server_side_encryption {\n\t\t13 |     enabled = true\n\t\t14 |   }\n\t\t15 | \n\t\t16 |   tags = {\n\t\t17 |     Name      = \"Terraform Remote State\"\n\t\t18 |     Terraform = true\n\t\t19 |     Security  = \"SSE:AWS\"\n\t\t20 |   }\n\t\t21 | }\n\n\n",
        "stderr": "2024-06-20 20:07:29,785 [MainThread  ] [WARNI]  Failed to download module terraform-aws-modules/eks/aws:None (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 11.879933341999276
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 5, Failed checks: 1, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.main\n\tFile: /dynamodb/main.tf:1-32\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.main\n\tFile: /dynamodb/main.tf:1-32\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.main\n\tFile: /state/dynamodb.tf:1-26\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.main\n\tFile: /state/dynamodb.tf:1-26\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.main\n\tFile: /state/dynamodb.tf:1-26\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.main\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /dynamodb/main.tf:1-32\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t1  | resource \"aws_dynamodb_table\" \"main\" {\n\t\t2  |   name           = local.name\n\t\t3  |   read_capacity  = var.min_read_capacity\n\t\t4  |   write_capacity = var.min_write_capacity\n\t\t5  |   hash_key       = var.hash_key\n\t\t6  | \n\t\t7  |   #range_key      = \"${var.range_key}\"\n\t\t8  | \n\t\t9  |   attribute {\n\t\t10 |     name = var.hash_key\n\t\t11 |     type = \"S\"\n\t\t12 |   }\n\t\t13 | \n\t\t14 |   #attribute {\n\t\t15 |   #  name = \"${var.range_key}\"\n\t\t16 |   #  type = \"S\"\n\t\t17 |   #}\n\t\t18 | \n\t\t19 |   ttl {\n\t\t20 |     enabled        = var.ttl_enabled\n\t\t21 |     attribute_name = \"timeToLive\"\n\t\t22 |   }\n\t\t23 |   server_side_encryption {\n\t\t24 |     enabled = var.encryption_enabled\n\t\t25 |   }\n\t\t26 |   tags = merge(\n\t\t27 |     local.tags,\n\t\t28 |     {\n\t\t29 |       \"Name\" = local.name\n\t\t30 |     },\n\t\t31 |   )\n\t\t32 | }\n\n\n",
      "stderr": "2024-06-20 20:07:16,977 [MainThread  ] [WARNI]  Failed to download module terraform-aws-modules/eks/aws:None (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 12.787727115999587
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/MichaelDeCorte/TerraForm/commit/3799ee8b9677d02254eb6d6f50f3732df4c8374e",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 0, Failed checks: 3, Skipped checks: 0, Parsing errors: 4\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.dynamo_table\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /dynamo/dynamo.tf:140-174\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t140 | resource \"aws_dynamodb_table\" \"dynamo_table\" {\n\t\t141 |     name            \t= \"${var.name}\"\n\t\t142 |     read_capacity   \t= \"${var.read_capacity}\"\n\t\t143 |     write_capacity  \t= \"${var.write_capacity}\"\n\t\t144 |     hash_key        \t= \"${var.hash_key}\"\n\t\t145 |     range_key        \t= \"${var.range_key}\"\n\t\t146 | \n\t\t147 |     \n\t\t148 |     attribute = [\n\t\t149 |         \"${local.attributes}\"\n\t\t150 |     ]\n\t\t151 | \n\t\t152 | \n\t\t153 |     global_secondary_index\t\t= [\n\t\t154 |         # # \"${null_resource.global_secondary_index.*.triggers}\"\n\t\t155 |         \"${var.global_secondary_indexes}\"\n\t\t156 |      ]\n\t\t157 | \n\t\t158 |     stream_enabled\t\t= \"${var.stream_view_type == \"\" ? false : true}\"\n\t\t159 |     stream_view_type\t= \"${var.stream_view_type}\"\n\t\t160 |     \n\t\t161 |     tags \t\t\t\t\t= \"${merge(var.tags, var.globals[\"tags\"])}\"\n\t\t162 | \n\t\t163 |     # server_side_encryption { enabled = \"true\" }  # MRD\n\t\t164 |     point_in_time_recovery { enabled = true }\n\t\t165 | \n\t\t166 |     # lifecycle {\n\t\t167 |     #     ignore_changes = [\n\t\t168 |     #         \"global_secondary_index\",\n\t\t169 |     #         \"read_capacity\",\n\t\t170 |     #         \"write_capacity\",\n\t\t171 |     #     ]\n\t\t172 |     # }\n\t\t173 |     \n\t\t174 | }\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: aws_dynamodb_table.dynamo_table\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /dynamo/dynamo.tf:140-174\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t140 | resource \"aws_dynamodb_table\" \"dynamo_table\" {\n\t\t141 |     name            \t= \"${var.name}\"\n\t\t142 |     read_capacity   \t= \"${var.read_capacity}\"\n\t\t143 |     write_capacity  \t= \"${var.write_capacity}\"\n\t\t144 |     hash_key        \t= \"${var.hash_key}\"\n\t\t145 |     range_key        \t= \"${var.range_key}\"\n\t\t146 | \n\t\t147 |     \n\t\t148 |     attribute = [\n\t\t149 |         \"${local.attributes}\"\n\t\t150 |     ]\n\t\t151 | \n\t\t152 | \n\t\t153 |     global_secondary_index\t\t= [\n\t\t154 |         # # \"${null_resource.global_secondary_index.*.triggers}\"\n\t\t155 |         \"${var.global_secondary_indexes}\"\n\t\t156 |      ]\n\t\t157 | \n\t\t158 |     stream_enabled\t\t= \"${var.stream_view_type == \"\" ? false : true}\"\n\t\t159 |     stream_view_type\t= \"${var.stream_view_type}\"\n\t\t160 |     \n\t\t161 |     tags \t\t\t\t\t= \"${merge(var.tags, var.globals[\"tags\"])}\"\n\t\t162 | \n\t\t163 |     # server_side_encryption { enabled = \"true\" }  # MRD\n\t\t164 |     point_in_time_recovery { enabled = true }\n\t\t165 | \n\t\t166 |     # lifecycle {\n\t\t167 |     #     ignore_changes = [\n\t\t168 |     #         \"global_secondary_index\",\n\t\t169 |     #         \"read_capacity\",\n\t\t170 |     #         \"write_capacity\",\n\t\t171 |     #     ]\n\t\t172 |     # }\n\t\t173 |     \n\t\t174 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.dynamo_table\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /dynamo/dynamo.tf:140-174\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t140 | resource \"aws_dynamodb_table\" \"dynamo_table\" {\n\t\t141 |     name            \t= \"${var.name}\"\n\t\t142 |     read_capacity   \t= \"${var.read_capacity}\"\n\t\t143 |     write_capacity  \t= \"${var.write_capacity}\"\n\t\t144 |     hash_key        \t= \"${var.hash_key}\"\n\t\t145 |     range_key        \t= \"${var.range_key}\"\n\t\t146 | \n\t\t147 |     \n\t\t148 |     attribute = [\n\t\t149 |         \"${local.attributes}\"\n\t\t150 |     ]\n\t\t151 | \n\t\t152 | \n\t\t153 |     global_secondary_index\t\t= [\n\t\t154 |         # # \"${null_resource.global_secondary_index.*.triggers}\"\n\t\t155 |         \"${var.global_secondary_indexes}\"\n\t\t156 |      ]\n\t\t157 | \n\t\t158 |     stream_enabled\t\t= \"${var.stream_view_type == \"\" ? false : true}\"\n\t\t159 |     stream_view_type\t= \"${var.stream_view_type}\"\n\t\t160 |     \n\t\t161 |     tags \t\t\t\t\t= \"${merge(var.tags, var.globals[\"tags\"])}\"\n\t\t162 | \n\t\t163 |     # server_side_encryption { enabled = \"true\" }  # MRD\n\t\t164 |     point_in_time_recovery { enabled = true }\n\t\t165 | \n\t\t166 |     # lifecycle {\n\t\t167 |     #     ignore_changes = [\n\t\t168 |     #         \"global_secondary_index\",\n\t\t169 |     #         \"read_capacity\",\n\t\t170 |     #         \"write_capacity\",\n\t\t171 |     #     ]\n\t\t172 |     # }\n\t\t173 |     \n\t\t174 | }\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/MichaelDeCorte-TerraForm-3799ee8b9677d02254eb6d6f50f3732df4c8374e/before-b6cd7fbd0cf34fba853f56bc9e0b6da18e4994ed/apiGateway/method/method.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/MichaelDeCorte-TerraForm-3799ee8b9677d02254eb6d6f50f3732df4c8374e/before-b6cd7fbd0cf34fba853f56bc9e0b6da18e4994ed/cloudwatch/logGroup/logGroup.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/MichaelDeCorte-TerraForm-3799ee8b9677d02254eb6d6f50f3732df4c8374e/before-b6cd7fbd0cf34fba853f56bc9e0b6da18e4994ed/codebuild/CodeBuild.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/MichaelDeCorte-TerraForm-3799ee8b9677d02254eb6d6f50f3732df4c8374e/before-b6cd7fbd0cf34fba853f56bc9e0b6da18e4994ed/files/files.tfֿ\n\n",
        "stderr": "2024-06-20 20:07:46,528 [MainThread  ] [WARNI]  Failed to download module git@github.com:MichaelDeCorte/Terraform.git//apiGateway/role:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:07:46,528 [MainThread  ] [WARNI]  Failed to download module git@github.com:MichaelDeCorte/Terraform.git//cloudwatch/logGroup:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:07:46,528 [MainThread  ] [WARNI]  Failed to download module git@github.com:MichaelDeCorte/TerraForm.git//cloudwatch/logGroup:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:07:46,529 [MainThread  ] [WARNI]  Failed to download module git@github.com:MichaelDeCorte/TerraForm.git//instance/basic:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:07:46,529 [MainThread  ] [WARNI]  Failed to download module git@github.com:MichaelDeCorte/Terraform.git//lambda/role:None (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 5.015159555001446
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 1, Skipped checks: 0, Parsing errors: 4\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.dynamo_table\n\tFile: /dynamo/dynamo.tf:132-174\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.dynamo_table\n\tFile: /dynamo/dynamo.tf:132-174\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tFAILED for resource: aws_dynamodb_table.dynamo_table\n\tDetails: Global secondary indices are expensive and may not be necessary\n\tFile: /dynamo/dynamo.tf:132-174\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t132 | resource \"aws_dynamodb_table\" \"dynamo_table\" {\n\t\t133 |     name            \t= \"${var.name}\"\n\t\t134 |     read_capacity   \t= \"${var.read_capacity}\"\n\t\t135 |     write_capacity  \t= \"${var.write_capacity}\"\n\t\t136 |     hash_key        \t= \"${var.hash_key}\"\n\t\t137 |     range_key        \t= \"${var.range_key}\"\n\t\t138 | \n\t\t139 |     lifecycle {\n\t\t140 |         ignore_changes = [\n\t\t141 |             \"read_capacity\",\n\t\t142 |             \"write_capacity\"\n\t\t143 |         ]\n\t\t144 |     }\n\t\t145 |     \n\t\t146 |     attribute = [\n\t\t147 |         \"${local.attributes}\"\n\t\t148 |     ]\n\t\t149 | \n\t\t150 | \n\t\t151 |     billing_mode = \"${var.billing_mode}\"\n\t\t152 | \n\t\t153 |     global_secondary_index\t\t= [\n\t\t154 |         # # \"${null_resource.global_secondary_index.*.triggers}\"\n\t\t155 |         \"${var.global_secondary_indexes}\"\n\t\t156 |      ]\n\t\t157 | \n\t\t158 |     stream_enabled\t\t= \"${var.stream_view_type == \"\" ? false : true}\"\n\t\t159 |     stream_view_type\t= \"${var.stream_view_type}\"\n\t\t160 |     \n\t\t161 |     tags \t\t\t\t\t= \"${merge(var.tags, var.globals[\"tags\"])}\"\n\t\t162 | \n\t\t163 |     # server_side_encryption { enabled = \"true\" }  # MRD\n\t\t164 |     point_in_time_recovery { enabled = true }\n\t\t165 | \n\t\t166 |     # lifecycle {\n\t\t167 |     #     ignore_changes = [\n\t\t168 |     #         \"global_secondary_index\",\n\t\t169 |     #         \"read_capacity\",\n\t\t170 |     #         \"write_capacity\",\n\t\t171 |     #     ]\n\t\t172 |     # }\n\t\t173 |     \n\t\t174 | }\n\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/MichaelDeCorte-TerraForm-3799ee8b9677d02254eb6d6f50f3732df4c8374e/after/apiGateway/method/method.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/MichaelDeCorte-TerraForm-3799ee8b9677d02254eb6d6f50f3732df4c8374e/after/cloudwatch/logGroup/logGroup.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/MichaelDeCorte-TerraForm-3799ee8b9677d02254eb6d6f50f3732df4c8374e/after/codebuild/CodeBuild.tfֿ\nError parsing file /home/koen/education/2023-2024/msc-thesis/repos/code/4-evaluation/snapshots/MichaelDeCorte-TerraForm-3799ee8b9677d02254eb6d6f50f3732df4c8374e/after/files/files.tfֿ\n\n",
      "stderr": "2024-06-20 20:07:41,519 [MainThread  ] [WARNI]  Failed to download module git@github.com:MichaelDeCorte/Terraform.git//apiGateway/role:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:07:41,520 [MainThread  ] [WARNI]  Failed to download module git@github.com:MichaelDeCorte/Terraform.git//cloudwatch/logGroup:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:07:41,520 [MainThread  ] [WARNI]  Failed to download module git@github.com:MichaelDeCorte/TerraForm.git//cloudwatch/logGroup:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:07:41,520 [MainThread  ] [WARNI]  Failed to download module git@github.com:MichaelDeCorte/TerraForm.git//instance/basic:None (for external modules, the --download-external-modules flag is required)\n2024-06-20 20:07:41,520 [MainThread  ] [WARNI]  Failed to download module git@github.com:MichaelDeCorte/Terraform.git//lambda/role:None (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 4.937032369000008
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/TalkingFox/SignalWs/commit/935d9d683608b4d8a97ef6ccc2c8ab7c14eec0d0",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 6, Skipped checks: 0\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.signalrooms\n\tFile: /terraform/data.tf:5-17\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.signalhosts\n\tFile: /terraform/data.tf:19-31\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.signalwords\n\tFile: /terraform/data.tf:33-45\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.signalrooms\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/data.tf:5-17\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t5  | resource \"aws_dynamodb_table\" \"signalrooms\" {\n\t\t6  |   name           = \"SignalRooms\"\n\t\t7  |   read_capacity  = 20\n\t\t8  |   write_capacity = 20\n\t\t9  |   hash_key       = \"roomName\"\n\t\t10 | \n\t\t11 |   attribute = [\n\t\t12 |     {\n\t\t13 |       name = \"roomName\"\n\t\t14 |       type = \"S\"\n\t\t15 |     }\n\t\t16 |   ]\n\t\t17 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.signalrooms\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/data.tf:5-17\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t5  | resource \"aws_dynamodb_table\" \"signalrooms\" {\n\t\t6  |   name           = \"SignalRooms\"\n\t\t7  |   read_capacity  = 20\n\t\t8  |   write_capacity = 20\n\t\t9  |   hash_key       = \"roomName\"\n\t\t10 | \n\t\t11 |   attribute = [\n\t\t12 |     {\n\t\t13 |       name = \"roomName\"\n\t\t14 |       type = \"S\"\n\t\t15 |     }\n\t\t16 |   ]\n\t\t17 | }\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.signalhosts\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/data.tf:19-31\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t19 | resource \"aws_dynamodb_table\" \"signalhosts\" {\n\t\t20 |   name           = \"SignalHosts\"\n\t\t21 |   read_capacity  = 20\n\t\t22 |   write_capacity = 20\n\t\t23 |   hash_key       = \"host\"\n\t\t24 | \n\t\t25 |   attribute = [\n\t\t26 |     {\n\t\t27 |       name = \"host\"\n\t\t28 |       type = \"S\"\n\t\t29 |     }\n\t\t30 |   ]\n\t\t31 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.signalhosts\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/data.tf:19-31\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t19 | resource \"aws_dynamodb_table\" \"signalhosts\" {\n\t\t20 |   name           = \"SignalHosts\"\n\t\t21 |   read_capacity  = 20\n\t\t22 |   write_capacity = 20\n\t\t23 |   hash_key       = \"host\"\n\t\t24 | \n\t\t25 |   attribute = [\n\t\t26 |     {\n\t\t27 |       name = \"host\"\n\t\t28 |       type = \"S\"\n\t\t29 |     }\n\t\t30 |   ]\n\t\t31 | }\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.signalwords\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/data.tf:33-45\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t33 | resource \"aws_dynamodb_table\" \"signalwords\" {\n\t\t34 |   name           = \"SignalWords\"\n\t\t35 |   read_capacity  = 20\n\t\t36 |   write_capacity = 20\n\t\t37 |   hash_key       = \"wordsProperty\"\n\t\t38 | \n\t\t39 |   attribute = [\n\t\t40 |     {\n\t\t41 |       name = \"wordsProperty\"\n\t\t42 |       type = \"S\"\n\t\t43 |     },\n\t\t44 |   ]\n\t\t45 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.signalwords\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/data.tf:33-45\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t33 | resource \"aws_dynamodb_table\" \"signalwords\" {\n\t\t34 |   name           = \"SignalWords\"\n\t\t35 |   read_capacity  = 20\n\t\t36 |   write_capacity = 20\n\t\t37 |   hash_key       = \"wordsProperty\"\n\t\t38 | \n\t\t39 |   attribute = [\n\t\t40 |     {\n\t\t41 |       name = \"wordsProperty\"\n\t\t42 |       type = \"S\"\n\t\t43 |     },\n\t\t44 |   ]\n\t\t45 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 4.123292038999352
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 6, Failed checks: 3, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.signalrooms\n\tFile: /terraform/data.tf:5-17\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.signalrooms\n\tFile: /terraform/data.tf:5-17\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.signalhosts\n\tFile: /terraform/data.tf:19-31\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.signalhosts\n\tFile: /terraform/data.tf:19-31\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.signalwords\n\tFile: /terraform/data.tf:33-45\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.signalwords\n\tFile: /terraform/data.tf:33-45\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.signalrooms\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/data.tf:5-17\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t5  | resource \"aws_dynamodb_table\" \"signalrooms\" {\n\t\t6  |   name           = \"SignalRooms\"\n\t\t7  |   read_capacity  = 1\n\t\t8  |   write_capacity = 1\n\t\t9  |   hash_key       = \"roomName\"\n\t\t10 | \n\t\t11 |   attribute = [\n\t\t12 |     {\n\t\t13 |       name = \"roomName\"\n\t\t14 |       type = \"S\"\n\t\t15 |     }\n\t\t16 |   ]\n\t\t17 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.signalhosts\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/data.tf:19-31\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t19 | resource \"aws_dynamodb_table\" \"signalhosts\" {\n\t\t20 |   name           = \"SignalHosts\"\n\t\t21 |   read_capacity  = 1\n\t\t22 |   write_capacity = 1\n\t\t23 |   hash_key       = \"host\"\n\t\t24 | \n\t\t25 |   attribute = [\n\t\t26 |     {\n\t\t27 |       name = \"host\"\n\t\t28 |       type = \"S\"\n\t\t29 |     }\n\t\t30 |   ]\n\t\t31 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.signalwords\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /terraform/data.tf:33-45\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t33 | resource \"aws_dynamodb_table\" \"signalwords\" {\n\t\t34 |   name           = \"SignalWords\"\n\t\t35 |   read_capacity  = 1\n\t\t36 |   write_capacity = 1\n\t\t37 |   hash_key       = \"wordsProperty\"\n\t\t38 | \n\t\t39 |   attribute = [\n\t\t40 |     {\n\t\t41 |       name = \"wordsProperty\"\n\t\t42 |       type = \"S\"\n\t\t43 |     },\n\t\t44 |   ]\n\t\t45 | }\n\n\n",
      "stderr": "",
      "duration_seconds": 4.12405611199938
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/codequest-eu/terraform-modules/commit/ffe23d4c2cd78035bef0dfb261701e7ed8dd588d",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 2, Failed checks: 4, Skipped checks: 0\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.meta.aws_dynamodb_table.state_lock\n\tFile: /meta/main.tf:61-73\n\tCalling File: /meta/aws_account/example/main.tf:25-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.meta.aws_dynamodb_table.meta_lock\n\tFile: /meta/main.tf:75-87\n\tCalling File: /meta/aws_account/example/main.tf:25-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: module.meta.aws_dynamodb_table.state_lock\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /meta/main.tf:61-73\n\tCalling File: /meta/aws_account/example/main.tf:25-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t61 | resource \"aws_dynamodb_table\" \"state_lock\" {\n\t\t62 |   name           = \"${local.name_prefix}-state-lock\"\n\t\t63 |   hash_key       = \"LockID\"\n\t\t64 |   read_capacity  = 20\n\t\t65 |   write_capacity = 20\n\t\t66 | \n\t\t67 |   attribute {\n\t\t68 |     name = \"LockID\"\n\t\t69 |     type = \"S\"\n\t\t70 |   }\n\t\t71 | \n\t\t72 |   tags = \"${local.tags}\"\n\t\t73 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.meta.aws_dynamodb_table.state_lock\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /meta/main.tf:61-73\n\tCalling File: /meta/aws_account/example/main.tf:25-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t61 | resource \"aws_dynamodb_table\" \"state_lock\" {\n\t\t62 |   name           = \"${local.name_prefix}-state-lock\"\n\t\t63 |   hash_key       = \"LockID\"\n\t\t64 |   read_capacity  = 20\n\t\t65 |   write_capacity = 20\n\t\t66 | \n\t\t67 |   attribute {\n\t\t68 |     name = \"LockID\"\n\t\t69 |     type = \"S\"\n\t\t70 |   }\n\t\t71 | \n\t\t72 |   tags = \"${local.tags}\"\n\t\t73 | }\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: module.meta.aws_dynamodb_table.meta_lock\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /meta/main.tf:75-87\n\tCalling File: /meta/aws_account/example/main.tf:25-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t75 | resource \"aws_dynamodb_table\" \"meta_lock\" {\n\t\t76 |   name           = \"${local.name_prefix}-meta-lock\"\n\t\t77 |   hash_key       = \"LockID\"\n\t\t78 |   read_capacity  = 20\n\t\t79 |   write_capacity = 20\n\t\t80 | \n\t\t81 |   attribute {\n\t\t82 |     name = \"LockID\"\n\t\t83 |     type = \"S\"\n\t\t84 |   }\n\t\t85 | \n\t\t86 |   tags = \"${local.tags}\"\n\t\t87 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.meta.aws_dynamodb_table.meta_lock\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /meta/main.tf:75-87\n\tCalling File: /meta/aws_account/example/main.tf:25-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t75 | resource \"aws_dynamodb_table\" \"meta_lock\" {\n\t\t76 |   name           = \"${local.name_prefix}-meta-lock\"\n\t\t77 |   hash_key       = \"LockID\"\n\t\t78 |   read_capacity  = 20\n\t\t79 |   write_capacity = 20\n\t\t80 | \n\t\t81 |   attribute {\n\t\t82 |     name = \"LockID\"\n\t\t83 |     type = \"S\"\n\t\t84 |   }\n\t\t85 | \n\t\t86 |   tags = \"${local.tags}\"\n\t\t87 | }\n\n\n",
        "stderr": "2024-06-20 20:08:06,172 [MainThread  ] [WARNI]  Failed to download module ..:None (for external modules, the --download-external-modules flag is required)\n",
        "duration_seconds": 6.3885103310003615
      }
    ],
    "after": {
      "return_code": 1,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 4, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.meta.aws_dynamodb_table.state_lock\n\tFile: /meta/main.tf:61-73\n\tCalling File: /meta/aws_account/example/main.tf:25-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.meta.aws_dynamodb_table.state_lock\n\tFile: /meta/main.tf:61-73\n\tCalling File: /meta/aws_account/example/main.tf:25-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: module.meta.aws_dynamodb_table.meta_lock\n\tFile: /meta/main.tf:75-87\n\tCalling File: /meta/aws_account/example/main.tf:25-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: module.meta.aws_dynamodb_table.meta_lock\n\tFile: /meta/main.tf:75-87\n\tCalling File: /meta/aws_account/example/main.tf:25-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.meta.aws_dynamodb_table.state_lock\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /meta/main.tf:61-73\n\tCalling File: /meta/aws_account/example/main.tf:25-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t61 | resource \"aws_dynamodb_table\" \"state_lock\" {\n\t\t62 |   name           = \"${local.name_prefix}-state-lock\"\n\t\t63 |   hash_key       = \"LockID\"\n\t\t64 |   read_capacity  = 1\n\t\t65 |   write_capacity = 1\n\t\t66 | \n\t\t67 |   attribute {\n\t\t68 |     name = \"LockID\"\n\t\t69 |     type = \"S\"\n\t\t70 |   }\n\t\t71 | \n\t\t72 |   tags = \"${local.tags}\"\n\t\t73 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: module.meta.aws_dynamodb_table.meta_lock\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /meta/main.tf:75-87\n\tCalling File: /meta/aws_account/example/main.tf:25-33\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t75 | resource \"aws_dynamodb_table\" \"meta_lock\" {\n\t\t76 |   name           = \"${local.name_prefix}-meta-lock\"\n\t\t77 |   hash_key       = \"LockID\"\n\t\t78 |   read_capacity  = 1\n\t\t79 |   write_capacity = 1\n\t\t80 | \n\t\t81 |   attribute {\n\t\t82 |     name = \"LockID\"\n\t\t83 |     type = \"S\"\n\t\t84 |   }\n\t\t85 | \n\t\t86 |   tags = \"${local.tags}\"\n\t\t87 | }\n\n\n",
      "stderr": "2024-06-20 20:07:59,756 [MainThread  ] [WARNI]  Failed to download module ..:None (for external modules, the --download-external-modules flag is required)\n",
      "duration_seconds": 6.444640468998841
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/dgorbov/terraform-s3-backend-setup/commit/81f82740760a357a86b3a77f9ed400624edcb218",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.tf_state_lock\n\tFile: /main.tf:25-37\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.tf_state_lock\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /main.tf:25-37\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t25 | resource \"aws_dynamodb_table\" \"tf_state_lock\" {\n\t\t26 |   name = \"tf-state-lock-${var.s3_bucket_name}\"\n\t\t27 |   hash_key = \"LockID\"\n\t\t28 |   read_capacity = 20\n\t\t29 |   write_capacity = 20\n\t\t30 |   attribute {\n\t\t31 |     name = \"LockID\"\n\t\t32 |     type = \"S\"\n\t\t33 |   }\n\t\t34 |   tags = {\n\t\t35 |     Name = \"DynamoDB table for locking terraform state\"\n\t\t36 |   }\n\t\t37 | }\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.tf_state_lock\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /main.tf:25-37\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t25 | resource \"aws_dynamodb_table\" \"tf_state_lock\" {\n\t\t26 |   name = \"tf-state-lock-${var.s3_bucket_name}\"\n\t\t27 |   hash_key = \"LockID\"\n\t\t28 |   read_capacity = 20\n\t\t29 |   write_capacity = 20\n\t\t30 |   attribute {\n\t\t31 |     name = \"LockID\"\n\t\t32 |     type = \"S\"\n\t\t33 |   }\n\t\t34 |   tags = {\n\t\t35 |     Name = \"DynamoDB table for locking terraform state\"\n\t\t36 |   }\n\t\t37 | }\n\n",
        "stderr": "",
        "duration_seconds": 3.835546633999911
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.tf_state_lock\n\tFile: /main.tf:25-38\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.tf_state_lock\n\tFile: /main.tf:25-38\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.tf_state_lock\n\tFile: /main.tf:25-38\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "",
      "duration_seconds": 3.8956246270008705
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/sbogacz/terraform-aws-state-backend/commit/174486319f3b956807d56e5433880f9978884f93",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.dynamodb_terraform_state_lock\n\tFile: /main.tf:42-58\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.dynamodb_terraform_state_lock\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /main.tf:42-58\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t42 | resource \"aws_dynamodb_table\" \"dynamodb_terraform_state_lock\" {\n\t\t43 |   name = \"${format(\"%s-state-file-lock\", var.bucket_prefix)}\"\n\t\t44 | \n\t\t45 |   # This is required per the Terraform documentation\n\t\t46 |   # https://www.terraform.io/docs/backends/types/s3.html#dynamodb_table\n\t\t47 |   hash_key = \"LockID\"\n\t\t48 | \n\t\t49 |   read_capacity  = \"${var.lock_table_read_capacity}\"\n\t\t50 |   write_capacity = \"${var.lock_table_write_capacity}\"\n\t\t51 | \n\t\t52 |   attribute {\n\t\t53 |     name = \"LockID\"\n\t\t54 |     type = \"S\"\n\t\t55 |   }\n\t\t56 | \n\t\t57 |   tags = \"${var.tags}\"\n\t\t58 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.dynamodb_terraform_state_lock\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /main.tf:42-58\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t42 | resource \"aws_dynamodb_table\" \"dynamodb_terraform_state_lock\" {\n\t\t43 |   name = \"${format(\"%s-state-file-lock\", var.bucket_prefix)}\"\n\t\t44 | \n\t\t45 |   # This is required per the Terraform documentation\n\t\t46 |   # https://www.terraform.io/docs/backends/types/s3.html#dynamodb_table\n\t\t47 |   hash_key = \"LockID\"\n\t\t48 | \n\t\t49 |   read_capacity  = \"${var.lock_table_read_capacity}\"\n\t\t50 |   write_capacity = \"${var.lock_table_write_capacity}\"\n\t\t51 | \n\t\t52 |   attribute {\n\t\t53 |     name = \"LockID\"\n\t\t54 |     type = \"S\"\n\t\t55 |   }\n\t\t56 | \n\t\t57 |   tags = \"${var.tags}\"\n\t\t58 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 3.9183123070015426
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.dynamodb_terraform_state_lock\n\tFile: /main.tf:42-58\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.dynamodb_terraform_state_lock\n\tFile: /main.tf:42-58\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.dynamodb_terraform_state_lock\n\tFile: /main.tf:42-58\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "",
      "duration_seconds": 3.924726585000826
    }
  },
  {
    "pattern": "AWS - Expensive DynamoDB",
    "url": "https://github.com/giuseppeborgese/terraform-locking-s3-state/commit/6b4e59e8b844417dc5c247bdef1b0adb8e2e7028",
    "before": [
      {
        "return_code": 1,
        "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 1, Failed checks: 2, Skipped checks: 0\n\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.dynamodb-terraform-state-lock\n\tFile: /remote.tf:33-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tFAILED for resource: aws_dynamodb_table.dynamodb-terraform-state-lock\n\tDetails: Using high read capacity might incur unnecessary cost for infrequently accessed tables\n\tFile: /remote.tf:33-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t33 | resource \"aws_dynamodb_table\" \"dynamodb-terraform-state-lock\" {\n\t\t34 |   name = \"terraform-state-lock-dynamo\"\n\t\t35 |   hash_key = \"LockID\"\n\t\t36 |   read_capacity = 20\n\t\t37 |   write_capacity = 20\n\t\t38 | \n\t\t39 |   attribute {\n\t\t40 |     name = \"LockID\"\n\t\t41 |     type = \"S\"\n\t\t42 |   }\n\t\t43 | \n\t\t44 |   tags = {\n\t\t45 |     Name = \"DynamoDB Terraform State Lock Table\"\n\t\t46 |   }\n\t\t47 | }\n\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tFAILED for resource: aws_dynamodb_table.dynamodb-terraform-state-lock\n\tDetails: Using provisioned billing mode might incur unnecessary cost for infrequently accessed tables\n\tFile: /remote.tf:33-47\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n\t\t33 | resource \"aws_dynamodb_table\" \"dynamodb-terraform-state-lock\" {\n\t\t34 |   name = \"terraform-state-lock-dynamo\"\n\t\t35 |   hash_key = \"LockID\"\n\t\t36 |   read_capacity = 20\n\t\t37 |   write_capacity = 20\n\t\t38 | \n\t\t39 |   attribute {\n\t\t40 |     name = \"LockID\"\n\t\t41 |     type = \"S\"\n\t\t42 |   }\n\t\t43 | \n\t\t44 |   tags = {\n\t\t45 |     Name = \"DynamoDB Terraform State Lock Table\"\n\t\t46 |   }\n\t\t47 | }\n\n\n",
        "stderr": "",
        "duration_seconds": 3.9018005400012044
      }
    ],
    "after": {
      "return_code": 0,
      "stdout": "\n       _               _              \n   ___| |__   ___  ___| | _______   __\n  / __| '_ \\ / _ \\/ __| |/ / _ \\ \\ / /\n | (__| | | |  __/ (__|   < (_) \\ V / \n  \\___|_| |_|\\___|\\___|_|\\_\\___/ \\_/  \n                                      \nBy Prisma Cloud | version: 3.2.999 \n\nterraform scan results:\n\nPassed checks: 3, Failed checks: 0, Skipped checks: 0\n\nCheck: CKV_AWS_802: \"Ensure that DynamoDB tables do not use high read/write capacity\"\n\tPASSED for resource: aws_dynamodb_table.dynamodb-terraform-state-lock\n\tFile: /remote.tf:33-50\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_803: \"Ensure that no global secondary indices are used\"\n\tPASSED for resource: aws_dynamodb_table.dynamodb-terraform-state-lock\n\tFile: /remote.tf:33-50\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\nCheck: CKV_AWS_801: \"Ensure that DynamoDB tables use PAY_PER_REQUEST billing mode\"\n\tPASSED for resource: aws_dynamodb_table.dynamodb-terraform-state-lock\n\tFile: /remote.tf:33-50\n\tGuide: https://search-rug.github.io/iac-cost-patterns/aws-expensive-dynamodb/\n\n",
      "stderr": "",
      "duration_seconds": 3.899411369000518
    }
  }
]
